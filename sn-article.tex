
 
\documentclass[sn-mathphys,Numbered]{sn-jnl}% Math and Physical Sciences Reference Style
%\documentclass[sn-mathphys,Numbered,draft]{sn-jnl}% Math and Physical Sciences Reference Style

%%\documentclass[sn-nature]{sn-jnl}% Style for submissions to Nature Portfolio journals
%%\documentclass[sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style
%%\documentclass[sn-aps]{sn-jnl}% American Physical Society (APS) Reference Style
%%\documentclass[sn-vancouver,Numbered]{sn-jnl}% Vancouver Reference Style
%%\documentclass[sn-apa]{sn-jnl}% APA Reference Style 
%%\documentclass[sn-chicago]{sn-jnl}% Chicago-based Humanities Reference Style
%%\documentclass[default]{sn-jnl}% Default
%%\documentclass[default,iicol]{sn-jnl}% Default with double column layout

%%%% Standard Packages
%%<additional latex packages, if required, can be included here>

\setlength{\parskip}{\baselineskip}

\usepackage{graphicx}%
\usepackage{amsmath,amssymb,amsfonts,bm}%
\usepackage{multirow}
\usepackage{amsthm}%
%\usepackage{subcaption}
\usepackage{mathrsfs}%
\usepackage[title]{appendix}%
\usepackage{xcolor}%
\usepackage{textcomp}%
\usepackage{manyfoot}%
\usepackage{booktabs}%
%\usepackage{algorithm}%
%\usepackage{algorithmicx}%
\usepackage{algpseudocode}%
\usepackage{listings}%
\usepackage{bigints}
\usepackage{outlines}
\usepackage{geometry}
\usepackage{subfigure}
\usepackage{siunitx}
\geometry
{
a4paper,         % or letterpaper
textwidth=15cm,  % llncs has 12.2cm
textheight=24cm, % llncs has 19.3cm
% heightrounded,   % integer number of lines
% hratio=1:1,      % horizontally centered
% vratio=2:3,      % not vertically centered
}
\setlength{\tabcolsep}{0.5cm}
\usepackage[onehalfspacing]{setspace}
% \usepackage{lineno}
% \linenumbers
%%%%

\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage[ruled,vlined]{algorithm2e}
\usepackage{amsmath}
%\usepackage{movie15} %to allow movie embedding
\usepackage[section]{placeins}
\usepackage{enumitem}
\usepackage{color,soul}
\usepackage{xfrac}

%% New math commands
\newcommand{\s}[1]{\overset{*}{#1}}
\newcommand{\RM}{\bm{\Lambda}}
\newcommand{\RMI}{\bm{\Lambda}_0}
\newcommand{\RMT}{\bm{\Lambda}_t}
\newcommand{\RV}{\bm{\psi}}
\newcommand{\magRV}{\psi}
\newcommand{\RMTS}{\s{\bm{\Lambda}}_t}
\newcommand{\bb}{\boldsymbol}

%% For contact
\newcommand{\rbar}{\bar{\bm{r}}}
\newcommand{\xibar}{\bar{\xi}}
%\newcommand{\magRV}{\bbit{\psi}}
\newcommand{\diag}{\rm diag}

\begin{document}

\title[Article Title]{A finite volume framework for damage and fracture prediction in wire drawing}

\author[1,2,3,4]{\fnm{Andrew} \sur{Whelan}} %\email{seevani.bali@ucd.ie}
% \equalcont{These authors contributed equally to this work.}

%\author[2]{\fnm{\v{Z}eljko } \sur{Tukovi\'{c}}}\email{zeljko.tukovic@fsb.unizg.hr}
% \equalcont{These authors contributed equally to this work.}

\author[5]{\fnm{Tian} \sur{Tang}}

\author[1,2,3,4]{\fnm{Vikram} \sur{Pakrashi}}%\email{vikram.pakrashi@ucd.ie}

\author*[1,2,3,4,6]{\fnm{Philip} \sur{Cardiff}}\email{philip.cardiff@ucd.ie}

%\author[1,3,5,6]{\fnm{Alojz} \sur{Ivankovi\'{c}}}\email{alojz.ivankovic@ucd.ie}


\affil*[1]{\orgdiv{School of Mechanical and Materials Engineering}, \orgname{University College Dublin}, \orgaddress{\country{Ireland}}}
\affil[2]{\orgdiv{SFI MaREI Centre}, \orgname{University College Dublin}, \orgaddress{\country{Ireland}}}
\affil[3]{\orgdiv{UCD Centre for Mechanics}, \orgname{University College Dublin}, \orgaddress{\country{Ireland}}}
%\affil[2]{\orgdiv{Faculty of Mechanical Engineering and Naval Architecture}, \orgname{University of Zagreb}, \orgaddress{\country{Croatia}}}
\affil[4]{\orgdiv{Bekaert University Technology Centre}, \orgname{University College Dublin}, \orgaddress{\country{Ireland}}}
\affil[5]{\orgname{NV Bekaert SA}, \orgaddress{Kortrijk, \country{Belgium}}}
\affil[6]{\orgdiv{SFI I-Form Centre}, \orgname{University College Dublin}, \orgaddress{\country{Ireland}}}

%\affil[6]{\orgdiv{UCD Centre of Adhesion and Adhesives'}, \orgname{University College Dublin}, \orgaddress{\country{Ireland}}}

%%==================================%%
%% sample for unstructured abstract %%
%%==================================%%


\abstract
{
%Numerical simulations of ductile fracture problems are of great interest in the industry because they allow for predicting where and when damage or fracture will occur.
%The availability of computational predictive tools allows for substantial savings in the cost of experiments and design optimisation.
This article presents the implementation of the canonical Lemaitre and Gurson-Tvergaard-Needleman (GTN) damage models and a more recent phase-field type model within a Lagrangian, geometrically nonlinear, cell-centred finite volume framework.
The proposed segregated solution procedure uses Picard-type defect (deferred) outer corrections, where the primary unknowns are cell-centre displacements and pressures.
Spurious zero-energy modes (numerical oscillations in displacement and pressure) are avoided by introducing stabilisation (smoothing) diffusion terms to the pressure and momentum equations.
Appropriate scaling of the momentum ``Rhie-Chow" stabilisation term is shown to be important in regions of plasticity and damage.
To accurately predict damage and fracture in wire drawing where hydrostatic pressure is high, novel variants of the Lemaitre model with crack-closure and triaxiality effects are proposed.
The developed methods are validated against the \emph{notched round bar} and \emph{flat notched bar} experimental cases and subsequently applied to the analysis of axisymmetric wire drawing.
It is shown that the proposed finite volume approach provides a robust basis for predicting damage in wire drawing, where the proposed novel Lemaitre model with crack-closure effects was shown to be the most suitable for predicting experimentally observed fracture.
}



\keywords{finite volume method, damage, fracture, Lemaitre, Gurson-Tvergaard-Needleman, phase field model, OpenFOAM}

\maketitle


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}\label{sec:intro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% Motivation: simulation of damage
%The prediction of damage and fracture in structures subjected to complex loading paths has been widely studied for the past century \cite{besson_continuum_2010,cao_models_2017,tekkaya_damage_2020}.
%The increased availability of large computational resources has made it feasible to develop virtual twins of real-life models. 
Numerical simulations of ductile fracture are of great interest in industries such as aerospace \cite{riccio_damage_2015, johnson_numerical_2015}, automotive \cite{alharbi_damage_2015, sirinakorn_microstructure_2014, sarraf_mesoscale_2017, uthaisangsuk_characterisation_2009}, nuclear \cite{chen_modeling_2020}, and metal forming \cite{masse_study_2010, cao_models_2017, tekkaya_damage_2020, clancy_improving_2019, borchers_cold-drawn_2016, cardiff_lagrangian_2017} to predict where and when damage or fracture will occur.
The availability of computational predictive tools allows for substantial savings in the cost of experiments and design optimisation.
%% Motivation: damage prediction specifically in wire drawing
In this work, the drawing of high-carbon steel wire products is the primary interest \cite{clancy_improving_2019, borchers_cold-drawn_2016}.
% due to their high strength and thus use in highly demanding applications .
%Its manufacturing process will consist of various combinations of wire-drawing steps, flat rolling, and profiled rollers to achieve the desired profile geometry for a given wire.
The drawing process can often lead to defects and even fractures during production.
By improving understanding of how and why fracture occurs, products and processes can be optimised.

A computational model for ductile fracture should predict several features, such as the stress and strain distribution, damage origination and propagation, and the resulting loss of load-carrying capacity. %- making coupled damage models of interest for this work.
%% Review of damage models
In the review of \citet{besson_continuum_2010}, fracture models were classified into global and local approaches (more commonly referred to as “discrete” and “smeared” or “sharp” and “diffuse” in the literature).
The Rice $J$-integral model is the canonical global approach; however, this approach suffers from limitations, such that it cannot predict crack initiation and propagation, and the $J$-integral is also not a material property as it strongly depends on the specimen geometry \cite{hackett_experimental_1993}.
These problems were rectified by the $J$-$Q$ integral approach; however, this approach, in turn, has the limitation that it does not apply to complex geometries \cite{odowd_family_1991}.
Further developments in this family of models, such as the critical crack tip opening displacement or crack tip opening angle, share the same limitations \cite{james_effect_2003, mahmoud_effect_2003}.
These models have been implemented in finite element solvers with remeshing techniques needed to model the crack propagation, though eXtended Finite Element Method (X-FEM) strategies have been designed to mitigate the need for remeshing.

The limitations of the global (discrete) approach have led to the development of local (smeared) approaches.
These methods characterise the fracture zone in more physical detail.
These models can, in turn, be split into surface models (cohesive zone models), where fracture occurs on a surface, and volume models, where damage or degradation occurs in a volume.
Cohesive zone models have found widespread use, and may or may not require a pre-defined crack path and exhibit mesh dependency depending on the implementation.
With these limitations in mind, this work focuses on the volume or \emph{continuum} damage mechanics approaches, stemming from the work of Lemaitre \cite{lemaitre_continuous_1985, lemaitre_engineering_2005}, and micro-mechanical approaches, as originally proposed by Gurson-Tvergaard-Needleman (GTN) \cite{gurson_continuum_1977, tvergaard_analysis_1984}.
A review of these approaches is left to Section \ref{sec:constitutive_laws}.
Within the past 15 years, an alternative volume ductile damage model has emerged, known as the phase field model approach \cite{ambati_phase-field_2015, borden_phase-field_2016, miehe_phase_2016, dittmann_variational_2018, samaniego_phase-field_2021}. This approach involves diffusing the sharp crack over a continuum.
Models of this form are also implemented in this work and are described in Section \ref{sec:constitutive_laws}.


%% FVM for metal forming and related applications
%While the finite element method (FEM) is most commonly used in structural applications,
In recent years, there has been an increasing interest in exploring the finite volume method for structural application and the interested reader is directed to a recent review by \citet{cardiff_thirty_2021}.
While the volume damage models have been implemented within finite element frameworks, they have seen little attention within the finite volume community.
As shown in this work, the segregated Picard iteration solution methodology, commonly employed in the finite volume method, demonstrates favourable convergence properties for the highly nonlinear material behaviour experienced in wire drawing.
%A wide variety of areas in solid and fluid mechanics have been studied using the finite-volume method such as elastoplasticity \cite{demirdzic_finite_1993,clancy_improving_2019,cardiff_lagrangian_2017,cardiff_block-coupled_2016,leonard_numerical_2012,bressan_analysis_2015,maneeratana_development_2000}, contact mechanics \cite{cardiff_block-coupled_2016,cardiff_development_2012,cardiff_development_2014}, cohesive zone modelling (CZM) \cite{safari_interfacial_2016,carolan_arbitrary_2013}, fracture simulation \cite{ivankovic_application_1994} and fluid-solid interactions \cite{martinez-ferrer_efficient_2018,greenshields_unified_2005,giannopapa_linear_2008,greenshields_fluidstructure_2000,schafer_numerical_2001}. According to this literature, the strongly conservative properties of the finite volume method make it suitable for such problems.


% Layer addition: Eulerian + Lagrangian
Although both Eulerian and Lagrangian approaches have been adopted for metal forming, the Lagrangian approach is now commonly favoured due to its ability to easily capture elastic effects, e.g. residual stresses and \emph{spring back}, notwithstanding its limitation of mesh deterioration for severe deformations.
%However, the Lagrangian approach can lead to mesh deterioration, which requires adaptive mesh smoothing and field advection (remapping) at each time step \cite{martins_extrusion_2011, basic_finite_2005}.
%Unlike conventional finite element methods, the finite volume method (FVM) is well suited for handling these advection problems due to its conservative nature.
%In addition to the Eulerian and Lagrangian methods, there exist hybrid approaches which have characteristics of each of these approaches, most notably the Arbitrary Lagrangian-Eulerian method \cite{maire_cell-centred_2008}.
Nonetheless, for continuous processes such as wire drawing, Lagrangian approaches require the user to select a sufficiently long initial domain (e.g., initial wire length) so that steady-state phenomena of interest can be examined.
Eulerian approaches do not have such a limitation as the workpiece \emph{inlet} and \emph{outlet} (i.e., wire upstream and downstream boundaries) are static in space.
To combine the advantages of both, the current work proposes a Lagrangian approach with novel Eulerian-style boundary conditions, which allow the wire upstream and downstream boundaries to stay fixed in space.

%Both Eulerian and Lagrangian approaches have been used, however, issues have arisen with the Eulerian approach for metal forming problems. There have been challenges with handling the advection of material particles through the domain \cite{martins_extrusion_2011,basic_finite_2005}. By contrast, the Lagrangian approach does not deal with this issue. The updated Lagrangian approach described in \cite{cardiff_lagrangian_2017} is primarily used in this work \footnote{More specifically this is the incrementally updated Lagrangian method \cite{belytschko_nonlinear_2014}}.  


%For nonlinear problems, the choice between Finite Element and Finite Volume methods remains ambiguous because of several unresolved numerical issues such as unintended hourglass patterns and pressure oscillations, issues of shear and volume locking, reduced convergence rates for strains and stresses compared to displacements, and susceptibility to mesh irregularities \cite{hassan_upwind_2019}. Finite volume discretisations hold the potential to address these challenges in a unique manner \cite{cardiff_thirty_2021}.

%Finite volume methods stand out for their accuracy and absence of excessive stiffness behaviour, a contrast to the locking phenomena commonly seen in fully integrated finite element methods \cite{cardiff_thirty_2021}. Notably, a significant advantage of many finite volume methods lies in their order of accuracy. Unlike numerous finite element schemes where the error in strain and stress decreases at a rate that approximates the first order, finite volume methods often exhibit a second-order rate of reduction in these errors, mirroring the pattern observed for displacements \cite{vaz_accuracy_2009}. In the current landscape, as computational models grow in size and with the surge in supercomputing and cloud computing capabilities, the emphasis on code parallelization has magnified. Finite volume methods, both fluid and solid types, have been particularly adaptive in this regard. Leveraging iterative linear solvers, tools like OpenFOAM are designed to harness hundreds or even thousands of CPU cores. This contrasts with many finite element strategies, which historically have favoured direct linear solvers. Consequently, their parallel efficiency tends to be restricted relative to iterative solvers, making the deployment on vast numbers of CPU cores less prevalent \cite{cardiff_thirty_2021}.

%The cell-centred finite volume method is used in this work where the unknowns are specified at the centre of the control volumes. \citet{demirdzic_numerical_1988}
% first proposed using the cell-centred finite volume method in its modern form for solid mechanics 30 years ago. This method was further developed by \citet{demirdzic_finite_1994} who generalised the original 2-D method to 3-D convex polyhedral cells. Another class of cell-centred method are the explicit Godunov-type cell-centred approaches based on the work of \citet{trangenstein_higher-order_1991}. This method was initially used to model the 1-D propagation of waves in elasto-plastic solids but has since been extended in various forms to 3-D grids \cite{sevilla_face-centred_2018,sevilla_locking-free_2018,lee_development_2013,haider_first-order_2017,haider_upwind_2018, maire_multi-scale_2009}. These methods, as well as other finite-volume based methods, are described in more detail in \citet{cardiff_thirty_2021}.




%% FVM for metal forming and related applications
%ADD Explicit contribution/novelties of this paper.
Three main contributions are proposed in this work:
(i) Nascent damage model implementations within a cell-centred finite volume framework, including a novel Lemaitre damage formulation for wire drawing;
(ii) Eulerian-style boundary conditions for continuous forming processes, where mesh layers are added and removed at the workpiece upstream and downstream boundaries.
(iii) A segregated large strain pressure-displacement finite volume formulation, where scaled Rhie-Chow stabilisation terms are proposed for quelling pressure oscillations while minimising over-smoothing of the damage fields.
%\begin{itemize}
%  \item First FVM large strain approach (p + d) for damage, including a novel Lemaitre damage model and a novel non-local damage approach.
%  \item novelty in FVM formulation: extension of the previous approach to use p + d and the importance of the Rhie-Chow term.
%  \item novel Eulerian layer-addition boundary conditions
%  \item Assessment of the approaches for predicting damage in wire forming
%\end{itemize}
%% Mention open-source implementation
All implementations are performed in the solids4foam toolbox \cite{Cardiff2018, Tukovic2018} for the open-source C++ software OpenFOAM, building on previous work related to metal forming \cite{cardiff_lagrangian_2017, clancy_improving_2019}.
Code and cases are publicly shared on GitHub at \url{http://github.com/awhelanUCD/solids4foam}.
%, an open-source C++ software that uses the finite volume method to solve solid and fluid mechanics problems. In particular, they have been implemented in the solids4foam OpenFOAM toolbox \cite{Cardiff2018, Tukovic2018}, building on previous work \cite{cardiff_eulerian-inspired_2017-1, cardiff_lagrangian_2017}.
%Additionally, these models have been implemented for the in-house Bekaert-v2.0 software, a toolbox for performing wire drawing and wire rolling simulations in OpenFOAM \cite{cardiff_eulerian-inspired_2017-1, cardiff_lagrangian_2017}.


The remainder of the paper is organised as follows:
Section \ref{sec:math_model} describes the mathematical model and presents the finite volume numerical method, where details of the elastoplastic damage laws are left to Section \ref{sec:constitutive_laws}.
%Section \ref{sec:numerical_methods} presents the proposed geometrically nonlinear, cell-centred finite volume framework, including stabilisation terms and the segregated solution algorithm details.
The implemented damage procedures are verified in Section \ref{sec:test_cases}, and applied to wire drawing in Section \ref{sec:wire_drawing}.
%The accuracy and robustness of the proposed numerical procedures are assessed against three experimental benchmark cases in Section \ref{sec:test_cases}
The article ends with a summary of the main conclusions.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Mathematical Model and Numerical Methods}\label{sec:math_model}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This section outlines the Lagrangian large strain, finite volume methodology, where details of the constitutive laws are left to Secton \ref{sec:constitutive_laws}.

\subsection{Linear Momentum Conservation}

The dynamic, Lagrangian, strong integral form of linear momentum conservation for a body $\Omega$, bounded by a surface $\Gamma$ with outwards pointing normal $\bb{n}$, can be expressed in \emph{total} Lagrangian form as
\begin{equation} \label{eqn:totalLagFormulation}
%    \int_{\mathrm{\Omega}} \frac{\partial }{\partial t} \left( \rho \frac{\partial \bb{u} }{\partial t} \right) d\mathrm{\Omega}
%    =
%    \oint_{\mathrm{\Gamma}}{\bb{n}\cdot\boldsymbol{\sigma}}\ d\mathrm{\Gamma}
    \int_{\mathrm{\Omega}_o} \rho_o \frac{\partial^2 \bb{u} }{\partial t^2} d\mathrm{\Omega}_o
    =
    \oint_{\mathrm{\Gamma_o}} \left( J \bb{F}^{-T} \cdot \bb{n}_o \right) \cdot \boldsymbol{\sigma} \ d\mathrm{\Gamma}_o
\end{equation}
or equivalently in \emph{updated} Lagrangian form as
\begin{equation} \label{eqn:updatedLagFormulation}
    \int_{\mathrm{\Omega_u}} \frac{\partial }{\partial t} \left( \rho_u \frac{\partial \bb{u} }{\partial t} \right) d\mathrm{\Omega}_u
    = \oint_{\mathrm{\Gamma_u}}(j\bb{f}^{-T}\cdot{\bb{n}_u)\cdot\boldsymbol{\sigma}}\ d\mathrm{\Gamma_u}
    %= \oint_{\mathrm{\Gamma_u}}(\frac{j}{J}\bb{f}^{-T}\cdot{\bb{n}_u)\cdot\boldsymbol{\tau}}\
\end{equation}
where $\rho$ is the density, $\bb{u}$ is the displacement vector, $\boldsymbol{\sigma}$ is the true (Cauchy) stress, and body forces are neglected.
Subscript $o$ indicates quantities in the initial reference configuration, and subscript $u$ indicates quantities in the updated configuration.
The two forms are connected through Nanson’s formula \cite{bathe_finite_1996}, which relate the deformed area vector $\bb{\Gamma}$ with the initial area vector $\bb{\Gamma}_{o}$:
\begin{equation}
    \bb{\Gamma} = J\bb{F}^{-T}\cdot\bb{\Gamma}_o
\end{equation}
The deformation gradient is defined as $\bb{F} = \textbf{I} + (\boldsymbol{\nabla} \boldsymbol{u})^T$ and its determinant (Jacobian) as $J = \text{det}(\boldsymbol{F})$.
%Equivalently, momentum conservation can be reformulated with respect to the initial reference configuration as
%where subscript $o$ indicates quantities in the initial reference configuration.
%To achieve this equivalent form, Nanson’s formula \cite{bathe_finite_1996} has been employed to 
%Similarly, the momentum equation can be reformulated with respect to the \emph{updated} configuration as
%\begin{equation}
%\label{eqn:updatedLagFormulation}
%    \int_{\mathrm{\Omega_u}} \frac{\partial }{\partial t} \left( \rho_u \frac{\partial \bb{u} }{\partial t} \right) d\mathrm{\Omega}_u
%    = \oint_{\mathrm{\Gamma_u}}(j\bb{f}^{-T}\cdot{\bb{n}_u)\cdot\boldsymbol{\sigma}}\ d\mathrm{\Gamma_u}
%    %= \oint_{\mathrm{\Gamma_u}}(\frac{j}{J}\bb{f}^{-T}\cdot{\bb{n}_u)\cdot\boldsymbol{\tau}}\
%\end{equation}
%where subscript $u$ indicates quantities in the updated configuration.
The \emph{relative} deformation gradient is given in terms of the displacement increment as $\bb{f}=\textbf{I} + \left[\bb{\nabla}(\Delta \bb{u}) \right]^T$ and the relative Jacobian as $j = \text{det}(\bb{f})$.

The conservation of linear momentum in integral form (Equations \ref{eqn:totalLagFormulation} and \ref{eqn:updatedLagFormulation}) can equally be applied to entire domain or a sub-region of it such as a computational cell, as is the basis of the cell-centred finite formulation presented below.
Although the total Lagrangian approach is a viable option for wire drawing, the current work adopts the updated Lagrangian approach as developing Eulerian-type upstream and downstream conditions (Section \ref{sec:euler_BCs}) is conceptually easier in an updated Lagrangian formulation.

The definition of the true stress in Equations \ref{eqn:totalLagFormulation} and \ref{eqn:updatedLagFormulation} comes from the constitutive law, as is described in Section \ref{sec:constitutive_laws}.


\subsection{Solution Domain Discretisation} \label{sec:solDomDiscret}

%- domain and time discretisation: time marching
%- summary FVM discretisation
%- details of stabilisation: pressure and Rhie-Chow
%- stress calculation: plasticity/damage procedure
%- numerics of constitutive laws
%- novel Lemaitre

%Discretisation of the solution domain comprises the discretisation of time and the discretisation of space. The total specified simulation time is divided into a finite number of time increments, t, and the discretised governing equations are solved in a time-marching manner. The solution domain space is divided into a finite number of contiguous convex polyhedral cells bounded by polygonal faces that do not overlap and fill the space completely. A typical control volume (or cell or control mass), shown in Figure 2, has a computational node P located at the cell centroid, with cell volume P , N is the centroid of a neighbouring control volume, face f has area vector  f , vector d f joins P to N and r is the positional vector of P . No distinction is made between different cell volume shapes, as all general polyhedra (for example tetrahedra, hexahedra, triangular prism, dodecahedra, etc.) are discretised in the same general fashion; this is in contrast to standard FE methods where shape functions are specific to the shape of the element.

%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.3\textwidth]{./figures/controlVolume.png}
%\caption{A polyhedral control volume. Taken from \cite{cardiff2016}}
%\label{fig:finite_volume}
%\end{center}
%\end{figure}

The solution domain is discretised in space and time.
The total specified simulation time is divided into a finite number of time increments $\Delta t$, and the discretised governing momentum equation is solved in a time-marching manner. 

The space domain is divided into a finite number of contiguous convex polyhedral cells.
The proposed solution discretisation follows closely the approach of \citet{cardiff_lagrangian_2017}; consequently, only an overview of the final discretised form of equations and adopted solution algorithm are given below.

%A cell or control volume is shown in Figure \ref{fig:finite volume}. It has the following associated values:
%\begin{itemize}
%	\item A computational node $P$ located at the centre of the cell
%	\item The cell volume $\Omega_{p}$
%	\item The centroid of a neighbouring cell $N$
%	\item Face $f$ with area vector $\bb{\Gamma}_f$
%    \item The positional vector of $P$ is $\textbf{r}$
%    \item $P$ and $N$ are joined by the vector $\bb{d}_{f}$
%\end{itemize}

The employed finite volume discretisation begins by applying the governing conservation equation (Equation \ref{eqn:updatedLagFormulation}) to each cell in the mesh.
To facilitate the use of a segregated solution algorithm, and the surface forces term (term on the right-hand side of Equation \ref{eqn:updatedLagFormulation}) is split into explicit and implicit components:
\begin{eqnarray} \label{eqn:MomentumImplicitExplicit}
%	\underbrace{\int_{\Omega_u} \frac{\partial}{\partial t}\left(\rho_u \frac{\partial\left(\boldsymbol{u}^{[m-1]}+\Delta \boldsymbol{u}\right)}{\partial t}\right) \mathrm{d} \Omega_u}_{\text {implicit }}
	\int_{\mathrm{\Omega_u}} \frac{\partial }{\partial t} \left( \rho_u \frac{\partial \bb{u} }{\partial t} \right) d\mathrm{\Omega}_u
	&=&
	\underbrace{\oint_{\mathrm{\Gamma}_u}{K_{imp}\  \bb{n}_u\cdot\bb{\nabla}\left(\Delta \bb{u} \right)}\ d\mathrm{\Gamma}_u}_{\text {implicit }} \notag \\
    &&+
    \underbrace{
    \oint_{\mathrm{\Gamma_u}}(j\bb{f}^{-T}\cdot{\bb{n}_u) \cdot \boldsymbol{\sigma}}\ d\mathrm{\Gamma_u}
    - 
    \oint_{\mathrm{\Gamma}_u}{K_{imp}\ 
 \bb{n}_u \cdot \bb{\nabla}\left(\Delta \bb{u}\right)}\ d\Gamma_u
 }_{\text {explicit }}  %\notag \\
% &&+ \; \mathcal{D}_{\text {Rhie-Chow }} 
\end{eqnarray}
where the first term on the right-hand side (Laplacian term) is treated implicitly, and the second and third terms on the right-hand side are treated in a explicit manner.
Here, by implicit, we mean that the term contributes coefficients to the resulting linear(-ised) system of equations.
In contrast, here, by explicit we mean that the terms are treated in a deferred correction manner; that is, they are evaluated using the latest available values; consequently, the explicit terms contribute only to the source of the system of linear equations.
The overall procedure is implicit in time in that the time step size is not constrained by the Courant–Friedrichs–Lewy condition.
From a deferred (or defect) correction perspective, this Laplacian term can be considered an approximate compact-stencil linearisation of the surface stress term.
This allows the coupled vector system to be temporarily decoupled into three scalar component equations.
These three scalar component equations can then be solved independently, where outer Picard iterations provide the inter-component coupling.
Unlike Newton-Raphson approaches, where quadratic convergence may be expected, linear convergence of the residuals can be expected when using a segregated approach; however, this disadvantage is offset in several ways: (i) an exact Jacobian stiffness matrix need not be assembled, which is often costly; (ii) a material tangent is not required for the material laws, as instead the scalar coefficient $K_{imp}$ is only required; (iii) outer Picard iterations are less expensive than Newton iterations as the discretised systems are smaller to assemble and quicker to solve; (iv) Picard iterations may provide superior convergence when the solution is far from the asymptotic region, potentially resulting in a more robust approach for highly nonlinear large strain fracture and damage cases.
Nonetheless, as noted previously \citep{cardiff_block-coupled_2016}, segregated solution procedures can require significantly more outer iterations and exhibit slow convergence relative to coupled approaches, particularly in high aspect ratio linear cases.
In the current work, 
% and third terms on the right-hand side of this equation represent an approximation of the traction field in terms of the displacement field. For this work, the term 
$K_{imp}$ is chosen following the work of \citet{jasak_application_2000} as %which found strong convergence for:
\begin{equation}
	K_{imp} = \frac{4}{3}\mu + \kappa
\end{equation}
where $\mu$ is the material shear modulus and $\kappa$ is the bulk modulus.
It should be reinforced that the value of $K_{imp}$ affects convergence but does not affect the final converged solution -- assuming convergence is achieved.

The primary unknown to be solved for is the displacement increment $\Delta \boldsymbol{u}=\boldsymbol{u}^{[m+1]}-\boldsymbol{u}^{[m]}$ where the superscript $[m]$ indicates a quantity from the previous time step and $[m+1]$ a quantity from the current (to be calculated) time step. 

%Each term of this equation is then discretised as follows (in order):
%\begin{itemize}
%	\item
The resulting conservation equation (Equation \ref{eqn:MomentumImplicitExplicit}) is applied to each cell (control volume) in the computational mesh and discretised in terms of the displacement increment at the cell centre/centroid $(\Delta \bb{u})_P$ and at the centres of the neighbouring cells $N_i$.

 The temporal volume integral term is discretised in space using the second-order mid-point rule and discretised in time using a first-order accurate implicit backward Euler scheme \cite{jasak_application_2000}:
% The temporal component containing $\bb{u}^{\left[m-1\right]}$ is discretized similarly to what is shown in equation 2.50. However, this term is fully explicit, meaning it only contributes to the source vector in the resulting equation system.
%While it's easy to discretise this temporal term with a second-order accuracy, as demonstrated in the FV method in \citet{jasak_application_2000}, the current elastoplastic method's temporal accuracy is constrained by the first-order backward Euler integration used for the plastic deformation rate for the constitutive law in the models we will encounter throughout this work.
\begin{eqnarray} \label{eq:timeTerm}
	\int_{\mathrm{\Omega_u}} \frac{\partial }{\partial t} \left( \rho_u \frac{\partial (\Delta \bb{u}) }{\partial t} \right) d\mathrm{\Omega}_u
	&\approx&
	\frac{\partial }{\partial t} \left( \rho_u \frac{\partial (\Delta \bb{u}) }{\partial t} \right)_P \mathrm{\Omega}_P \notag \\
	&\approx&
	\left(
	\frac{ \rho_u^{[m+1]} \frac{\partial (\Delta \bb{u}) }{\partial t}^{[m+1]}
	- \rho_u^{[m]} \frac{\partial (\Delta \bb{u}) }{\partial t}^{[m]}}{ \Delta t } \right)_P
	\mathrm{\Omega}_P \notag \\
	&\approx&
	\left[
	\frac{ \rho_u^{[m+1]} \left(\frac{\Delta \bb{u}^{[m+1]} - \Delta \bb{u}^{[m]}}{\Delta t} \right)
	- \rho_u^{[m]} \left(\frac{\Delta \bb{u}^{[m]} - \Delta \bb{u}^{[m-1]}}{\Delta t} \right)
	}{ \Delta t } 
	\right]_P \mathrm{\Omega}_P \notag \\
	&\approx&
	\frac{1}{\Delta t^2} \left[
	 \rho_{u_P}^{[m+1]} \Delta \bb{u}^{[m+1]}_P
	- \left(\rho_{u_P}^{[m+1]} + \rho_{u_P}^{[m]} \right)  \Delta \bb{u}^{[m]}_P
	+ \rho_{u_P}^{[m]}  \Delta \bb{u}^{[m-1]}_P
	\right]
	 \mathrm{\Omega}_P \notag \\
%	\int_{\mathrm{\Omega}_u}{\frac{\partial}{\partial t}\left(\rho_u\dot{\bb{u} }\right)}d\mathrm{\Omega}_u &\approx&\ \frac{1}{\mathrm{\Delta}t^{\left[m\right]}}\left[\left(\rho_u\mathrm{\Omega}_u\right)_p^{\left[m\right]}\left(\frac{\mathrm{\Delta}\bb{u}_P^{\left[m\right]}-\mathrm{\Delta}\bb{u}_P^{\left[m-1\right]}}{\mathrm{\Delta}t^{\left[m\right]}}\right)\right. \notag \\
% &&-\left(\rho_u\mathrm{\Omega}_u\right)_p^{\left[m-1\right]}\left.\left(\frac{\mathrm{\Delta}\bb{u}_P^{\left[m-1\right]}-\mathrm{\Delta}\bb{u}_P^{\left[m-2\right]}}{\mathrm{\Delta}t^{\left[m-1\right]}}\right)\right]
\end{eqnarray}
The $\boldsymbol{u}^{[m-1]}$ term is discretised in a similar fashion, noting that $\boldsymbol{u}^{[m]} = \boldsymbol{u}^{[m-1]} + \Delta \boldsymbol{u}$ in Equation \ref{eqn:MomentumImplicitExplicit}.
In the cases examined in this work, inertial effects are relatively small, so temporal accuracy is not a concern.
All dependent variables must be specified at the initial time.

%\item
 The surface forces Laplacian term (first term on the right-hand side of Equation \ref{eqn:MomentumImplicitExplicit}) is discretised using central differencing with over-relaxed non-orthogonal correction \cite{demirdzic_finite_1993, jasak_application_2000, cardiff_development_2014, cardiff_large_2014, cardiff_lagrangian_2017}:
\begin{eqnarray} \label{eq:diffusion}
	\underbrace{\oint_{\mathrm{\Gamma}_u}
	K_{imp} \bb{n}_u\cdot\nabla\left(\Delta\bb{u}\right) d\mathrm{\Gamma}_u }_{\text {implicit }}
	&\approx&
	\sum_{f \in N_f} K_{imp}^f \left|\boldsymbol{\Delta}_{u_f}\right|\left(\frac{\Delta \bb{u}_{N_f} - \Delta \bb{u}_P}{\left|\bb{d}_f\right|}\right)\left|\bb{\Gamma}_{u_f}\right| \notag \\
	    &&+ \sum_{f \in N_f} K_{imp}^f \; \bb{k}_{u_f} \cdot
	    \left[
	    \boldsymbol{\nabla} \left(\mathrm{\Delta}\bb{u}\right)
	    \right]_f
	    \left|\bb{\Gamma}_{u_f}\right|
\end{eqnarray}
where $N_f$ represents the set of faces $f$ in cell $P$, and neighbouring cell centre $N_f$ shares face $f$ with the cell $P$.
The over-relaxed orthogonal vector $\boldsymbol{\Delta}_{u_f} = \frac{\boldsymbol{d}_{u_f}}{\boldsymbol{d}_{u_f} \cdot \boldsymbol{n}_{u_f}}$ and non-orthogonal correction vector $\boldsymbol{k}_{u_f}=\boldsymbol{n}_{u_f}-\boldsymbol{\Delta}_{u_f}$, where $\boldsymbol{n}_{u_f}$ is the outward-facing unit normal to the face $f$.
Vector $\boldsymbol{d}_{u_f}$ connects the centre of cell $P$ with the centre of cell $N_f$ in the updated configuration.
The first term on the right-hand side is treated implicitly, while the second term - representing non-orthogonal corrections at the face - is treated in a deferred correction manner.

%	\item
 The remaining surface force terms (second and third terms on the right-hand side of Equation \ref{eqn:MomentumImplicitExplicit}) are discretised by assuming that they vary linearly across the face as follows \cite{noauthor_openfoam_2015}:
\begin{equation}
	\underbrace{ \oint_{\mathrm{\Gamma_u}}(j\bb{f}^{-T}\cdot{\bb{n}_u)\cdot\boldsymbol{\sigma}}\ d\mathrm{\Gamma_u}  }_{\text {explicit}}
%	&=& \sum_{F}\int_{\mathrm{\Gamma_{uf}}}(j\bb{f}^{-T}\cdot{\bb{n}_u)\cdot\boldsymbol{\sigma}}d\Gamma_{uf}
	\approx 
	\sum_{f \in N_f} \bb{\Gamma}_{u_f} \cdot
	\left(j\boldsymbol{\sigma} \bb{f}^{-T}\right)_f
\end{equation}
	
\begin{equation} \label{eq:diffusion_exp}
	    \underbrace{ \oint_{\mathrm{\Gamma}_u}{K_{imp} \; \bb{n}_u\cdot \bb{\nabla} \left(\Delta\bb{u}\right)}\ d\mathrm{\Gamma}_u }_{\text {explicit}}
	    %= 
%	    \sum_{F}\int_{\mathrm{\Gamma}_{uf}}{\left(\frac{4}{3}\mu+K\right)\bb{n}_u\cdot\nabla\left(\Delta\bb{u}\right)}\ d\mathrm{\Gamma}_{uf}
	\approx
	\sum_{f \in N_f} K_{imp}^f \; \bb{\Gamma}_{u_f} \cdot \left[\bb{\nabla}\left(\mathrm{\Delta}\bb{u}\right)\right]_f
\end{equation}

The terms at a face, indicated by the subscript $f$, are calculated by linearly interpolating from the adjacent cell-centres.
The cell-centre gradients $\bb{\nabla}\left(\mathrm{\Delta}\bb{u}\right)$ are determined using a least squares method \cite{noauthor_openfoam_2015}.

%\end{itemize}


\subsection{Boundary conditions}
Boundary conditions are enforced through modification of the discretised expressions on boundary faces.
Five classes of boundary conditions are employed in the current work (prescribed displacement, prescribed traction, symmetry plane, axisymmetric/wedge, frictional contact) as described below.
An additional boundary condition where the normal component of the displacement is prescribed and the shear traction is zero is also used; the discretisation of this condition employs the prescribed displacement condition in the boundary normal direction and the traction condition ins the tangential direction.
%\begin{itemize}
%	\item Prescribed displacement,
%	\item Prescribed traction,
%	\item Symmetry,
%	\item Axisymmetric (wedge),
%	\item Frictional contact.
%\end{itemize}
%This enforcement of these five conditions is described below.

\paragraph{Prescribed displacement}
The displacement boundary condition, a Dirichlet condition, may be constant in time or time-varying and fixes the value of $\bb{u}$ at the centre of a boundary face.
The corresponding displacement increment at the boundary face $\Delta \bb{u}_b = \bb{u}^{[m+1]} - \bb{u}^{m}$ is substituted into the calculation of the surface normal gradient term in Equation \ref{eq:diffusion}.
The resulting contribution of a boundary face $b$ to the discretised diffusion term becomes:
\begin{eqnarray} \label{eq:diffusionBC}
	\underbrace{ \int_{\mathrm{\Gamma}_{u_b}}
	 K_{imp} \bb{n}_{u_b} \cdot\nabla\left(\Delta\bb{u}\right) d\mathrm{\Gamma}_{u_b} }_{\text {implicit}}
	&\approx&
	K_{imp}^b \left|\boldsymbol{\Delta}_{u_b}\right|\left(\frac{\Delta \bb{u}_{b} - \Delta \bb{u}_P}{\left|\bb{d}_b\right|}\right)\left|\bb{\Gamma}_{u_b}\right| \notag \\
	    &&+ K_{imp}^b \; \bb{k}_{u_b} \cdot
	    \left[
	    \boldsymbol{\nabla} \left(\mathrm{\Delta}\bb{u}\right)
	    \right]_P
	    \left|\bb{\Gamma}_{u_b}\right|
\end{eqnarray}
where $\bb{d}_b$ connects the centre of cell $P$ with the boundary face centre in the updated configuration, and the non-orthogonal correction vector $\bb{k}_{u_b} = (\textbf{I} - \bb{n}\bb{n}) \cdot \bb{d}_b$.



\paragraph{Prescribed traction}
The traction boundary condition, constant in time or time-varying, is implemented as a Neumann condition where the normal gradient, $\bb{g}_b \equiv \bb{n} \cdot \boldsymbol{\nabla} \left(\mathrm{\Delta}\bb{u}\right)$, of the displacement increment is specified on the boundary face.
The specified normal boundary gradient, may be directly substituted into the discretised diffusion term, Equation \ref{eq:diffusion}:
\begin{eqnarray}
	\underbrace{ \int_{\mathrm{\Gamma}_{u_b}}
	K_{imp} \bb{n}_{u_b} \cdot\nabla \left(\Delta\bb{u}\right) d\mathrm{\Gamma}_{u_b} }_{\text {implicit}}
	&\approx&
	K_{imp}^b \, \bb{g}_b \left|\bb{\Gamma}_{u_f}\right|
\end{eqnarray}

The normal gradient, $\bb{g}_b$, which corresponds to the specified boundary traction, $\bb{T}_b$, is determined from the expression for the discretised boundary traction as
\begin{eqnarray} \label{eq:tracBC}
	\bb{T}_b &=& \bb{n}_b \cdot \boldsymbol{\sigma}_b \notag \\
		&=& K_{imp}^b \, \bb{g}_b + \bb{n}_b \cdot \boldsymbol{\sigma}_b - K_{imp}^b \bb{n}_b \cdot \left[\nabla \left(\Delta\bb{u}\right) \right]_b
\end{eqnarray}
which is rearranged to give $\bb{g}_b$:
\begin{eqnarray} \label{eq:snGradTrac}
	\bb{g}_b &=&
		\frac{\bb{T}_b -  \bb{n}_b \cdot \boldsymbol{\sigma}_b - K_{imp}^b \bb{n}_b \cdot \left[ \nabla \left(\Delta\bb{u}\right) \right]_b}{K_{imp}^b}
\end{eqnarray}

At each outer (Picard) iteration, $\bb{g}_b$ is explicitly updated according to Equation \ref{eq:snGradTrac}, where all terms on the right-hand side are evaluated using the latest available values.
At convergence within each time step, the $K_{imp}^b \, \bb{g}_b$ and $K_{imp}^b \bb{n}_b \cdot (\nabla \phi)_b$ terms in Equation \ref{eq:tracBC} cancel out and the traction condition is enforced.
It is also worth noting that substitution of Equation \ref{eq:snGradTrac} into discretised diffusion term results in the contribution to the source of the entire linear system being the force on the face.
If the value of $\Delta \bb{u}_b$ is needed at the face $b$, it is obtained by extrapolating from the adjacent cell centre ($\Delta \bb{u}_P$) as
\begin{eqnarray}
	\left(\bb{\Delta} \bb{u}\right)_b &=&
		 \left(\bb{\Delta} \bb{u}\right)_P
		 + (\bb{n}_b \cdot \bb{d}_b) g_b
		 + \left[ \left(\textbf{I} - \bb{n}_b \bb{n}_b \right) \cdot \bb{d}_b \right] \cdot \left[\nabla \left(\bb{\Delta} \bb{u}\right)\right]_P
\end{eqnarray}
%using $\bb{g}_b$ and, if needed, $\bb{k}_{u_b}$ and $\left[\boldsymbol{\nabla} \left(\mathrm{\Delta}\bb{u}\right)\right]_P$.


\paragraph{Symmetry plane}
The symmetry plane is a mixed condition, where the normal component is a Dirichlet condition and the tangential component is a Neumann condition.
The component of the dependent variable normal to the boundary is zero and the shear/tangential traction is zero.
For boundary faces on a symmetry plane, the mirror reflection $\left(\bb{\Delta} \bb{u}\right)_N$ of the $\left(\bb{\Delta} \bb{u}\right)_P$ can be obtained as
\begin{eqnarray}
	\left(\bb{\Delta} \bb{u}\right)_N &=& \bb{R}_m \cdot \left(\bb{\Delta} \bb{u}\right)_P \notag \\
		&=& \left(\textbf{I} - 2 \bb{n}_b \bb{n}_b \right) \cdot \left(\bb{\Delta} \bb{u}\right)_P
\end{eqnarray}
where $\bb{R}_m$ is termed the reflection tensor.
The discretisation in Equation \ref{eq:diffusion} takes the same form with the mirror reflected values used at boundary faces on the symmetry plane.
The $\bb{d}_b$ vector at a symmetry plane boundary face is calculated as
\begin{eqnarray}
	 \bb{d}_b &=& \bb{R}_m \cdot \bb{C}_P - \bb{C}_P
\end{eqnarray}
where $\bb{C}_P$ is the positional vector of the centre of cell $P$.
This means that symmetry planes are orthogonal by defintion and the non-orthogonal correction (second term on the right-hand side of Equation \ref{eq:diffusion}) drops out.
Further details on the implementation of symmetry planes in segregated cell-centred finite volume formulations can be found in \citet{Demirdzic2022}.

In the approach adopted here, displacement increment values on the symmetry planes are calculated as
\begin{eqnarray}
	\left(\bb{\Delta} \bb{u}\right)_b = \frac{\left(\bb{\Delta} \bb{u}\right)_P^* + \left(\bb{\Delta} \bb{u}\right)_N^*}{2}
\end{eqnarray}
where cell-centred values corrected for mesh skewness errors are
\begin{eqnarray}
	 \left(\bb{\Delta} \bb{u}\right)_P^* &=&
	 	\left(\bb{\Delta} \bb{u}\right)_P + \left[ (\textbf{I} - \bb{n}\bb{n}) \cdot \bb{d}_b \right] \cdot \left[ \bb{\nabla} \left(\bb{\Delta} \bb{u}\right) \right]_P \\
	 \left(\bb{\Delta} \bb{u}\right)_N^* &=& \bb{R}_m \cdot \left(\bb{\Delta} \bb{u}\right)_P^*
\end{eqnarray}



\paragraph{Axisymmetric (wedge)}
Axisymmetry problems are approached by constructing a wedge-shaped slice of the domain \citep{greenshieldsweller2022}, where a small wedge angle (e.g., 1$^\circ$) is adopted to minimise geometry errors.
Axisymmetric conditions are applied to the two sloping sides of the wedge.
%This approach is the standard approach for simulating axisymmetric cases in the OpenFOAM software \citep{greenshieldsweller2022}.
Similar to the symmetry condition, the axisymmetric condition replaces the neighbouring displacement increment value $\left(\bb{\Delta} \bb{u}\right)_N$ at a axismmetric boundary face in Equation \ref{eq:diffusion} with the equivalent reflected value.
Unlike the symmetry condition, the reflection on an axisymmetric boundary comes from a rotation about the axis:
\begin{eqnarray}
	\left(\bb{\Delta} \bb{u}\right)_N &=& \bb{R}_c \cdot \left(\bb{\Delta} \bb{u}\right)_P
\end{eqnarray}
where $\bb{R}_c = \bb{R}_f \bb{R}_f$ is the rotation tensor that rotates values on the centre plane (centre plane of the wedge-shapred slice) to the equivalent location on a neighbouring adjacent wedge centre plane.
The $\bb{R}_f$ tensor, which rotates values on the centre plane to the sloping side of the domain boundary, is calculated according to the Euler-Rodrigues rotation formula \citep{greenshieldsweller2022, rodrigues1815attraction}
\begin{eqnarray}
	\bb{R}_f = (\bb{n}_c \cdot \bb{n}_f) \mathbf{I} + \left[1 - (\bb{n}_c \cdot \bb{n}_f) \right] \bb{n}_a \bb{n}_a + \bb{n}_f \bb{n}_c - \bb{n}_c \bb{n}_f
\end{eqnarray}
where $\bb{n}_a = (\bb{n}_c \times \bb{n}_f)/|\bb{n}_c \times \bb{n}_f)|$ is the unit axis direction, $\bb{n}_c$ is the unit normal of the centre plane, and $\bb{n}_f$ is the unit normal of the sloping side of the domain boundary.

Similar to the symmetry plane, the displacement increment values on the sloping wedge boundary planes are calculated as
\begin{eqnarray}
	\left(\bb{\Delta} \bb{u}\right)_b =
		\bb{R}_f \cdot
		\left\{
			\left(\bb{\Delta} \bb{u}\right)_P + \bb{k}_b  \cdot \left[ \bb{\nabla} \left(\bb{\Delta} \bb{u}\right) \right]_P 
		\right\}
\end{eqnarray}
where, once again, the second term within the brackets on the right-hand side corrects for mesh skewness.
The $\bb{k}_b$ correction vector is calculated as
\begin{eqnarray}
	 \bb{k}_b &=& \bb{C}_b - \bb{R}_f \cdot \bb{C}_P
\end{eqnarray}
and represents the vector from the cell centre $\bb{C}_P$ rotated to the sloping wedge patch and the face centre $\bb{C}_b$ at the patch.


\paragraph{Frictional contact}
Coulomb friction contact boundaries are handled using an iterative penalty method, as described previously by the authors \citep{cardiff_lagrangian_2017, cardiff_development_2012}.
From an implementation perspective, the contact boundaries are a special type of prescribed traction condition where the traction distribution is re-calculated every solution outer (Picard) iteration according to a penalty law formulation.
More recent extensions of this approach have been proposed by Batisti\'{c} et al.\ \citep{Batistic2022, Batistic2023}, including segment-to-segment and implicit approaches, but these are not used in the current work.

% account for either the known displacement components in Dirichlet conditions or the known traction for Neumann conditions.
%Mixed condition conditions, such as symmetry planes, treated each component as 
%The expressions for diffusion fluxes and sources remain valid for a Dirichlet boundary condition, but the user-specified boundary value is used in place of the neighbouring cell-centre value.
%On boundaries where Neumann boundary conditions are specified, the boundary fluxes are added to the source term, and the variable values at the boundary are extrapolated from the internal domain using the specified boundary gradient. This process is explained in more detail in \cite{jasak_application_2000}.
%This method involves measuring the penetration between intersecting cells, calculating penalty forces, and applying them as a Neumann boundary condition. This approach, which was developed for OpenFOAM \cite{cardiff_development_2012}, has also been expanded by the same authors to include the effects of Coulomb friction \cite{cardiff_lagrangian_2017}, which is the friction assumption used in the simulations in this thesis.



\subsubsection{Rhie-Chow Stabilisation} \label{sec:RhieChowStab}
The difference in the computational stencil for the first and third terms on the right-hand side in Equation \ref{eqn:MomentumImplicitExplicit} introduces third-order numerical diffusion to the discretisation, which quells spurious zero-energy checkerboarding solution oscillations.
First introduced by Rhie and Chow \cite{rhie_numerical_1983} for cell-centred finite volume methods, \citet{demirdzic_numerical_1995} extended this approach for solid mechanics.
% based on the earlier approach of Rhie and Chow \citet{demirdzic_numerical_1995}.
%One issue encountered with the finite volume method is that the discretisation of the governing conservation of momentum equation ( can be unstable and is known to suffer from checker-boarding errors .
%In order to rectify these issues, the Rhie-Chow stabilisation term \cite{rhie_numerical_1983} as introduced into solid mechanics by  is added to the discretised divergence of the stress in equation \ref{eqn:MomentumImplicitExplicit}.
In the current approach, the Rhie-Chow stabilisation term $\mathcal{D}_{\text {Rhie-Chow }}$ takes the following form:
\begin{equation} \label{eq:RhieChow}
	\mathcal{D}_{\text {Rhie-Chow }}
%	&=\sum_{f=1}^{n \text { Faces }}\left\{K_f\left[\left|\boldsymbol{\Delta}_f\right| \frac{\boldsymbol{u}_{N_f}-\boldsymbol{u}_P}{\left|\boldsymbol{d}_f\right|}+\left(\boldsymbol{\Gamma}_f-\boldsymbol{\Delta}_f\right) \cdot(\boldsymbol{\nabla} \boldsymbol{u})_f\right]-\boldsymbol{\Gamma}_f \cdot\left[K_f(\boldsymbol{\nabla} \boldsymbol{u})_f\right]\right\} \\
	= \sum_{f \in N_f} K_{imp}^f
	\left[
	\left|\boldsymbol{\Delta}_f\right| \frac{\Delta \boldsymbol{u}_{N_f} - \Delta \boldsymbol{u}_P}{\left|\boldsymbol{d}_f\right|}
	- \boldsymbol{\Delta}_f \cdot\left[\boldsymbol{\nabla} (\Delta  \boldsymbol{u}) \right]_f
	\right]
	\left|\bb{\Gamma}_{u_f}\right| 
\end{equation}
which comes from the difference between Equations \ref{eq:diffusion} and \ref{eq:diffusion_exp}.
The first term on the right-hand side represents a compact stencil (two-node) approximation of the face normal gradient, while the second term represents a larger stencil approximation.
These two terms cancel out in the limit of mesh refinement (or if the solution varies linearly); otherwise, they produce a stabilisation effect that tends to smooth the solution fields.
As the term reduces at a third-order rate, it does not affect the overall scheme's second-order accuracy.

As shown in Section \ref{sec:test_cases}, the magnitude of the Rhie-Chow stabilisation affects the localisation behaviour for damage and fracture mechanics models, with a tendency to artificially \emph{smear} damage fields.
%In this section, this effect will be explored and quantified.
Two mitigation strategies are proposed here to produce a modified Rhie-Chow stabilisation $\hat{\mathcal{D}}_{\text {Rhie-Chow}}$:
\begin{enumerate}[label=(\alph*)]
	\item The Rhie-Chow stabilisation is scaled by a global scalar constant $0 \leq \mathcal{R}$:
	\begin{equation}
		\hat{\mathcal{D}}_{\text{Rhie-Chow}} = \mathcal{R} \; \mathcal{D}_{\text {Rhie-Chow}}
	\end{equation}
	\item The Rhie-Chow stabilisation is scaled by a global scalar constant in addition to a damage-dependent field:
	\begin{equation}
		\hat{\mathcal{D}}_{\text{Rhie-Chow}} = \mathcal{R} (1-D)^2 \; \mathcal{D}_{\text {Rhie-Chow}}
	\end{equation}
\end{enumerate}
In the first approach, the smoothing effect is reduced globally, lessening the smearing of damage fields; however, this approach's disadvantage is that solution convergence is slowed as the stabilisation term is reduced in magnitude everywhere.
In addition, numerical oscillations are more likely to appear, particularly in regions undergoing purely elastic deformation where no dissipation mechanisms exist.
In the second approach, a damage variable $0 < D \leq 1$ (to be introduced in Section \ref{sec:constitutive_laws}) reduces the smoothing effect only in regions of damage.
The effect of these proposed modifications is examined in Section \ref{sec:RhieChowResults}.
Although the purpose of the proposed modifications is to reduce the amount of stabilisation, $\mathcal{R}$ is not limited to be less than unity and hence can be used to increase the amount of stabilisation if desired.

%\begin{equation}
%\label{eqn:scaleEquation}
%K_f=\mathcal{R} \left(2 \mu+\lambda\right)
%\end{equation}
%where $\mathcal{R}$ is the Rhie-Chow scale factor.

%In order to mitigate the effect of the Rhie-Chow term on the material behaviour, a strategy is proposed in this work whereby the Rhie-Chow scale factor $\mathcal{R}$ in equation \ref{eqn:scaleEquation} is replaced with a field $\mathcal{R}_{field}$ that is a function of the damage field $D$ in the case of the Lemaitre model and the crack variable $d$ in the phase field model. 
%\begin{equation}
%   \mathcal{R}_{field}(D)=(1-D)^2\mathcal{R}
%\end{equation}
%\begin{equation}
%   \mathcal{R}_{field}(d)=(1-d)^2\mathcal{R} 
%\end{equation}


\subsubsection{Hydrostatic Pressure Calculation} \label{sec:pressureApproach}
Displacement-only formulations are known to be susceptible to numerical hydrostatic pressure oscillations in regions of large isochoric plastic strains.
In \citet{cardiff_lagrangian_2017}, it was proposed to smooth the relative deformation gradient Jacobian field $j$.
In contrast, the current approach proposes to decompose the stress tensor into deviatoric and volumetric terms, $\bb{\sigma} = \text{dev}(\bb{\sigma}) - p \textbf{I}$, and solve a smoothed pressure Poisson equation:
\begin{equation}
%	p = -\frac{\kappa}{2} (J^{2} - 1) + \mathcal{D}_{\text{Rhie-Chow}}^p
	p = \hat{p} + \mathcal{D}_{\text{Rhie-Chow}}^p
\end{equation}
%where $p = - \text{tr}(\bb{\sigma})/3$ is the hydrostatic pressure.
where $\hat{p}$ is the hydrostatic pressure calculated directly from the displacement field, e.g. $\hat{p} = -\sfrac{1}{J} \left[\kappa \, \text{tr}\left( \bb{\epsilon} \right)\right]$.
% and the trace operator is indicated by $\text{tr}(\bullet)$.
The Rhie-Chow \emph{pressure} stabilisation term $\mathcal{D}_{\text{Rhie-Chow}}^p$ is discretised according to Equation \ref{eq:RhieChow} with the displacement increment $\Delta \bb{u}$ replaced by the pressure $p$.
Similar to the discretised momentum equation, the magnitude of the Rhie-Chow stabilisation term can be controlled with a global scale constant $0 \leq \mathcal{R}_p$.
The effect of the Rhie-Chow stabilisation term here is to smooth any pressure oscillations.
The final stabilised form of the pressure Poisson equation is 
\begin{equation} \label{eq:pressureEqn}
%	p - \mathbb{D} \bb{\nabla}^2 p = -\frac{\kappa}{2} (J^{2} - 1) - \bb{\nabla} \cdot \left( \mathbb{D} \bb{\nabla} p \right)
	p - \mathbb{D} \bb{\nabla}^2 p = \hat{p} - \bb{\nabla} \cdot \left( \mathbb{D} \bb{\nabla} p \right)
\end{equation}
where the terms on the left-hand side are discretised implicitly, and the terms on the right-hand side are discretised using deferred corrections, following similar methods to Equations \ref{eq:timeTerm} and \ref{eq:diffusion}.
The second terms on the left and right-hand sides come from the Rhie-Chow stabilisation.
The described approach is similar to the formulation proposed by Bijelonja et al. \cite{Bijelonja2002, Bijelonja2005a, Bijelonja2005b, Bijelonja2006} for incompressibility, quasi-incompressibility and elastoplasticity.
The scalar coefficient $\mathbb{D}$ ensures the stabilisation is scaled appropriately. Following a similar approach to SIMPLE-type computational fluid dynamic procedures, this term is calculated for a cell $P$ in terms of the momentum equation diagonal coefficient (first term on the right-hand side of Equation \ref{eq:diffusion}):
\begin{equation}
	\mathbb{D} = \mathcal{R}_p K_{imp} \, \Omega_P \sum_{f \in N_f} 
	 \frac{\left|\boldsymbol{d}_f\right|}{\left|\boldsymbol{\Delta}_f\right| \left|\bb{\Gamma}_{u_f}\right| }
\end{equation}

As the pressure fields are typically relatively smooth, the predictions have been found to be relatively insensitive to the value of $\mathcal{R}_p$, where order of magnitude changes produce minimal effects on the results.
Values in the range $1 \leq \mathcal{R}_p \leq 10^3$ are suitable for the types of cases examined in this work.


%%%%
\subsection{Solution Algorithm}
%%%%
The linear momentum equation is discretised for each control volume $P$ in component form, and three linear algebraic equations of the following form is assembled \cite{jasak_application_2000}:
\begin{equation}
a_P \Delta {u}_P^i + \sum_{f \in N_f}  a_{n_f} \Delta {u}_{N_f}^i = \bb{b}_P^i
\end{equation}
where $\Delta {u}_p^i$ is the i$^{th}$ component of the displacement increment at cell $P$, $\Delta {u}_{N_f}^i$ is the i$^{th}$ component of the displacement increment at neighbouring cell $N_f$, and ${b}_p^i$ is i$^{th}$ component of the source vector contribution.
The scalar central coefficient $a_{p}$, the scalar coefficients associated with the centre of neighbouring cell ${a}_{n_f}$ (which shares a face $f$ with cell $P$), and the source vector $\bb{b}_P$ are
\begin{eqnarray}
	{a}_p &=&
		\frac{\rho_{u_P} \mathrm{\Omega}_P^{[m+1]} }{\Delta t^2}	 	
		+ \sum_{f \in N_f} K_{imp}^f  \left|\bb{\Gamma}_{u_f}\right| \frac{ \left|\boldsymbol{\Delta}_{u_f}\right| }{\left|\bb{d}_f\right|} \\
	a_{n_f} &=&
		- K_{imp}^f  \left|\bb{\Gamma}_{u_f}\right| \frac{ \left|\boldsymbol{\Delta}_{u_f}\right| }{\left|\bb{d}_f\right|} \\
	\bb{b}_P &=&
		\frac{\mathrm{\Omega}_P}{\Delta t^2} \left[
		\left(\rho_{u_P}^{[m+1]} + \rho_{u_P}^{[m]} \right)  \Delta \bb{u}^{[m]}_P
		- \rho_{u_P}^{[m]}  \Delta \bb{u}^{[m-1]}_P 
		\right] \notag \\
		&&+ \sum_{f \in N_f} \bb{\Gamma}_{u_f} \cdot	\left(j\boldsymbol{\sigma} \bb{f}^{-T}\right)_f \notag \\
		&&- \sum_{f \in N_f} K_{imp}^f \; \bb{\Gamma}_{u_f} \cdot \left[\bb{\nabla}\left(\mathrm{\Delta}\bb{u}\right)\right]_f \notag \\
		&&+ \sum_{f \in N_f} K_{imp}^f \; \bb{k}_{u_f} \cdot
		    \left[
		    \boldsymbol{\nabla} \left(\mathrm{\Delta}\bb{u}\right)
		    \right]_f
		    \left|\bb{\Gamma}_{u_f}\right|
\end{eqnarray}



These linear algebraic equations are then assembled for all control volumes, creating a system of linear algebraic equations for each direction $i$:
\begin{equation}
    \left[\bb{K}\right]
    \left[\bb{u}\right] =
    \left[ \bb{f} \right]
\end{equation}
where $\left[\bb{K}\right]$ is an $M \times M$ sparse, symmetric coefficient matrix containing the coefficients from the implicit operators, with $M$ being the total number of cells.
The matrix $\left[\bb{K}\right]$ is the same for each direction before boundary condition contributions are included, meaning the matrix need only be formed once and stored once per time step.
The solution vector $\left[\bb{u}\right]$ contains a component (e.g., $x$, $y$, or $z$) of the unknown cell-centre displacement increments $\Delta\bb{ u}$, and $\left[\bb{f}\right]$ is the source term containing a component of the deferred correction terms.
During the stress calculation, a similar scalar system is formed and solved for the hydrostatic pressure (Equation \ref{eq:pressureEqn}).

%A segregated solution procedure is employed, where the displacement vector components are solved for separately and sequentially in the $x, y$ and $z$ directions.
As noted in Section \ref{sec:solDomDiscret}, a segregated solution algorithm is employed where the governing vector momentum equation is temporarily decoupled and three scalar equations are solved; outer Picard iterations at each time step provide the inter-equation coupling.

%A simple predictor step based on the response of a linear elastic material strained in one dimension is employed (the first term on the RHS of equation \ref{eqn:MomentumImplicitExplicit}).
%In contrast, typical finite element approaches use a Newton-Raphson loop to account for nonlinearities and thus employ the consistent tangent matrix to achieve quadratic convergence \cite{bathe_finite_1996}.
%However, a full, consistent tangent matrix is not easily used in the segregated approach.
%However, a consistent tangent matrix can also be difficult to calculate in the damage and fracture models, and convergence difficulties can be encountered.
%The current method employs Picard/FixedPoint iterations to account for the nonlinearities and hence does not require a consistent tangent matrix.
%Outer iterations are performed to account for the inter-equation coupling and the linearized nonlinear terms.
The \emph{inner} linear sparse system is iteratively solved using an incomplete Cholesky pre-conditioned conjugate gradient method \cite{jacobs_generalization_1986}.
%In non-linear problems, this system of equations is solved multiple times with updated coefficients in a fixed-point iteration scheme. 
As noted in previous articles on segregated methods, the inner system need not be solved to a tight tolerance as coefficients and source terms are approximated from the previous increment; a reduction in the residuals of one order of magnitude is typically sufficient. The outer iterations are performed until the predefined tolerance, typically $1 \times 10^{-6}$, has been achieved \cite{cardiff_lagrangian_2017}. 

In the current updated Lagrangian approach, the mesh is moved to the deformed configuration at the end of each time step rather than after each outer iteration.
Since the displacements are calculated at the cell centres, a linear least-squared method is employed here \cite{cardiff_lagrangian_2017} to interpolate the displacement increments to the mesh vertices, allowing the mesh to be moved.
%In this method, a linear least squares plane is fit through a vertex and its immediately adjacent cell centres. For boundary vertices, boundary face-centre values are also included in the fitting.

The procedures have been implemented and publicly shared within the solids4foam toolbox \citep{Cardiff2018, Tukovic2018} of the open-source OpenFOAM software.

Algorithm \ref{alg:solAlg} shows an overview of the solution algorithm.
\begin{algorithm}[htb] \label{alg:solAlg}
\SetAlgoLined
\text{\textbf{for all} time steps \textbf{do}} \\
\ \ \text{       \textbf{while} convergence not reached \textbf{do}} 
\ \text{       - Discrete governing system (Equation 4) for each cell, using Equations 5-10, in terms of $\Delta\bb{u}$}
\ \text{       - Assemble the discretised  equations for all cells into three scalar linear systems (Equation 17)}
\ \text{       - Solve the three scalar linear systems in terms of cell-centred displacement increments $\Delta\bb{u}$}
\  \text{      - Update the kinematics: $\bb{\nabla}(\bb{\Delta} \bb{u})$, $\bb{F}$, $J$, $\bb{f}$, $j$ } \\
\  \text{      - Update the stress ($\bb{\sigma}$) at the cell-centres using the chosen material law; optionally, solve the}
\  \text{         pressure equation.} \\
\  \text{      - Update the Rhie-Chow stabilisation: $\hat{\mathcal{D}}_{\text{Rhie-Chow}}$ } \\
\ \ \text{       \textbf{end while}} \\
\ \ \text{      - Interpolate cell-centre displacement increments to the vertices}
\ \ \text{      - Move the mesh to the deformed configuration using the vertex displacement increments,}
\ \ \text{         incorporating layer addition/removal (Section 2.4)}
 \caption{Solution Procedure}
\text{\textbf{end for}}
\end{algorithm}


\subsection{Eulerian-Type Layer Addition and Removal Boundaries} \label{sec:euler_BCs}

Steady-state behaviour is typically the primary interest in wire drawing and other continuous forming approaches.
Eulerian approaches are a natural choice but are not commonly employed when elastic phenomena (e.g. spring back, residual stresses) are important.
When simulating wire drawing using a Lagrangian approach, a na\"ive approach is to simulate a workpiece segment that is \emph{long enough} to allow steady-state to be reached.
The disadvantage of this approach is that computational cost is inflated by the portion of the workpiece domain primarily undergoing rigid-body translation, which may be large relative to the region actively undergoing plastic deformations.

To overcome this disadvantage, the current work proposes Eulerian-type layer addition and removal conditions for the workpiece upstream and downstream boundaries.
The approach involves fixing the workpiece (e.g., wire) upstream and downstream mesh boundaries in space during the mesh motion at the end of each time step.
As cells at the upstream boundary become elongated, layers of new cells are added.
Similarly, cells are removed as they become compressed near the downstream patch.
In this way, the length of the workpiece domain remains fixed (like an Eulerian approach), but a traditional Lagrangian method is still used to calculate the deformation.
Nonetheless, the proposed approach's limitation is that the workpiece domain mesh must consist of layers of cells in the streamwise direction.

Figure \ref{fig:layerAddition} schematically outlines the step involved in the layer addition and removal mesh motion scheme:
\begin{enumerate}[label=(\alph*)]
	\item The workpiece (e.g., wire) mesh is constructed such that it is layered in the streamwise direction.
	\item Solution of the discretised governing equations provides the cell centres displacement increments $\Delta \bb{u}$.
	\item The cell-centred displacement increment $\Delta \bb{u}$ are interpolated to the vertices $\Delta \bb{u}_v$.
	\item If the average width (in the streamwise direction) at the upstream boundary of the cell layer $d_{av}$ is greater than a user-prescribed maximum width $d_{max}$, a zero-thickness layer of cells is added.
	\item The displacement increments of the newly added layer of vertices are set to zero.
	%The vertex displacement increments $\Delta \bb{u}_v$ at the upstream and downstream boundaries are set to zero, except for the newly added vertices, which form part of the zero-thickness layer.
	\item The mesh is moved by the vertex displacement increment field $\Delta \bb{u}_v$, where it is noted that the \emph{original} vertices on the upstream and downstream points are allowed to move; this causes the newly added cell layer to \emph{grow} by the displacement increment field. 
	\item If the average width (in the streamwise direction) of the cell layer $d_{av}$ at the downstream boundary is less than a user-prescribed minimum width $d_{min}$, remove the layer of cells at the downstream boundary. Multiple cell layers may need to be iteratively removed depending on the displacement increment magnitude.
\end{enumerate}

\begin{figure}[tbh]
	\centering
	\subfigure[] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/layerAddition/fig1}}
	\subfigure[] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/layerAddition/fig2}}
	\subfigure[] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/layerAddition/fig3}}
	\subfigure[] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/layerAddition/fig4}}
	\subfigure[] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/layerAddition/fig5}}
	\subfigure[] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/layerAddition/fig6}}
	\subfigure[] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/layerAddition/fig7}}
	\subfigure[] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/layerAddition/fig8}}
	\subfigure[] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/layerAddition/fig9}}
	\caption{Layer addition and removal mesh motion algorithm for continuous wire drawing (a). The displacement increments are calculated at the cell centre (b) and are interpolated to the vertices (c). A new layer of cells is added at the upstream boundary if the layer width is greater than $d_{\max}$ (d-g). Layers of cells are removed from the downstream boundary if the later width is less than $d_{\max}$ (h-i).}
	\label{fig:layerAddition}
\end{figure}

Following the layer addition and removal mesh motion algorithm, solution and derived field data at the newly added cell centres are mapped from the field data stored at the upstream boundary.
This mapping approach assumes field data to have a zero gradient in the upstream direction; this assumption is valid if the upstream and downstream are chosen sufficiently far from the \emph{active} deformation zone.

The presented layer addition-removal procedure is agnostic to the mathematical boundary conditions used at the upstream and downstream boundaries.
As is demonstrated in drawing simulations, a velocity (or equivalent displacement increment) is prescribed at the downstream boundary, where the tangential traction is zero, while traction (back tension) is applied to the upstream boundary.
However, other conditions can be used; for example, in rolling simulations, tractions may be applied to both upstream (back tension) and downstream (front tension) boundaries.

\textbf{Note on parallelisation}: The proposed solution algorithm has been implemented in the open-source toolbox OpenFOAM, where multi-CPU-core parallelisation on distributed memory systems is achieved through the domain decomposition approach.
To simplify the implementation of the non-trivial topological mesh changes (addition or removal of cells) in parallel, domain decomposition approaches are limited to decomposing the workpiece into streamwise columns of cells (Figure \ref{fig:layerAdditionParallel}).
In the current approach, modified forms of the METIS \cite{metis} and scotch \cite{scotch} approaches have been used to perform this decomposition.
Nonetheless, there is no limitation on the decomposition of the cells in the die, as demonstrated in Figure \ref{fig:layerAdditionParallel}.
\begin{figure}[tbh]
	\centering
	\includegraphics[width=0.45\textwidth]{./Figures/layerAddition/parallel}
	\caption{Example parallel decomposition of a wire and drawing die, where the wire is decomposed into streamwise \emph{columns}, indicated by the different colours. There is no limitation on the die decomposition.}
	\label{fig:layerAdditionParallel}
\end{figure}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Constitutive Damage Laws} \label{sec:constitutive_laws}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%- maths details of the three damage laws
%- proposed modifications

\subsection{Overview}

As noted by \citet{garrison_ductile_1987}, ductile fracture in metals occurs in three stages: (i) voids are nucleated at material defects, adding to pre-existing voids, if any; (ii) plastic deformations cause these voids to grow; and (iii) when large enough, these voids coalesce to form micro-cracks and macro-cracks.
%Recent reviews of
As noted in the introduction, local approaches for modelling ductile fracture in metal forming can classified into two approaches \citep{cao_models_2017, tekkaya_damage_2020}: continuum damage mechanics models and micro-mechanical models.

In \emph{continuum} damage mechanics, an internal damage variable is used to describe the accumulation of microstructural degradation within a material due to various types of loading.
This degradation is typically reflected in the increased density of internal defects, such as microcracks, dislocations, or voids.
The internal damage variable is continuous, meaning it can take on any value within a given range.
The \emph{micro-mechanical} approach is also continuous in nature and posits the existence of material micro-voids.
The void density is described by a \emph{porosity} variable.
Material degradation is characterised by increased porosity due to void nucleation, growth, and coalescence.
As noted by \citet{besson_continuum_2010}, \citet{cao_models_2017} and \citet{tekkaya_damage_2020}, the canonical frameworks in the continuum damage mechanics and micro-mechanical approaches are the Lemaitre \cite{lemaitre_continuous_1985,lemaitre_engineering_2005} and the Gurson-Tvergaard-Needleman (GTN) \cite{gurson_continuum_1977,tvergaard_analysis_1984} models, respectively.

This section provides an overview of the Lemaitre and GTN models and proposes modifications to the Lemaitre model to extend its applicability to the high hydrostatic pressure regimes characteristic of wire drawing.
For comparison, a recent phase field model damage approach is also considered.

The constitutive damage laws described in this section close the system of governing equations (Equation \ref{eqn:MomentumImplicitExplicit}) described in Section \ref{sec:solDomDiscret} by providing the true stress definition.

%In this chapter, a brief description of the historical development of these models will be provided, and suitable algorithmic implementations of them will be developed and described. More recent developments in the formulations of these models are also described and implemented. 

%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.65\textwidth]{./Figures/damageModels/ductileDamageEvolution.png}
%\caption{Ductile damage evolution \cite{teixeira_ductile_2010}}
%\label{fig:Ductile-damage-evolution}
%\end{center}
%\end{figure}
%
%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.65\textwidth]{./Figures/damageModels/f_ngc.png}
%\caption{Illustration of the nucleation, growth and coalescence of voids \cite{archie_damage_2018}}
%\label{fig:Nucleating Voids}
%\end{center}
%\end{figure}

\subsection{Preliminaries}
Before describing these models in more detail, it is necessary to define the stress triaxiality $\eta$, the Lode angle $\theta$ and related Lode parameters \cite{bai_new_2008, nahshon_modification_2008}.
Extensive literature has noted the importance of stress triaxiality and Lode angle in predicting ductile fracture \cite{besson_continuum_2010, cao_models_2017, tekkaya_damage_2020}.
The triaxiality parameter $\eta$ is given by:
\begin{equation} % note: different pressure convention from Andrew's thesis
    \eta = -\frac{p}{\sigma_{v}}
\end{equation}
where, as noted previously, $p$ is the hydrostatic pressure, and $\sigma_{v} = \sqrt{3 J_2} = \sqrt{\frac{3}{2} \text{dev}(\bb{\sigma}) : \text{dev}(\bb{\sigma}) }$ is the equivalent (von Mises) stress.
$J_2$ is the second invariant of the deviatoric stress tensor.
%The trace operator is indicated by $\text{tr}(\bullet)$,
The deviatoric operator is indicated by $\text{dev}(\bullet)$, and $:$ indicates the double-dot product.

The Lode angle, $0 \leq \theta \leq \frac{\pi}{3}$, can be physically interpreted as the degree of shear dominance in the stress state.
The Lode angle can be rewritten as a function of the normalised third invariant of the deviatoric stress tensor:
\begin{equation}
    \theta=\frac{1}{3} \arccos\left(\xi\right)
\end{equation}

The parameter $0 \leq \xi \leq 1$ is determined as a ratio between the third invariant and the equivalent stress:
\begin{equation}
	\xi = \left(\frac{r}{\sigma_{v}}\right)^3
\end{equation}
where $r$ is given by:
\begin{equation}
	r  = 3 \left(\frac{3}{2}J_3\right)^{1/3} %= 3 \left(\frac{3}{2}\text{det}\left(\bb{s}\right)\right)^{1/3}	
\end{equation}
The third invariant of the deviatoric stress tensor is $J_3 = \text{det}[\text{dev}(\bb{s})]$.
% $\bb{s}
%The Lode angle ranges between $0$ and $\frac{\pi}{3}$.
%The range of $\xi$ is between $-1$ and $1$.
An alternative normalised Lode angle has been proposed by \citet{bai_new_2008} to be
\begin{equation}
	\bar{\theta}=1-\frac{6\theta}{\pi}	
\end{equation}
which ranges between -1 and 1.

The three Lode parameters ($\theta$, $\xi$, and $\bar{\theta}$) are essentially equivalent but are defined to vary between different limits.


\subsection{Isotropic Elastoplasticity}

%\hl{Introduce the Kirchhoff stress tau and dot gamma and spatially rotated plastic stretch and thermodynamic force chi (x) and elastic rotation tensor}

\subsubsection{Model Formulation}

In the current work, the damage models are formulated in terms of isotropic $J_2$ (von Mises) elastoplasticity.
Extension to other forms of elastoplasticity (e.g., kinematic hardening, anisotropic/Hill yielding, distortional hardening) is possible but is outside the scope of this article.
The adopted large strain elastoplasticity formulation is based on the logarithmic (Hencky) strain, as proposed by \citet{eterovic_hyperelastic-based_1990} and described in detail by \citet{koji_inelastic_2010} and \citet{de_souza_neto_computational_2008}.
This approach allows an additive split of the elastic and plastic strain tensors, conveniently leading to a return mapping scheme that is similar in form to those used in small-strain deformation models.
%To this author's eye, this is a formulation for elastoplasticity that is more lucid and relatively simple to implement in codes in comparison to the approach of \citet{simo_computational_1998}, for example.
%With an eye for future works, there also exists a well-established approach to extending large-strain elastoplasticity using the logarithmic strain to incorporate anisotropic and kinematic plasticity \cite{papadopoulos_formulation_2001,mettler_numerical_2012}.
In contrast, previous large-strain elastoplastic models \citep{cardiff_lagrangian_2017, clancy_improving_2019} implemented in the OpenFOAM software have adopted the approaches of \citet{caminero_modeling_2011} and \citet{simo_computational_1998}.
% and  this work represents, to the author's knowledge, the first time that the formulation by \citet{eterovic_hyperelastic-based_1990} for elastoplasticity has been implemented in OpenFOAM.


%First a dissipation potential $F$ is defined:
%\begin{equation}
%    F=F_p
%\end{equation}
%Where $F_{p}$ is the dissipation associated with the plasticity. Given the assumption of plastic isotropy and applying the generalized normality rule:
%\begin{equation}
%    \bar{\bb{d}}^p=\dot{\gamma}\frac{\partial F}{\partial\boldsymbol{\tau}}
%\end{equation}
%And
%\begin{equation}
%    \dot{\alpha}=-\dot{\gamma}\frac{\partial F}{\partial\chi}
%\end{equation}
%Equation 3.30 can be defined in terms of the multiplicative plastic deformation gradient $\bb{F}^{p}$ by combining it with equation \ref{eqn:rotatedPlasticStretch} to give
%\begin{equation}
%    \dot{\bb{F}^p\bb{F}^{p-1}}=\dot{\gamma}\bb{R}^{eT}\frac{\partial F}{\partial\boldsymbol{\tau}}\bb{R}^e
%\end{equation}

The employed isotropic $J_2$ elastoplastic constitutive law is defined in terms of the yield criterion
\begin{eqnarray} \label{eq:yieldFunc}
	%    F_p &=& \tau_{eq} - \sigma_y\left(\alpha\right) \\
	\Phi &=& \sigma_v \; - \; \sigma_y\left(\bar{\varepsilon}_p \right)
\end{eqnarray}
%\end{equation}
%Where $\tau_{eq}$ is the von Mises equivalent stress:
%\begin{equation}
%    \tau_{eq} = \sqrt{\frac{3}{2}\boldsymbol{\tau}_d:\boldsymbol{\tau}_d}
%\end{equation}
%Multivariable calculus operations are used to obtain the following constitutive equations
%\begin{equation}
and flow rule
\begin{eqnarray} \label{eq:flowRule}
    %\frac{\partial}{\partial t} \left(\bb{F}_p \bb{F}_p^{-1} \right)
    \dot{\bb{F}}_p  \bb{F}_p^{-1}
    &=&
	%    \dot{\gamma}\bb{R}^{eT}\left(\frac{3}{2}\frac{\boldsymbol{\tau}_d}{\tau_{eq}}\right)\bb{R}^e
    \dot{\bar{\varepsilon}}_p \; \bb{R}_e^T 
    \left[
    \frac{3}{2} \frac{\text{dev}\left(\boldsymbol{\sigma} \right)} {\sigma_{v}}
    \right]
    \bb{R}_e
\end{eqnarray}
where the yield stress $\sigma_y$ is a function of the hardening variable $\bar{\varepsilon}_p$, which coincides with the equivalent plastic strain $\bar{\varepsilon}_p$.
The deformation gradient is decomposed into elastic and plastic components $\bb{F} = \bb{F}_e  \bb{F}_p$ and polar decomposition of the elastic deformation gradient gives the elastic rotation $\bb{R}_e$ and elastic stretch $\bb{U}_e$ tensors: $\bb{F}_e = \bb{R}_e \bb{U}_p$.

%\begin{equation}
%\dot{\alpha}=\dot{\gamma}
%\end{equation}
%It's worth noting that the hardening variable $a$ used in this model is the equivalent plastic strain which can be given by $\bar{\varepsilon}^p$.
The model is closed with the Kuhn-Tucker conditions
\begin{eqnarray}
	\Phi \geq 0, \quad\quad
	\dot{\bar{\varepsilon}}_p \geq 0, \quad\quad
	\dot{\bar{\varepsilon}}_p \Phi = 0
\end{eqnarray}
and the consistency condition
\begin{eqnarray}
	\dot{\bar{\varepsilon}}_p \dot{\Phi} &=& 0
\end{eqnarray}


\subsubsection{Computational procedure}
%For a displacement-based finite volume procedure, the discretised equilibrium equations are solved for each time step using an iterative method to achieve convergence. The displacement field is solved at each iteration using the stress field calculated from the elasto-plastic return mapping scheme. This displacement field is then used to find a new value for the stress from the elasto-plastic return mapping scheme. This iterative procedure continues until convergence is achieved.

For each cell at every outer (Picard) iteration, the stress $\bb{\sigma}^{[m+1]}$ and history variables $\left(\alpha^{[m+1]}, \bb{F}_p^{[m+1]}\right)$ at time step $t^{[m+1]}$ must be calculated in terms of the current displacement increment gradient $[\bb{\nabla} (\Delta \bb{u})]^{[m+1]}$ and old-time history variables $\left(\alpha^{[m]}, \bb{F}_p^{[m]}\right)$.

%the incremental displacement field $\Delta \bb{u}$ for the current time step $t^{[m+1]}$, at the current (outer) iteration, is provided. The values of the following variables are given from the previous time step:
%\begin{equation}
%    \left\{\bb{F}_n^p,\ \alpha_n\right\}
%\end{equation}
%The goal is then to have an algorithm to obtain the following variables at time $t^{[m+1]}$
%\begin{equation}
%    \left\{\bb{F}^{[m+1]}^p,\ \alpha^{[m+1]},\boldsymbol{\sigma}^{[m+1]}\right\}
%\end{equation}
%In order to obtain these values, the algorithm must satisfy the set of constitutive equations:
%\begin{equation}
%\left\{\begin{array}{c}
%    \dot{\bb{F}^p\bb{F}^{p-1}}=\dot{\gamma}\bb{R}^{eT}\left(\frac{3}{2}\frac{\boldsymbol{\tau}_d}{\tau_{eq}}\right)\bb{R}^e \\
%\dot{\alpha}=\dot{\gamma}
%\end{array}\right.
%\end{equation}

%To begin, equation 3.35 is integrated using the one-step implicit integration operator corresponding to the Euler backward method \cite{andrade_ductile_2011} to get:
%\begin{equation}
%    \bb{F}^{[m+1]}^p=exp\left[\frac{3}{2}\Delta\gamma\bb{R}^{[m+1]}^{e^T}\frac{{\bb{\tau}}_{d^{[m+1]}}}{\tau^{eq}^{[m+1]}}
%    \bb{R}^{[m+1]}^e\right]\bb{F}_n^p
%\end{equation}
%Due to plastic isotropy, this equation can be written as:
%\begin{equation}
%    \bb{F}^{[m+1]}^p=\bb{R}^{[m+1]}^{e^T}exp\left[\frac{3}{2}\Delta\gamma\frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}\right]\bb{R}^{[m+1]}^e\bb{F}_n^p
%\end{equation}
%This represents the update of the plastic deformation gradient. This can in turn be combined with the fact that $\bb{F}=\bb{F}^{e}\bb{F}^{p}$ to give the elastic deformation tensor:
%\begin{equation}
%    \bb{F}^{[m+1]}^e={\bb{F}^{[m+1]}^{e\ trial}\bb{R}}^{[m+1]}^{e^T}exp\left[-\frac{3}{2}\Delta\gamma\frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}\right]\bb{R}^{[m+1]}^e
%\end{equation}
%where $\bb{F}^{[m+1]}^{e\ trial}$ is given by:
%\begin{equation}
%\bb{F}^{[m+1]}^{e\ trial}=\bb{f}^{[m+1]}\bb{F}^{[m+1]}^{e}
%\end{equation}
%$\bb{f}^{[m+1]}$ is the relative deformation gradient (equation 2.45). 
%Using the fact that $\bb{F}^e=\bb{V}^{e}\bb{R}^{e}$
%\begin{equation}
%    \bb{V}^{[m+1]}^e\bb{R}^{[m+1]}^e={\bb{F}^{[m+1]}^{e\ trial}\bb{R}}^{[m+1]}^{e^T}exp\left[-\frac{3}{2}\Delta\gamma\frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}\right]\bb{R}^{[m+1]}^e
%\end{equation}
%Multiplying both sides by $\bb{R}^{e^T}^{[m+1]}$
%\begin{equation}
%    \bb{V}^{[m+1]}^e={\bb{F}^{[m+1]}^{e\ trial}\bb{R}}^{[m+1]}^{e^T}exp\left[-\frac{3}{2}\Delta\gamma\frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}\right]
%\end{equation}
%Multiplying by the inversion of the exponential term:
%\begin{equation}
%    \bb{V}^{[m+1]}^{e}exp\left[\frac{3}{2}\Delta\gamma\frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}\right]={\bb{F}^{[m+1]}^{e\ trial}\bb{R}}^{[m+1]}^{e^T}
%\end{equation}
%Taking the square of both sides:
%\begin{equation}
%    \bb{V}^{[m+1]}^{e}\ exp\left[3\Delta\gamma\frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}\right]\bb{V}^{[m+1]}^{e}={\bb{F}^{[m+1]}^{e\ trial}\bb{R}}^{[m+1]}^{e^T}{\bb{F}^{[m+1]}^{{e\ trial}^T}\bb{R}}^{[m+1]}^{e}
%\end{equation}
%
%Isolating the RHS of this equation and using the fact that $\bb{R}^{e^T}^{[m+1]}\bb{R}^{e}^{[m+1]}=\textbf{I}$:
%\begin{equation}
%    {\bb{F}^{[m+1]}^{e\ trial}\bb{R}}^{[m+1]}^{e^T}{\bb{F}_{\bb{n}+1}^{{e\ trial}^T}\bb{R}}^{[m+1]}^e=\bb{F}^{[m+1]}^{e\ trial}\bb{F}^{[m+1]}^{{e\ trial}^T}=\left(\bb{V}^{[m+1]}^{e\ trial}\right)^\bb{2}
%\end{equation}
%
%Subbing this into equation 3.47 we get:
%\begin{equation}
%    \bb{V}^{[m+1]}^e exp\left[3\Delta\gamma\frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}\right]\bb{V}^{[m+1]}^e=\left(\bb{V}^{[m+1]}^{e\ trial}\right)^\bb{2}
%\end{equation}
%
%By rearranging and taking the square root of both sides, the following can be obtained:
%\begin{equation}
%    \bb{V}^{[m+1]}^e=\bb{V}^{[m+1]}^{e\ trial}exp\left[-\frac{3}{2}\Delta\gamma\frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}\right]
%\end{equation}
%
%Taking the natural log of both sides:
%\begin{equation}
%    ln\left(\bb{V}^{[m+1]}^{e}\right)=ln\left(\bb{V}^{[m+1]}^{e\ trial}exp\left[-\frac{3}{2}\Delta\gamma\frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}\right]\right)
%\end{equation}
%
%Using the fact that $ln\textbf{V}=\boldsymbol{\varepsilon^e}$ (equation 3.8), the additive split of the elastic and plastic strain tensors is derived:
%\begin{equation}
%    \boldsymbol{\varepsilon}^{[m+1]}^{e}=\boldsymbol{\varepsilon}^{[m+1]}^{e\ trial}-\frac{3}{2}\Delta\gamma\frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}
%\end{equation}
%The integration of the other constitutive equations using the backwards Euler scheme is simply given by:
%\begin{eqnarray}
%    \alpha^{[m+1]}-\alpha_n=\Delta\gamma  \notag \\
%    \alpha^{[m+1]}=\alpha_n+\Delta\gamma  
%\end{eqnarray}
%The final system of equations to be solved when the material is on the plastic domain is given by:
%\begin{equation}
%	\left\{\begin{array}{c}
%	\label{eqn:dicritisedFinalEquationsPLasticity}
%	F_p = \tau^{eq}^{[m+1]} - \sigma_{y} \left(\alpha^{[m+1]}\right)=0 \\
%	\boldsymbol{\varepsilon}^{[m+1]}^e = \boldsymbol{\varepsilon}^{[m+1]}^{e\ trial}
%		- \frac{3}{2} \Delta \gamma \frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}} \\
%		\alpha^{[m+1]}=\alpha_n+\Delta \gamma
%	\end{array}\right.
%\end{equation}
%The above system of equations can be resolved by solving for the plastic increment using an implicit algorithm. It can be shown that the equations in \ref{eqn:dicritisedFinalEquationsPLasticity} can be satisfied by solving the yield equation for the plastic increment $\Delta \gamma$. To begin, the von Mises yield criterion is restated:
%\begin{equation}
%    \tau^{eq}^{[m+1]}-\sigma_y\left(\alpha^{[m+1]}\right)=0
%\end{equation}
%
%Recalling the definition of the von Mises stress (equation 3.34), the equivalent stress can be expressed in terms of the elastic strain and combined with equation 3.53 to give:
%\begin{eqnarray}
%\tau^{eq}^{[m+1]}&=&\sqrt{\frac{3}{2}}\left\|2 \mu \operatorname{dev}\left(\boldsymbol{\varepsilon}^{[m+1]}^e\right)\right\| \\ \notag
%&=&
%\sqrt{\frac{3}{2}}\left\|2 \mu \operatorname{dev}\left(\boldsymbol{\varepsilon}^{[m+1]}^{e \text { trial }}-\frac{3}{2}\Delta \gamma\frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}\right)\right\|
%\end{eqnarray}
%
%Given that:
%\begin{equation}
%\left\|2 \mu \operatorname{dev}\left(\frac{3}{2} \Delta \gamma \frac{{\boldsymbol{\tau}_d}^{[m+1]}}{\tau^{eq}^{[m+1]}}\right)\right\|=3 \mu \Delta \gamma
%\end{equation}
%The von Mises equivalent stress can be expressed as:
%\begin{equation}
%\tau^{eq}^{[m+1]}=\sqrt{\frac{3}{2}}\left\|2 \mu \operatorname{dev}\left(\boldsymbol{\varepsilon}^{[m+1]}^{e \text { trial }}\right)\right\|-3 \mu \Delta \gamma
%\end{equation}
%The following relation for the equivalent stress can therefore be obtained:
%\begin{equation}
%	\tau^{eq}^{[m+1]}=\tau^{eq}_{{n+1}^{\text{trial}}} - 3 \mu \Delta \gamma
%\end{equation}
%Combining equation 3.60 with 3.56, the yield function can be given in terms of the plastic increment:
%\begin{equation}
%\tau^{eq}_{{n+1}^{\text {trial }}}-3 \mu \Delta \gamma-\sigma_y\left(\alpha_n+\Delta \gamma\right)=0
%\end{equation}
%This is solved implicitly using the Newton–Raphson method for $\Delta \gamma$ , the stress tensor and the plastic strain tensor are then updated based on this value.

The adopted stress calculation algorithm \citep{de_souza_neto_computational_2008} is summarised in Appendix \ref{app:stressCalcAlg}. %Algorithm \ref{alg:stressAlg}.





%Simo and Hughes approach vs Bathe vs Michael's approach.


%\subsection{Historical development}
%As previously mentioned, at the micro-scale, damage can be viewed as a discontinuous phenomenon, consisting of the decohesion of atomic bonds and the magnification of micro-voids by plasticity. \citet{kachanov_time_1958} proposed a continuous internal variable to characterize the density of these internal defects leading to a loss of the load-carrying capabilities of the material. \citet{rabotnov_paper_1963} later proposed that this variable be characterised by the reduction in the cross-sectional area of the material due to the development of inclusions and cavities.
%
%In order to illustrate this concept, a macroscale volume (or representative volume element) is isolated from a damaged body in Figure \ref{fig:RVEDamage}. This volume is large enough such that the randomly distributed microvoids can be characterized by a continuous damage variable.
%
%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.65\textwidth]{./Figures/damageModels/damageVolume.png}
%\caption{Representaive volume element isolated from a damaged body \cite{voyiadjis_damage_2005}}
%\label{fig:RVEDamage}
%\end{center}
%\end{figure}
%
%For the representative volume element (RVE), $A_D$ is equal to the area occupied by defects, A is equal to the remaining area of the surface and $A_o$ is the original area of the surface, prior to the development of micro voids and micro-cracks. The damage variable is then given by:
%\begin{equation}
%	D=\frac{A_o\ -\ A}{A_o}=\frac{A_d}{A_o}	
%\end{equation}

% When no damage has taken place, the damage variable is, therefore, equal to 0 (virgin material), whereas when the material is equal to 1 this corresponds to the fully damaged material. From a physical point of view, the variable $D$ is the corrected area of cracks and cavities per unit surface cut by a plane perpendicular to $\bb{n}$. 
%From this definition of damage follows the concept of the effective stress. Let us consider a uniaxial case where a force $F$ is applied to the RVE. The stress is given by:
%\begin{equation}
%	\sigma=\frac{F}{A_o}	
%\end{equation}
%
%After the development of damage, however, the surface area of the macroscale volume which the force $F$ acts upon is reduced. The effective area is given in terms of the original area and the damage variable is as follows:
%\begin{equation}
%	\frac{A_o\ -\ A}{A_o}=D	
%\end{equation}
%\begin{equation}
%	A_o\ -\ A=DA_o	
%\end{equation}
%\begin{equation}
%	\frac{A_o\ -\ A}{A_o}=D	
%\end{equation}
%\begin{equation}
%	A=\left(1-D\right)A_o	
%\end{equation}
% The effective stress is then determined by combining this relation with the equation for the stress (equation 4.7):
% \begin{equation}
%	\bar{\sigma}\ =\frac{F}{{\left(1-D\right)A}_o}=\frac{\sigma}{\left(1-D\right)}	
%\end{equation}
%Based on these macroscopic considerations, Lemaitre \cite{lemaitre_continuous_1985} developed a thermodynamically consistent model.

%\subsection{Thermodynamic framework}

%
%The Lemaitre damage model described herein is coupled with the isotropic plasticity model laid out in chapter 3. In the Lemaitre model, a free energy potential $\psi$ is postulated from which the state laws are derived. The free energy is expressed as a function of the elastic strain $\boldsymbol{\varepsilon}^e$, the hardening variable $a$ and the damage variable D in the form:
% \begin{equation}
%	\psi=\psi\left(\boldsymbol{\varepsilon}^e,\alpha,D\right)
%\end{equation}
%The free energy potential can be decomposed into its elastic-damage and plastic contributions:
% \begin{equation}
%	\psi\left(\boldsymbol{\varepsilon}^e,\alpha,D\right)=\psi^{ed}\left(\boldsymbol{\varepsilon}^e,D\right)+\psi^p\left(\alpha\right)
%\end{equation}
%Where $\psi^{ed}$ and $\psi^p$ are the elastic-damage and plastic energy contributions respectively. The elastic-damage potential is assumed to be:
% \begin{equation}
%	\bar{\rho}\psi^{ed}=\frac{1}{2}\boldsymbol{\varepsilon}^e:\bb{D}^{e}\left(1-D\right):\boldsymbol{\varepsilon}^e	
%\end{equation}
%
%The Kirchhoff stress tensor is obtained by finding the derivative with respect to the elastic strain (section 3.2.1):
% \begin{equation}
%	\boldsymbol{\tau}=\bar{\rho}\frac{\partial\psi^{ed}}{\partial\boldsymbol{\varepsilon}^e}=\bb{D}^{e}\left(1-D\right):\boldsymbol{\varepsilon}^e	
%	\end{equation}
%
%The energy release rate Y, which gives the energy dissipated due to the phenomenon of damage, is given by:
% \begin{equation}
%	Y=\bar{\rho}\frac{\partial\psi^{ed}}{\partial D}=-\frac{1}{2}\boldsymbol{\varepsilon}^e:\bb{D}^e:\boldsymbol{\varepsilon}^e
%\end{equation}
%This can equivalently be written as:
% \begin{equation}
%	Y=-\frac{1}{2}\bar{\boldsymbol{\tau}}:{\bb{D}^e}^{-1}:\bar{\boldsymbol{\tau}}
%\end{equation}
%With some algebraic manipulation \cite{lemaitre_engineering_2005}:
% \begin{equation}
% \label{eqn:classicY}
%	Y=-\frac{{\bar{\tau}_{eq}}^2}{2E}\left(\frac{2}{3}\left(1+v\right)+3\left(1-2v\right)\left(\frac{\tau_h}{\tau_{eq}}\right)^2\right)	
%\end{equation}
%where $E$ is the Young's modulus and $v$ is Poisson's ratio. The triaxiality dependence of the Lemaitre mode is provided by the term $\frac{\tau_h}{\tau_{eq}}$, which is the definition of stress triaxiality $\eta$. The state potential associated with the isotropic hardening variable is given by: 
% \begin{equation}
%	\chi=\rho\frac{\partial\psi^p}{\partial \alpha}
%	\end{equation}
%
%The hardening variable $\alpha$ is commonly chosen as the equivalent plastic strain denoted by ${\bar{\varepsilon}}^p$. 
%The Clausius-Duhem inequality (equation 3.28) is rewritten to incorporate the damage $D$ and its associated thermodynamic force $Y$ to give:
%\begin{equation}
%\boldsymbol{\tau}:\bar{\bb{d}}^p-\chi\dot{\alpha}-Y\dot{D}\geq0
%\end{equation}

%%%%%%%%%%%%%%%%%%%
\subsection{Lemaitre Damage Model}
%%%%%%%%%%%%%%%%%%%

\subsubsection{Model Formulation}

The Lemaitre model describes damage using a scalar field variable $D$.
When no damage has occurred, the damage variable $D$ equals 0 (virgin material), whereas when the material is fully damaged, the damage variable equals 1.
From a physical point of view, $D$ can be interpreted as the area of cracks and cavities per unit surface cut by an arbitrary plane.
% perpendicular to $\bb{n}$. 

%The Lemaitre model is formulated by assuming a dissipation potential $F$:
% \begin{equation}
%	F = F_p + F_d	
%\end{equation}
%where $F_p$ and $F_d$ are the dissipation potentials associated with plasticity and damage, respectively. The plastic potential is given by the $J_2$ (von Mises) yield criterion:
% \begin{equation}
%	F_p = \frac{\sigma_{v}}{1 - D} \; - \; \sigma_y\left(\alpha\right)	
%\end{equation}
%The yield stress $\sigma_y$ is a function of the hardening variable $\alpha$, taken here to represent the equivalent plastic strain.
%
%The damage dissipation potential is given by \citet{lemaitre_continuous_1985}:
% \begin{equation}
%	F_d = \frac{S_0}{\left(b + 1\right) \left(1 - D\right)}\left(\frac{-Y}{S_0}\right)^{b+1}
%\end{equation}
%where $S_0$ and $b$ are material parameters governing the onset and rate of damage.

%Plastic isotropy is assumed and, in order to ensure that dissipation is always
%positive, the Kuhn-Tucker conditions must always hold at every material point:
%\begin{equation}
%\left\{\begin{array}{c}
%\dot{\gamma}=\geq 0 \\
%F\geq 0 \\
%\dot{\gamma}F=0
%\end{array}\right.
%\end{equation}

The Lemaitre model augments the elastoplasticity constitutive law (Equations \ref{eq:yieldFunc} and \ref{eq:flowRule}) with the inclusion of an evolution law for $D$.
In addition, the reciprocal of $(1 - D)$ is introduced to the yield function and flow rules:
% can then be given in terms of the spatially rotated plastic stretch $\bar{\bb{d}}_p$ (or plastic deformation gradient rate $\dot{\bb{F}_p}$), the hardening variable rate $\dot{\alpha}$, and damage variable rate $\dot{D}$:
 \begin{eqnarray} \label{eq:lemaitre_dp}
	 \Phi &=& \frac{\sigma_v}{1 - D} \; - \; \sigma_y\left(\bar{\varepsilon}_p \right) \\
    \dot{\bb{F}}_p \bb{F}_p^{-1}
    &=&
    \frac{\dot{\bar{\varepsilon}}_p}{1 - D} \; \bb{R}_e^T 
    \left[
    \frac{3}{2} \frac{\text{dev}\left(\boldsymbol{\sigma} \right)} {\sigma_{v}}
    \right]
     \bb{R}_e \\
    \dot{D} &=&
    %-\dot{\gamma}\frac{\partial F}{\partial Y}
    \frac{\dot{\bar{\varepsilon}}_p}{1 - D}\left(\frac{-Y}{S_0}\right)^b \label{eq:lem_damage}
\end{eqnarray}
% \begin{equation}
%	\dot{\alpha} = -\dot{\gamma}\frac{\partial F}{\partial\chi}=\dot{\gamma}
%\end{equation}
% \begin{equation}
%	\dot{D} = -\dot{\gamma}\frac{\partial F}{\partial Y}=\frac{\dot{\gamma}}{\left(1 - D\right)}\left[\frac{-Y}{S_0}\right]^b
%\end{equation}
%We can equivalently write the rate of plastic strain (Equation \ref{eq:lemaitre_dp}) in terms of the multiplicative plastic deformation gradient $\bb{F}_p$ as
%\begin{equation}
%	\dot{\bb{F}_p} \bb{F}_p^{-1} =
%	\frac{3}{2} \frac{\dot{\gamma}}{1 - D} \bb{R}_e^{T} \frac{\text{dev}(\boldsymbol{\tau})}{\sigma_{v}} \bb{R}_e
%\end{equation}
where $S_0$ (dimensions of stress) and $b$ (dimensionless) are material parameters.
The energy release rate $Y$, which gives the energy dissipated due to the phenomenon of damage, is given by \cite{lemaitre_engineering_2005}
% \begin{equation}
%	Y
%	%= \bar{\rho}\frac{\partial\psi^{ed}}{\partial D}
%	= -\frac{1}{2} \boldsymbol{\varepsilon}_e : \bb{D}_e : \boldsymbol{\varepsilon}_e
%\end{equation}
%which can equivalently be written as
% \begin{equation}
%	Y=-\frac{1}{2}\bar{\boldsymbol{\tau}}:{\bb{D}^e}^{-1}:\bar{\boldsymbol{\tau}}
%\end{equation}
%With some algebraic manipulation \cite{lemaitre_engineering_2005}:
\begin{equation} \label{eqn:classicY}
	Y
	=
%	-\frac{{\bar{\tau}_{eq}}^2}{2E}
	-\frac{\sigma_v^2}{2E}
	\left[
%	\frac{2}{3} (1 + v) + 3 (1 - 2v) \left( \frac{p}{\sigma_v} \right)^2
	\frac{2}{3} (1 + \nu) + 3 (1 - 2\nu) \eta^2
	\right]
\end{equation}
where $E$ is Young's modulus and $\nu$ is Poisson's ratio, and the dependence on $Y$ on triaxiality $\eta$ is explicitly clear.
%The triaxiality dependence of the Lemaitre mode is provided by the term $\frac{\tau_h}{\tau_{eq}}$, which is the definition of stress triaxiality $\eta$.
%The state potential associated with the isotropic hardening variable is given by: 
% \begin{equation}
%	\chi=\rho\frac{\partial\psi^p}{\partial \alpha}
%\end{equation}


\paragraph{Triaxiality and Lode Angle Dependence}

The classic Lemaitre model does not distinguish between positive and negative triaxiality ($\eta$ is squared in Equation \ref{eqn:classicY}); consequently, it can overpredict damage in wire drawing processes where triaxiality can be highly negative (high negative pressures).
%it tends to predict fracture too early at low triaxialities and too late at high triaxialities. 
%Physically, highly negative triaxiality (highly positive hydrostatic pressure) is known to suppress damage formation.
One remedy is to employ a triaxiality \emph{cut-off} \cite{bouchard_enhanced_2011}, which disallows damage evolution for highly negative triaxiality values:
\begin{equation} \label{eq:triaxCutoff} % note: flip sign from Andrew's thesis, as Andrew assume p = hyd(sigma), whereas we assume p = -hyd(sigma)
	\dot{D} =
	\begin{cases}
		0 & \text { if } \eta \leq -\frac{1}{3}  \\
		\frac{\dot{\bar{\varepsilon}}_p}{1 - D}\left(\frac{-Y}{S_0}\right)^b 
		& \text { if } \eta>-\frac{1}{3}
	\end{cases}
\end{equation}



 %at which point the cell is assumed to be fully damaged.

% The damage is not set to $1$ to allow for some residual stresses in this cell to aid convergence.
%\begin{equation}
%\label{DamageUpdateEquation}
%D^{i+1}^{[m+1]}= \begin{cases} D_n+\frac{\Delta\gamma}{\left(1-D^{i}^{[m+1]}\right)}\left[\frac{-Y^{[m+1]}}{r}\right]^s & \text { if } D^{i}^{[m+1]}<D_c \\ 0.99 & \text { if } D^{i}^{[m+1]} \geq D_c \end{cases}
%\end{equation}


%Various alternative formulations of the Lemaitre damage model have been proposed in the literature.
%Typically, these models entail an alteration of the damage dissipation potential \cite{cao_lode-dependent_2014,chandrakanth_isotropic_1995,wei_hua_tai_new_1986,bouchard_enhanced_2011,bonora_nonlinear_1997,malcher_improved_2014,ferreira_improved_2022,castro_calibration_2018,lian_modified_2014} and therefore, following the procedure described in section 4.2.3, an alternative damage evolution equation is derived. 

Rather than use a triaxiality cut-off, Malcher and co-workers \citep{malcher_improved_2014, ferreira_improved_2022, castro_calibration_2018} proposed that the parameter $S_0$ be a function of triaxiality $\eta$ as well as Lode angle $\xi$.
%Of particular interest in this work is the class of models based on the formulation developed by \citet{malcher_improved_2014}.
This approach has shown an ability to accurately predict fracture for a range of loading conditions at both low and high triaxiality values and for various shear stress states.
The Malcher et al. form of damage evolution is achieved by making $S_0$ in Equation \ref{eq:lem_damage} a function of $\eta$ and $\xi$:
\begin{equation}
S(\eta,\xi)=\frac{S_{0.33}}{3|\eta|+\frac{S_{0.33}}{S_{0.0}}\left(1-\xi^2\right)}
\end{equation}
where $S_{0.33}$ and $S_{0.0}$ are material parameters determined based on pure tensile loading ($S_{0.33}$) and pure shear loading ($S_{0.0}$).

%As noted in \citet{malcher_improved_2014}, 
%To remedy this, an alternative damage dissipation potential was proposed: 
%\begin{equation}
%	F_{D}=\frac{S(\eta,\xi)}{\left(1-D\right)\left(b+1\right)}\left[\frac{-Y}{S(\eta,\xi)}\right]^{b+1}
%\end{equation}
% Following the procedure described in section 4.2.3 of this thesis, the damage evolution equation is then given as:
%
% \begin{equation}
%	\dot{D}=\frac{\dot{\gamma}}{\left(1-D\right)}\left[\frac{-Y}{S(\eta,\xi)}\right]^b
%\end{equation}
%The Lemaitre damage denominator is modified to become a function of the triaxiality $\eta$ and in some cases the normalised third invariant $\xi$. The damage denominator is given by \citet{malcher_improved_2014} as:

Despite its success, this formulation's weakness is that it does not distinguish between positive and negative triaxiality values, which is critical for wire drawing.
%In Chapter 7, a novel Lemaitre damage model is proposed in this work that is conceptually similar to the above formulation.
To overcome this limitation, a function for $S(\eta,\xi)$ is proposed here, inspired by the \citet{ko_prediction_2007} uncoupled damage law.
The \citet{ko_prediction_2007} criterion has shown an ability to predict fracture in both wire drawing processes \cite{roh_process_2021} and in the hub-hole expanding process \cite{ko_prediction_2007}.
For wire drawing, $\xi\approx1.0$ at the wire axis, where fracture typically originates \cite{roh_process_2021}.
For this reason, the proposed function does not incorporate a dependency on $\xi$, and the final expression for $S$ proposed here takes the form
\begin{equation} \label{eqn:proposedLemaitre}
	S(\eta) = \frac{2S_0}{1.0+3\eta}
\end{equation}

%For the wire drawing cases to be looked at in this chapter $\xi\approx1.0$ at the centre of the wire (Appendix F.1) where fracture originates \cite{roh_process_2021}. For this reason, the proposed function does not incorporate a dependency on $\xi$. The damage evolution law can be rewritten as:
%\begin{equation}
%	\dot{D}=\frac{\dot{\gamma}}{1-D}\left[\frac{-Y}{2S_0}\left(1.0+3\eta\right)\right]^b
% \end{equation}



\paragraph{Crack Closure Effects}

An additional limitation of the classic Lemaitre damage model is that it does not distinguish between tensile and compressive stress states, whereas it is known from experiments that tensile stresses are considerably more conducive to crack growth than compressive stresses \cite{bao_cut-off_2005}.
To overcome this shortcoming, some authors assume no crack growth in compressive stress states \cite{chu_void_1980}; however, this does not account for the partial closure of micro-defects under compressive stress states.
This effect causes a greater material area to bear the compressive load.
As a result, the material may exhibit a partial or complete recovery of its stiffness, depending on the specific conditions \cite{teixeira_ductile_2010}.
This approach also does not account for the fact that some crack growth can occur in compressive states \cite{basic_finite_2005}.

Consequently, an \emph{enhanced} Lemaitre model with crack closure effects has been proposed \cite{pires_issues_2005,teixeira_ductile_2010}.
% can be used to account for damage development more accurately.
In this approach, the energy release rate $Y$ (Equation \ref{eqn:classicY}) is rewritten to account for the differing contributions of tensile and compressive stresses:
\begin{eqnarray}
	Y &=&
	\frac{-1}{2E\left(1-D\right)}
	\left[(1 + \nu) \bb{\sigma}^+ : \bb{\sigma}^+ - \nu\ \langle \text{tr}(\boldsymbol{\sigma})\rangle^2\right] \notag \\
	&&-\frac{h}{2E\left(1-hD\right)}
	\left[(1 + \nu)\bb{\sigma}^- : \bb{\sigma}^- -\nu \langle -\text{tr}(\boldsymbol{\sigma})\rangle^2\right]
\end{eqnarray}
where Macaulay brackets are indicated by $\langle \bullet \rangle$.
%Under compressive stress, micro-cracks will partially or fully close, leading to an increase in the load-carrying area.
The parameter $0\le h\le1$ accounts for the crack closure phenomenon; here, we take $h = 0.2$ as is common for steels \cite{desmorat_modeling_2008,lemaitre_course_1996,bouchard_enhanced_2011}). 
%In this model, an effective stress for compressive stress states is introduced. It differs from that in equation 4.12 through the introduction of the material parameter $h$ (and given here in terms of the Kirchhoff stress):
%\begin{equation}
%	\bar{\boldsymbol{\tau}}\ =\frac{\boldsymbol{\tau}}{\left(1-hD\right)}	
%\end{equation}
%An eigendecomposition is performed to split the stress tensor into its positive and negative components
%\begin{equation}
%	\boldsymbol{\sigma} \;=\; \boldsymbol{\sigma}^+ \;+\; \boldsymbol{\sigma}^-
%\end{equation}
The positive and negative stress components are defined as
\begin{eqnarray}
	\boldsymbol{\sigma}^+&=&\sum_{i=1}^{3} \langle{\sigma}_i \rangle\bb{e}_i\otimes\bb{e}_i	\\
	\boldsymbol{\sigma}^-&=&\sum_{i=1}^{3}\langle{-{\sigma}}_i\rangle\bb{e}_i\otimes\bb{e}_i
\end{eqnarray}
where ${\sigma}_i$ are the principal stresses, $\{\bb{e}_1,\bb{e}_2,\bb{e}_3\}$ are the orthonormal basis vectors, and $\boldsymbol{\sigma} = \boldsymbol{\sigma}^+ + \, \boldsymbol{\sigma}^-$.
%$\otimes$ is the outer product and $<>$ is a Macauley bracket.
%The effective stress tensor can then be given by:
%\begin{equation}
%	\bar{\boldsymbol{\tau}}\ =\frac{\boldsymbol{\tau}_+}{\left(1-D\right)}+\frac{\boldsymbol{\tau}_-}{\left(1-hD\right)}	
%\end{equation}

%For the sake of numerical efficiency, 
A simplified form of the crack-closure model \cite{teixeira_ductile_2010} is employed in this work, whereby this definition of decomposed stress is only used in the damage evolution calculation. 






\paragraph{Non-Local Damage}

%It is worth noting the benefit of the developed implicit-explicit algorithm when looking at this class of models. The fact that the developed algorithm does not require the solution of the damage implicitly means that incorporating novel damage evolution equations into the existing code is relatively simple, without the need to calculate derivatives that can become quite complex when incorporating shear effects, in particular, \cite{malcher_improved_2014}.

One general limitation of damage models is that due to the strain softening behaviour, predictions may suffer from mesh size and orientation dependency in localised strain zones \cite{peerlings_critical_2001, peerlings_localisation_2002, geers_strongly_2003}.
%The governing differential equations can lead to multiple possible solutions due to the nonlinearity and softening response.
%The finite element or volume solution process may converge to one of these possible solutions depending on factors like the mesh, boundary conditions, or solver parameters. This brings the uniqueness of the solution into question.
To rectify this, an implicit \emph{non-local} damage variable $\bar{D}$ is introduced as in \citet{peerlings_critical_2001, peerlings_localisation_2002} and \citet{geers_strongly_2003}.
This is related to the local damage variable $D$ through the implicit diffusion equation:
\begin{equation} \label{eqn:nonLocalEquation}
	\bar{D} -  l_c^2 \bb{\nabla}^2 \bar{D} = D
\end{equation}
where $l_c$ is a characteristic length scale which controls the area over which the local damage is diffused.
This equation can be viewed as a smoothing equation ($\bar{D}$ is a spatially smoothed version of $D$), which has the effect of mitigating the mesh dependency.
%\begin{equation}
%    \nabla \bar{D}\cdot\textbf{n}=0 
%\end{equation}
%The terms in Equation \ref{eqn:nonLocalEquation} are discretised using the cell-centred finite volume method, similar to the pressure equation (Equation \ref{eq:pressureEqn}).
%The Algorithm for incorporating the non-local damage is provided in Algorithm 4. As can be seen, the procedure is very similar to that in the local Lemaitre damage model. Algorithm 4 is provided to clarify how the non-local damage is coupled with the elasto-plastic model and the steps involved prior to solving the non-local damage gradient equation.
To discretise this equation using the cell-centred finite volume method, we express it in integral form:
\begin{eqnarray} \label{eqn:nonLocalEquationIntegral}
	\underbrace{ \int_{\Omega_u} \bar{D} \, d \Omega_u }_{\text {implicit}}
	- \underbrace{  \oint_{\mathrm{\Gamma}_u}  \bb{n}_u \cdot \left( l_c^2 \nabla \bar{D} \right) \,  d\mathrm{\Gamma}_u }_{\text {implicit}}
	 &=&  \underbrace{ \int_{\Omega_u} D \, d \Omega_u }_{\text {explicit}}
\end{eqnarray}
where the divergence theorem has been used to express the diffusion term (second on the left-hand side) in terms of a surface integral.
As indicated by underbraces, the terms on the left-hand side are treated implicitly (coefficients in the linear system matrix), while the term of the right-hand side is treated explicitly in a deferred correction manner using values from the previous outer (Picard) iteration.

Assuming a linear variation of $\bar{D}$ within cell $P$, the mid-point rule is used to approximate the first term on the left-hand side of Equation \ref{eqn:nonLocalEquationIntegral}:
\begin{eqnarray}
	\underbrace{ \int_{\Omega_u} \bar{D} \, d \Omega_u }_{\text {implicit}} &\approx& \bar{D}_P \Omega_{u_P} 
\end{eqnarray}
This term is treated implicitly with the resulting linear system matrix coefficient contribution being $\Omega_{u_P}$ on the diagonal.

Similarly, the right-hand side term is approximated using the mid-point rule:
\begin{eqnarray}
	\underbrace{ \int_{\Omega_u} D \, d \Omega_u }_{\text {explicit}} &\approx& D_P \Omega_{u_P} 
\end{eqnarray}
where this term is treated in a deferred correction manner, where $ D_P \Omega_{u_P} $ is added to the linear system source.

The surface integral term (second on the left-hand side) is discretised by assuming a linear various of the integrand over the face and applying the mid-point rule about the face centre $f$:
\begin{eqnarray}
	\underbrace{ \oint_{\mathrm{\Gamma}_u}  \bb{n}_u \cdot \left( l_c^2 \nabla \bar{D} \right) \,  d\mathrm{\Gamma}_u }_{\text {implicit}}
		&=&
		\sum_{f \in N_f} \int_{\mathrm{\Gamma}_u}  \bb{n}_u \cdot \left( l_c^2 \nabla \bar{D} \right) \,  d\mathrm{\Gamma}_u \notag \\
		&\approx&
		\sum_{f \in N_f} l_c^2 \left|\boldsymbol{\Delta}_{u_f}\right|\left(\frac{\bar{D}_{N_f} - \bar{D}_P}{\left|\bb{d}_f\right|}\right)\left|\bb{\Gamma}_{u_f}\right| \notag \\
		    &&+ \sum_{f \in N_f} l_c^2 \; \bb{k}_{u_f} \cdot
		    \left(  \boldsymbol{\nabla} \bar{D}   \right)_f
		    \left|\bb{\Gamma}_{u_f}\right|
\end{eqnarray}

%The first term on the right-hand side is treated implicitly (coefficients in the linear system matrix) and the second term is treated in a deferred correction manner (contributes to the linear system source) using values from the previous outer (Picard) iteration.
This equation is solved with zero-flux Neumann boundary conditions on all boundaries, that is,  $\bb{n} \cdot \nabla \bar{D} = 0$.
Consequently, the contributions coming from boundary faces are dropped.

For each computational cell, the resulting algebraic equation becomes:
\begin{eqnarray}
	\left(
		\Omega_{u_P}
		+ \sum_{f \in N_f}
		\frac{l_c^2 \left|\boldsymbol{\Delta}_{u_f} \right| \left| \bb{\Gamma}_{u_f} \right|}{\left|\bb{d}_f\right|}
	\right) \bar{D}_P
	- \sum_{f \in N_f}
	\frac{l_c^2 \left|\boldsymbol{\Delta}_{u_f}\right| \left|\bb{\Gamma}_{u_f} \right|}{\left|\bb{d}_f\right|} \bar{D}_{N_f}
	&=&
	D_P \Omega_{u_P}
	+ \sum_{f \in N_f} l_c^2 \; \bb{k}_{u_f} \cdot   \left(  \boldsymbol{\nabla} \bar{D}   \right)_f   \left|\bb{\Gamma}_{u_f}\right| \notag \\
\end{eqnarray}
in terms of the unknown non-local damage at the centres of cell $P$ and the neighbouring cells $N_f$.
A similar algebraic equation is formed for each cell in the mesh and assembled into a system of linear equations.
This equation is iteratively solved once per outer (Picard) iteration resulting in an implicit discretisation that is balanced at convergence of the outer loop.
The resulting sparse matrix is strongly diagonally dominant due to the inclusion of the $\Omega_{u_P}$, ensuring rapid convergence of the iterative linear solver.
In the limit of $l_c$ going to zero, the system of equations become decoupled and $\bar{D}_P = D_P$ as expected.


\paragraph{Effective Non-Local Damage} \label{sec:effNonLocalDam}
An additional issue with the classic non-local Lemaitre damage model is that it can lead to a non-physical response when the material reaches ultimate failure.
The non-local equation diffuses the damage, reducing the rate at which it evolves after a certain point.
In reality, it would be expected for a piece of material to quickly become fully damaged as it enters the void coalescence stage of failure.
Furthermore, fully degraded cells continue to contribute to the damage growth in the surrounding cells through the non-local damage field, which is nonphysical.

To mitigate these issues, this work introduces an \emph{effective} non-local damage field $\bar{D}_{\text{eff}}$.
This field is set such that it is equivalent to the non-local damage field unless, for a given cell, the non-local damage field exceeds the critical damage value $D_c$ (the damage at which failure occurs).
At this critical value, the effective non-local damage is set \emph{close} to $1$ to represent fully degraded material.
A value of $0.99$ is proposed here instead of $1$ to allow small residual stresses that aid convergence.
An additional change to the classic approach is the growth of the local damage $D$, for a given cell, is disallowed if the effective non-local damage of this cell exceeds the critical damage value $D_c$.
%This prevents the nonphysical behaviour whereby a cell that is set as being fully cracked is contributing to the damage growth in the surrounding cells through the non-local damage field. This scheme is described in Algorithm \ref{alg:effectiveNonLocalDamage}.

The implication of this proposed effective non-local damage approach is examined in Section \ref{sec:effectiveNonLocalDamResults}.

%This scheme is described in Algorithm \ref{alg:effectiveNonLocalDamage}.



\subsubsection{Computational Procedure} \label{sec:lemaitre_comp_proc}
%For each cell, the incremental displacement field $\Delta\boldsymbol{u}$ for the current time step $t^{[m+1]}$, at the current iteration, is provided. The following variables from the previous time step are also given:
% \begin{equation}
%\left\{F_n^p,\ \alpha_n,D_n\right\}
%\end{equation}
%The goal is then to have a return-mapping algorithm to obtain the following variables at time $t^{[m+1]}$
%\begin{equation}
%\left\{F^{[m+1]}^p,\ \alpha^{[m+1]},\boldsymbol{\sigma}^{[m+1]},D^{[m+1]}\right\}
%\end{equation}
%In order to obtain these values, the algorithm must satisfy the following constitutive behaviour:
%\begin{equation}
%\label{eqn:deformationPlasticStrainRelation}
%	{\dot{\bb{F}}}^p\bb{F}^{p-1}=\frac{3}{2}\frac{\dot{\gamma}}{\left(1-D\right)}\bb{R}^{eT}\frac{\boldsymbol{\tau}_d}{\tau_{eq}}\bb{R}^e={\bar{\bb{d}}}^p
%\end{equation}
%\begin{equation}
%	\dot{\alpha}=\dot{\gamma}	
%\end{equation}
%\begin{equation}
%	\dot{D}=-\dot{\gamma}\frac{\partial F}{\partial Y}=\frac{\dot{\gamma}}{\left(1-D\right)}\left[\frac{-Y}{S_0}\right]^b
%\end{equation}



%Equation \ref{eqn:deformationPlasticStrainRelation} is integrated using the one-step implicit integration operator corresponding to the Euler backward method to get:
%\begin{equation}
%	\bb{F}^{[m+1]}^p=exp\left[\frac{3}{2}\frac{\Delta\gamma}{\left(1-D^{[m+1]}\right)}\bb{R}^{[m+1]}^{e^T}\frac{\boldsymbol{\tau}_{d^{[m+1]}}}{\tau_{eq\ n+1}}\bb{R}^{[m+1]}^e\right]\bb{F}^{[m]}^p
%\end{equation}
%Following the procedure laid out in section 3.2.3, the additive split for the elastic and plastic strain is obtained:
%\begin{equation}
%	\boldsymbol{\varepsilon}^{[m+1]}^e=\boldsymbol{\varepsilon}^{[m+1]}^{e\ trial}-\frac{3}{2}\frac{\Delta\gamma}{\left(1-D^{[m+1]}\right)}\frac{\boldsymbol{\tau}_{d^{[m+1]}}}{\tau_{eq\ n+1}}
%\end{equation}
%
%The integration of the other constitutive equations using the backwards Euler scheme is simply given by:
%\begin{equation}
%	\alpha^{[m+1]}-\alpha_n=\Delta\gamma
%\end{equation}
%\begin{equation}
%   \alpha^{[m+1]}=\alpha_n+\Delta\gamma	
%\end{equation}
%\begin{equation}
%	D^{[m+1]}-D_n=\frac{\Delta\gamma}{\left(1-D^{[m+1]}\right)}\left[\frac{-Y^{[m+1]}}{S_0}\right]^b
%\end{equation}
%\begin{equation}
%D^{[m+1]}=D_n+\frac{\Delta\gamma}{\left(1-D^{[m+1]}\right)}\left[\frac{-Y^{[m+1]}}{S_0}\right]^b	
%\end{equation}
%
%The final system of equations to be solved when the material is undergoing plastic straining is therefore given by:
%
%\begin{equation}
%\left\{\begin{array}{c}
%\frac{\tau_{eq\ n+1}}{1-D^{[m+1]}}-\sigma_y\left(\alpha^{[m+1]}\right)=0 \\
%\boldsymbol{\varepsilon}^{[m+1]}^e=\boldsymbol{\varepsilon}^{[m+1]}^{e\ trial}-\frac{3}{2} \frac{\Delta \gamma}{1-D^{[m+1]}} \frac{\boldsymbol{\tau}_{d^{[m+1]}}}{\tau_{eq\ n+1}}\\
%\alpha^{[m+1]}=\alpha_n+\Delta \gamma \\
%D^{[m+1]}=D_n+\frac{\Delta\gamma}{\left(1-D^{[m+1]}\right)}\left[\frac{-Y^{[m+1]}}{S_0}\right]^b
%\end{array}\right. 
%\end{equation}


A deferred (defect) algorithm is developed in this work to solve Equations \ref{eq:lemaitre_dp}-\ref{eq:lem_damage}.
At every outer iteration, the plastic increment is solved implicitly, with the value for the damage variable fixed from the previous outer iteration.
The damage rate equation (Equation \ref{eq:lem_damage}) is then solved in a deferred-correction manner using the damage from the previous iteration $D_{[i]}$, where $[i]$ indicates the previous outer iteration and $[i+1]$ indicates the current outer iteration.
This approach avoids using a $2 \times 2$ matrix (or an even higher dimension matrix if one were to solve for anisotropic plasticity or plasticity incorporating kinematic hardening) that would be needed if both the damage and the plastic increment were solved for simultaneously.
By not requiring the solution of plasticity and damage simultaneously, the mathematics are simplified when solving for more complex formulations of the Lemaitre damage and non-local damage evolution.
In addition, the proposed approach aligns with the philosophy of the overall segregated solution procedure.
Within each time step, $D^{[m+1]}_{[i]}$ converges to $D^{[m+1]}_{[i+1]}$.
Note that the overall solution algorithm is still implicit in time.

%The superscript notation laid out in equations \ref{eqn:superscript1} and \ref{eqn:superscript2} is used to indicate whether the damage variable is from the current iteration or from the previous iteration. The superscript $^{i+1}$ means that the variable is from the current outer iteration, while the superscript $^{i}$ means that the variable is from the previous outer iteration.
%
%\begin{equation}
%\label{eqn:superscript1}
%    D^{i+1}^{[m+1]}
%\end{equation}
%\begin{equation}
%\label{eqn:superscript2}
%    D^{i}^{[m+1]}
%\end{equation}

%The first three of the equations in the system given in 4.41 can be satisfied by solving the yield potential for the plastic increment $\Delta\gamma$, with the damage obtained from the previous iteration frozen. 

%First, the von Mises stress is defined in terms of the elastic strain and combined with equation 4.36:
%\begin{equation}
%\begin{aligned}
%%\frac{\tau^{eq}^{[m+1]}}{1-D^{i}^{[m+1]}}=\bar{\tau}_{{eq}^{[m+1]}}&=\sqrt{\frac{3}{2}}\left\|2 \mu \operatorname{dev}\left(\boldsymbol{\varepsilon}^{[m+1]}^e\right)\right\|\\
%%&=\sqrt{\frac{3}{2}}\left\|2 \mu \operatorname{dev}\left(\boldsymbol{\varepsilon}^{[m+1]}^{e \text { trial }}-\frac{3}{2} \frac{\Delta \gamma}{\left(1+D^{i}^{[m+1]}\right)} \frac{\boldsymbol{\tau}_{d^{[m+1]}}}{\tau_{eq\ n+1}}\right)\right\|
%fix
%\end{aligned}
%\end{equation}

%Following the procedure laid out in Section 3.2.3, the equation for the yield function in terms of the plastic increment can be obtained in terms of the plastic increment:
%\begin{equation}
%	\bar{\tau}_{eq\ n+1}^{trial}-3\mu\frac{\Delta\gamma}{\left(1-D^{i}^{[m+1]}\right)}-\sigma_{y\ }\left(\alpha_n+\Delta\gamma\right)=0
%\end{equation}

%This is solved implicitly using the Newton-Raphson algorithm for $\Delta\gamma$; the stress tensor and the plastic strain tensor are then updated based on this value.  
%After updating these values, the damage equation can be solved explicitly.


%\paragraph{Overall Stress Calculation Procedure}

This stress calculation procedure for the Lemaitre damage model using the proposed effective non-local damage model is summarised in Appendix \ref{app:stressCalcAlg}. %Algorithm \ref{alg:lemaitre}.
This approach reverts to the \emph{classic} non-local damage Lemaitre procedure with three changes:
\begin{enumerate}[label=(\alph*)]
	\item The effective non-local damage $\bar{D}_\text{eff}$ is set always equal to the non-local damage $\bar{D}$ -- modification to step (viii);
	\item The local damage $D$ is not limited in its growth by the effective non-local damage $\bar{D}_\text{eff}$ -- modification to step (vii).
	\item The local damage $D$ is set to be 0.99 when it becomes greater than $D_c$ -- modification to step (vii)
\end{enumerate}
The impact of the proposed effective non-local damage approach is examined in Section \ref{sec:effectiveNonLocalDamResults}.

% where $\bar{D}^{[m+1]}_{[i]}$ is the latest available non-local damage field at the new time, i.e. its values from the previous outer iteration.
%To aid numerical convergence, a critical damage parameter $D_c$ is incorporated \cite{lemaitre_continuous_1985}, which limits the maximum value of the damage $D$ to $D_c$, rather than $1$.
%In the current work, $D_c = 0.99$ is assumed.
%Consequently, the damage rate equation (Equation \ref{eqn:classicY}) becomes
%\begin{equation} \label{eq:damageLimit} % note: flip sign from Andrew's thesis, as Andrew assume p = hyd(sigma), whereas we assume p = -hyd(sigma)
%%	D^{i+1}^{[m+1]}= \begin{cases}D_n & \text { if } \eta\leq-\frac{1}{3}	\\
%%	D_n+\frac{\Delta\gamma}{\left(1-D^{i}^{[m+1]}\right)}\left[\frac{-Y^{[m+1]}}{r}\right]^s & \text { if } \eta>-\frac{1}{3}\end{cases}
%	\dot{D} =
%	\begin{cases}
%		0 & \text { if } \eta \leq -\frac{1}{3} \text{ or } D \geq D_c \\
%		\frac{\dot{\bar{\varepsilon}}_p}{1 - D}\left(\frac{-Y}{S(\eta,\xi)}\right)^b 
%		& \text { if } \eta>-\frac{1}{3} \text{ and }  D < D_c
%	\end{cases}
%\end{equation}
%where $S$ can be a function of $\eta$ and $\xi$ as described above.
%In addition, $D$ is explicitly bound to be less than of equal to $D_c$.

%\hl{Add alg below into main alg}
%\begin{algorithm}[htbp] \label{alg:effectiveNonLocalDamage}
%\SetAlgoLined
%(i) For all cells, calculate local damage  \\
%
%  \eIf{$\bar{D}_{\text{eff}\ n+1}^{i} <= D_c$}{
%  \begin{equation}
%D^{i+1}_{n+1}=D_n+\frac{\Delta\gamma}{\left(1-D^{i}_{n+1}\right)}\left[\frac{-Y_{n+1}}{S_0}\right]^b \notag
%\end{equation} 
%   }{
%\begin{equation}
%D^{i+1}_{n+1}=D^{i}_{n+1} \notag
%\end{equation}
%  } 
%
%(ii) Calculate global non-local damage field
%\begin{equation}
%	\left(D^{i+1}_{n+1}-\bar{D}^{i+1}_{n+1}\right)+{{l_c}^2\mathrm{\nabla}}^2D^{i+1}_{n+1}=0 \notag	
%\end{equation}
%
%(iii) Set the effective non-local damage field for each cell \\
%\eIf{$\bar{D}_{n+1}^{i+1} <= D_c$}{
%	\begin{equation}
%	D^{i+1}_{\text{eff}\ n+1}=D^{i+1}_{n+1}\notag
%	\end{equation} 
%   }{
%	\begin{equation}
%	D^{i+1}_{\text{eff}\ n+1}=0.99 \notag
%	\end{equation}
%  } 
%\caption{Damage evolution scheme}
%\end{algorithm}



%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.9\textwidth]{./Figures/damageModels/lemaitreDamageSchematic.png}
%\caption{Schematic for overall algorithm}
%\label{fig:deforming body}
%\end{center}
%\end{figure}




%%\textbf{Implementation}
%%
%%Equation \ref{eqn:nonLocalEquation} is given in its strong integral form, with respect to the updated configuration, as
%%
%%\begin{equation}
%%\int_{\mathrm{\Omega}_u}D\ d\mathrm{\Omega}_u-\int_{\mathrm{\Omega}_u}\bar{D}\ d\mathrm{\Omega}_u+\oint_{\mathrm{\Gamma}_u}{{l_c}^2\ \bb{n}_u\cdot\mathrm{\nabla}\mathrm{\bar{D}}}\ d\mathrm{\Gamma}_u=0
%%\end{equation}
%%
%%In the context of the overall algorithm for the non-local Lemaitre damage model, the non-local damage $\bar{D}$ is solved for implicitly at the current iteration and the current time step, using the local damage $D$ at the current time step and current iteration.
%%
%%\begin{equation}
%%\int_{\mathrm{\Omega}_u}D^{i+1}^{[m+1]}\ d\mathrm{\Omega}_u-\int_{\mathrm{\Omega}_u}\bar{D}^{i+1}^{[m+1]}\ d\mathrm{\Omega}_u+\oint_{\mathrm{\Gamma}_u}{{l_c}^2\ \bb{n}_u\cdot\mathrm{\nabla}\mathrm{ \bar{D}^{i+1}^{[m+1]}}}\ d\mathrm{\Gamma}_u=0
%%\end{equation}
%
%\begin{algorithm}[H]
%\SetAlgoLined
%(i) Update Relative Deformation for given incremental displacement
%
%\begin{equation}
%  \bb{f}^{[m+1]}=\bb{I}+\nabla\left[\Delta\textbf{u}\right]\nonumber
%\end{equation}
%
%\begin{equation}
%\bb{F}^{[m+1]}=\bb{f}^{[m+1]}\bb{F}_n\nonumber
%\end{equation}
%(ii) Compute trial elasticity
%\begin{equation}
%\bb{B}^{e}^{[m]}=exp\left[{2\boldsymbol{\varepsilon}^{e}^{[m]}}\right]\nonumber
%\end{equation}
%\begin{equation}
%\bb{B}^{e}_{trial}=\bb{f}^{[m+1]}\bb{B}^{e}^{[m]}(\bb{f}^{[m+1]})^{T}\nonumber
%\end{equation}
%\begin{equation}
%\boldsymbol{\varepsilon}^{e}_{trial}=\frac{1}{2}ln[\textbf{B}^{e}_{trial}]\nonumber
%\end{equation}
%\begin{equation}
%\alpha_{trial}=\alpha^{[m]}\nonumber
%\end{equation}
%\begin{equation}
%\bar{\tau}_{eq}^{trial}=\sqrt{\frac{3}{2}}\lvert\lvert2\mu\ dev(\boldsymbol{\varepsilon}^{e}_{trial})\rvert\rvert\nonumber\nonumber
%\end{equation}
%\begin{equation}
%f_{trial}=  \bar{\tau}_{eq}^{trial}-\sigma_{y}(\alpha) \nonumber 
%\end{equation}
%  \eIf{$f_{trial}>0$}{
%   go to step iii to solve for $\Delta\gamma$
%   }{
%   $\Delta\gamma=0$ and go to step iv
%  }
%
%(iii) Enter small-strain return map and solve for $\Delta\gamma$ using the Newton-Raphson method to solve the equation:
%\begin{equation}
%\bar{\tau}_{eq}^{trial}-\frac{3\mu\Delta\gamma}{1-\bar{D}^{i}^{[m+1]}}-\sigma_{y}(a+\Delta\gamma)=0\nonumber
%\end{equation}
%(iv) Update Constitutive Variables
%\begin{equation}
%\alpha^{[m+1]}=\alpha_n+\Delta\gamma\nonumber
%\end{equation}
%\begin{equation}
%\boldsymbol{\varepsilon}^{e}^{[m+1]}=\boldsymbol{\varepsilon}^{e}_{trial}-\sqrt{\frac{3}{2}}\frac{\Delta\gamma}{\left(1-\bar{D}^{i}^{[m+1]}\right)}{\frac{dev(\boldsymbol{\varepsilon}^{e}_{trial})}{\lvert\lvert\boldsymbol{\varepsilon}^{e}_{trial}\rvert\rvert}}\nonumber
%\end{equation}
%\begin{equation}
%\boldsymbol{\tau}^{[m+1]}=\left(1-\bar{D}^{i}^{[m+1]}\right)\bb{D}^e:\boldsymbol{\varepsilon}^{e}^{[m+1]}\nonumber
%\end{equation}
%\begin{equation}
%\boldsymbol{\sigma}^{[m+1]}=\frac{1}{J}\boldsymbol{\tau}^{[m+1]}\nonumber
%\end{equation}
%(v) Update local damage field (equation \ref{DamageUpdateEquation})
%
%\ (vi) Update non-local damage field (equation \ref{eqn:nonLocalEquation})
%\caption{Non-local Lemaitre damage model}
%\end{algorithm}



%\subsubsection{Effective non-local damage development}
%
%
%One issue with the classic non-local Lemaitre damage model is that it can lead to a somewhat non-physical response. To illustrate this point, the results for the flat notched bar case with non-local Lemaitre damage (case a) and the notched round bar with non-local Lemaitre damage (case b) from the previous section are analysed. The cases looked at here use a time step of $0.001$ and a Rhie-Chow scale factor of $0.1$. The force-displacement curves and the damage evolution plotted at the cells where fracture first occurs (Figures \ref{axiMesh} and \ref{bordenMesh}) are given in Figures \ref{BordenNonLocalIssue} and \ref{AxiNonLocalIssue}.
%
%\begin{figure}[t!]
%	\centering
%		\subfigure[Force vs. displacement] {\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/CNLDispForceBorden.png}}
%		\qquad
%		\subfigure[non-local Damage vs. displacement] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/disp_damageNonLocalBorden.png}}
%	\caption{Flat notched bar (case a)}
%	\label{BordenNonLocalIssue}
%\end{figure}
%\begin{figure}[t!]
%	\centering
%		\subfigure[Force vs. displacement] {\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/CNLDispForceAxi.png}}
%		\qquad
%		\subfigure[non-local Damage vs. displacement] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/disp_damageNonLocalAxi.png}}
%	\caption{Notched round bar (case b)}
%	\label{AxiNonLocalIssue}
%\end{figure}

%Although subtle, we have found that limiting the value of the non-local damage field $\bar{D}$ (step (viii)) is critical for achieving reliable predictions.
%Non-physical issues with the damage evolution can be observed in Figures \ref{BordenNonLocalIssue} and \ref{AxiNonLocalIssue}. The non-local gradient equation has the effect of diffusing the damage such that after a certain point, the rate at which the damage evolves is reduced. In reality, it would be expected for the cell to quickly become fully damaged as it enters the void coalescence stage (Figure \ref{fig:Ductile-damage-evolution}) 
%To mitigate these issues, a novel formulation of the non-local Lemaitre model is developed in this work. The nonphysical response is mitigated by introducing the effective non-local damage field $\bar{D}_{eff}$. This field is set such that it is equivalent to the non-local damage field unless for a given cell the non-local damage field exceeds a critical damage value $D_c$. At this critical value, the effective non-local damage is set to be $0.99$. This cell can be viewed as essentially being fully degraded, the effective non-local damage $\bar{D}_{eff}$ is set as $0.99$ as opposed to $1.0$ in order to allow some small residual stresses in these cells to aid convergence.
%Further to this, the growth of the local damage for a given cell is prevented if the effective non-local damage of this cell exceeds the critical damage value $D_c$.
%This step prevents nonphysical behaviour whereby a cell that is set as being fully damaged ($D = D_c$) is contributing to the damage growth in the surrounding cells through the non-local damage field.
%This scheme is described in Algorithm \ref{effectiveNonLocalDamage}.

%\begin{algorithm}[H]
%\label{effectiveNonLocalDamage}
%\SetAlgoLined
%(i) For all cells calculate local damage  \\
%
%  \eIf{$\bar{D}_{eff\ n+1}^{i} <= D_c$}{
%  \begin{equation}
%D^{i+1}^{[m+1]}=D_n+\frac{\Delta\gamma}{\left(1-D^{i}^{[m+1]}\right)}\left[\frac{-Y^{[m+1]}}{S_0}\right]^b \notag
%\end{equation} 
%   }{
%\begin{equation}
%D^{i+1}^{[m+1]}=D^{i}^{[m+1]} \notag
%\end{equation}
%  } 
%
%(ii) Calculate global non-local damage field
%\begin{equation}
%	\left(D^{i+1}^{[m+1]}-\bar{D}^{i+1}^{[m+1]}\right)+{{l_c}^2\mathrm{\nabla}}^2D^{i+1}^{[m+1]}=0 \notag	
%\end{equation}
%
%(iii) Set the effective non-local damage field for each cell \\
%\eIf{$\bar{D}^{[m+1]}^{i+1} <= D_c$}{
%\begin{equation}
%D^{i+1}_{eff\ n+1}=D^{i+1}^{[m+1]}\notag
%\end{equation} 
%   }{
%\begin{equation}
%D^{i+1}_{eff\ n+1}=0.99 \notag
%\end{equation}
%  } 
%\caption{Damage evolution scheme}
%\end{algorithm}







%%%%%%%%%%
\subsection{Gurson-Tvergaard-Needleman Model}
%%%%%%%%%%

\subsubsection{Model Formulation}

\citet{gurson_continuum_1977} proposed the canonical micro-mechanical framework for ductile damage prediction and provided the basis for various derived models \citep{besson_continuum_2010, bettaieb_numerical_2011, achouri_numerical_2013, cao_models_2017, tekkaya_damage_2020}.
As noted above, this model posits the existence of micro-voids in the material, the density of which is described by a variable denoted as porosity $f$.
%The density of these voids is described by a variable denoted as porosity $f$.
Material degradation is characterised by increasing porosity due to the growth of these voids.
%Defining material degradation merely in terms of the growth of voids is limited, however.
Gurson’s framework was further developed by \citet{tvergaard_analysis_1984} to account for the void nucleation and coalescence, leading to the Gurson-Tvergaard-Needleman (GTN) model.
%To be consistent with how the GTN model is typically described in the literature \cite{bettaieb_numerical_2011,achouri_numerical_2013} and to present the equations in the form that they are implemented in the developed codes, the equivalent stress $\tau_{eq}$ is described using the symbol $q$ and the pressure $\tau_h$ is denoted by the symbol $p$. 

%\subsubsection{Evolution of Voids}

%The growth and nucleation of voids characterise the evolution of the porosity $f$:
%\begin{equation}
%	\dot{f}=\dot{f}_{growth}+\dot{f}_{nucleation}	
%\end{equation}	
%
%The growth of the voids is derived from the principle of mass conservation. It is given as a function of the strain rate:
%\begin{equation}
%	\dot{f}_{growth}=\left(1-f\right)tr\left(\dot{\boldsymbol{\varepsilon}}_p\right)	
%\end{equation}
% Where $\dot{\boldsymbol{\varepsilon}}_p$ is the plastic strain rate. 
%    
%The term for the nucleation of new voids is given by:
%\begin{equation}
%	{\dot{f}}_{nucleation}=A{\dot{\bar{\varepsilon}}}_p	
%\end{equation}
%
%
%Where ${\dot{\bar{\varepsilon}}}_p$ is the rate of change of the equivalent plastic strain and A is a dimensionless coefficient.
%The nucleation of new voids is assumed to be described by a normal distribution \cite{chu_void_1980} giving the following expression for the coefficient $A$:
%\begin{equation}
%\label{eqn:nucleatonA}
%A= \begin{cases}\frac{f_n}{S_n \sqrt{2 \pi}} \exp \left[-\frac{1}{2}\left(\frac{\bar{\varepsilon}_p-\varepsilon_n}{S_n}\right)\right] & \text { if } p>0 \\ 0 & \text { if } p<0\end{cases}
%\end{equation}
%
%where $f_n$ is the quantity of the voids nucleated per unit volume, $\varepsilon_n$ is the nucleation strain and $S_n$ is the standard deviation. 
%
%%\subsection{Yield equation}
%
%The variable f is coupled with the plasticity model through the yield equation 
%\begin{equation}
%	\phi=\left(\frac{q}{\sigma_y}\right)^2+2q_1f^\ast cosh\left(\frac{3q_2p}{2\sigma_y}\right)-\left(1-q_1^2f^{\ast2}\right)
%\end{equation}
%
%Where $q_1$ and $q_2$ are material parameters, $q$ is the von Mises stress, $p$ is the hydrostatic pressure and $\sigma_y$ is the yield stress.
%Here $f^\ast$ is the effective void fraction and is a function of the porosity variable defined above. It is introduced to account for the effects of void coalescence:
%\begin{equation}
%\label{eqn:GTNCoalescence}
%f^*=\left\{\begin{array}{cc}
%f & \text { if } f \leq f_c \\
%f_c+\left(f-f_c\right) \frac{f_u-f_c}{f_f-f_c} & \text { if } f>f_c
%\end{array}\right.
%\end{equation}
%
%Where $f_c$ is the void volume fraction at which the coalescence of voids begins,  $f_u$ is the ultimate volume fraction and $f_f$ represents the void volume fraction at fracture.
%
%%\subsection{Plasticity}
%
%Plastic isotropy and plastic associativity are assumed as in \citet{bettaieb_numerical_2011}. The following relation can therefore be obtained:
%\begin{equation}
%\label{eqn:4.67}
%	\dot{\boldsymbol{\varepsilon}}^p=\dot{\gamma}\frac{\partial\phi}{\partial\boldsymbol{\tau}}	
%\end{equation}
%
%This equation is reformulated in terms of the von Mises equivalent stress $q$ and the pressure $p$ to obtain:
%\begin{equation}
%	\label{eqn:4.68}
% \dot{\boldsymbol{\varepsilon}}^p=\dot{\gamma}\frac{\partial\phi}{\partial q}\frac{\partial q}{\partial\boldsymbol{\tau}}+\dot{\gamma}\frac{\partial\phi}{\partial p}\frac{\partial p}{\partial\boldsymbol{\tau}}
%\end{equation}
%
%Using the definitions of $q$ and $p$:
%\begin{equation}
%	\frac{\partial q}{\partial\boldsymbol{\tau}}=\bb{n}
% \end{equation}
% \begin{equation}
% \frac{\partial p}{\partial\boldsymbol{\tau}}=\frac{1}{3}\bb{I}	
%\end{equation}
%
%where $\bb{n}$ is given by:
%\begin{equation}
%\frac{3}{2q}\bb{\tau}_d.
%\end{equation}
%
%Equation \ref{eqn:4.68} can therefore be written as:
%\begin{equation}
%	\dot{\boldsymbol{\varepsilon}}^p=\dot{\gamma}\left(\frac{\partial\phi}{\partial q}\bb{n}+\frac{1}{3}\frac{\partial\phi}{\partial p}\bb{I}\right)	
%\end{equation}
%Which is equivalent to:
%\begin{equation}
%\label{eqn:4.73}
%\dot{\boldsymbol{\varepsilon}}^p=\frac{1}{3} \dot{\varepsilon}^h \boldsymbol{I}+\dot{\varepsilon}^q \boldsymbol{n}
%\end{equation}
%Where:
%\begin{equation}
%\label{eqn:4.74}
%\dot{ \boldsymbol{\varepsilon}}^h=\dot{\gamma} \frac{\partial \phi}{\partial p} 
%\end{equation}
%\begin{equation}
%\label{eqn:4.75}
%\dot{ \boldsymbol{\varepsilon}}^q=\dot{\gamma} \frac{\partial \phi}{\partial q}
%\end{equation}
%
%Eliminating $\dot{\gamma}$ from equations \ref{eqn:4.74}
%and \ref{eqn:4.75} leads to the consistency equation:
%\begin{equation}
%\dot{ \boldsymbol{\varepsilon}}^h \frac{\partial \phi}{\partial q}-\dot{ \boldsymbol{\varepsilon}}^q \frac{\partial \phi}{\partial p}=0
%\end{equation}
%
%
%%\subsection{Equivalent plastic strain}
%
%Assuming the equivalent plastic work principle, there is an equivalence between the rates of macroscopic and matrix plastic work:
%\begin{equation}
%\dot{\overline{\boldsymbol{\varepsilon}}}^p=\frac{\boldsymbol{\sigma}: \dot{\boldsymbol{\varepsilon}}^p}{(1-f) \sigma_y}
%\end{equation}
%Substituting in equation \ref{eqn:4.73}, the equation for the equivalent plastic strain is obtained in its final form:
%\begin{equation}
%\dot{\overline{\boldsymbol{\varepsilon}}}^p=\frac{p \dot{ \boldsymbol{\varepsilon}}^h+q \dot{\boldsymbol{\varepsilon}}^q}{(1-f) \sigma_y}
%\end{equation}
%
%%\subsection{Constitutive equations}
%\subsubsection{Model Formulation}

%\hl{Andrew: check signs, assuming $p = -tr(\sigma)/3$}\\
%\hl{Andrew: should $f$ be $f_*$ in the 2nd eqn?}\\
The GTN model is described by a yield equation, flow rule (with deviatoric and volumetric components), consistency condition, and porosity evolution equations:
\begin{eqnarray}
	&\Phi =
	\left(\frac{\sigma_v}{\sigma_y}\right)^2 + 2 q_1 f_* \cosh \left(\frac{3 q_2 p}{2 \sigma_y}\right)
	- \left(1 + q_3 f^{2}_* \right) \label{eqn:GTN1} \\
	%= 0 \\
	&\dot{\bar{\varepsilon}}_p =
		\frac{1}{(1-f) \sigma_y} (\sigma_v \dot{ \bar{\varepsilon}}_\text{dev} - p \dot{ \bar{\varepsilon}}_\text{vol}) \label{eqn:GTN2} \\
	&\dot{\bar{\varepsilon}}_\text{vol} \frac{\partial \Phi}{\partial \sigma_v}
		+ \dot{\bar{\varepsilon}}_\text{dev} \frac{\partial \Phi}{\partial p} = 0 \label{eqn:GTN3} \\
	&\dot{f} = (1-f) \, \text{tr}\left(\dot{\boldsymbol{\varepsilon}}_p\right)+A \dot{\bar{\varepsilon}}_p \label{eqn:GTN4}
\end{eqnarray}
where $q_1$, $q_2$ and $q_3$ are dimensionless material parameters.
The effective void fraction $f_*$, which accounts for void coalescence, is
\begin{equation} \label{eqn:GTNCoalescence}
	f_*=
	\left\{
	\begin{array}{cc}
		f & \text { if } f \leq f_c \\
		f_c+\left(f-f_c\right) \frac{f_u-f_c}{f_f-f_c} & \text { if } f>f_c
	\end{array}\right.
\end{equation}
where $f_c$ is the void volume fraction at which void coalescence begins, $f_u$ is the ultimate volume fraction, and $f_f$ is the void volume fraction at fracture.

The rate of volumetric plastic strain and equivalent deviatoric plastic strain are given, respectively, by
\begin{eqnarray}
	\dot{ \varepsilon}_\text{vol} &=& -\dot{\bar{\varepsilon}}_p \frac{\partial \Phi}{\partial p} \\
	\dot{ \varepsilon}_\text{dev} &=& \dot{\bar{\varepsilon}}_p \frac{\partial \Phi}{\partial \sigma_v}
\end{eqnarray}


%Where ${\dot{\bar{\varepsilon}}}_p$ is the rate of change of the equivalent plastic strain and 
The dimensionless coefficient $A$ is chosen to ensure void nucleation follows a normal distribution \cite{chu_void_1980}:
\begin{equation} \label{eqn:nucleatonA}
	A =
	\begin{cases}
	\frac{f_n}{S_n \sqrt{2 \pi}} \exp \left[-\frac{1}{2}\left(\frac{\bar{\varepsilon}_p-\varepsilon_n}{S_n}\right)\right] & \text { if } p < 0 \\
	0 & \text { if } p \geq 0
	\end{cases}
\end{equation}
where $f_n$ determines the total void fraction possible, $\varepsilon_n$ is the mean nucleation strain, and $S_n$ is the nucleation strain standard deviation. 



%\paragraph{Shear Effects}
%\paragraph{Lode Angle Dependence}
%
%Further developments of the GTN model have been made to better account for fracture in stress states with significant shearing \cite{nahshon_modification_2008, malcher_continuum_2012, leclerc_micromechanics-based_2020, achouri_numerical_2013}.
%This work adopts the expression developed by \citet{nahshon_modification_2008} for shearing-related void growth, which has shown an ability to accurately predict fracture in the blanking metal forming process \cite{achouri_numerical_2013}.
%The porosity evolution equation (Equation \ref{eqn:GTN4}) is consequently replaced by
%%\begin{equation}
%%	\dot{f}={\dot{f}}_{growth}+{\dot{f}}_{nucleation}+{\dot{f}}_{shear}	
%%\end{equation}
%\begin{equation}
%%	{\dot{f}}_{shear}=k_w\frac{fw\left(\boldsymbol{\sigma}\right)}{q}\bb{s}:{\dot{\boldsymbol{\varepsilon}}}_p	
%	\dot{f} = (1-f) \, \text{tr}\left(\dot{\boldsymbol{\varepsilon}}_p\right)+A \dot{\bar{\varepsilon}}_p
%%	+ k_w\frac{fw\left(\boldsymbol{\sigma}\right)}{q}\bb{s}:{\dot{\boldsymbol{\varepsilon}}}_p
%	+ k_w f\frac{1 - \xi^2 }{\sigma_v} \,\text{dev}(\bb{\sigma}):{\dot{\boldsymbol{\varepsilon}}}_p
%\end{equation}
%where $k_w$ is a material parameter.
%% and $w(\boldsymbol{\sigma})$ is given by
%%\begin{equation}
%%	w\left(\boldsymbol{\sigma}\right) = 1- \xi^2	
%%\end{equation}


\paragraph{Non-Local Porosity}

Like the Lemaitre model, mesh dependency in the GTN model can be mitigated by introducing non-local damage variables \cite{reusch_non-local_2003, leclerc_micromechanics-based_2020}.
In the case of the GTN model, a non-local (smoothed) porosity variable $\bar{f}$ is determined using a non-local gradient (smoothing) equation:
\begin{equation}
	\bar{f} - {l_c}^2 \bb{\nabla}^2 \bar{f} = f
\end{equation}
%where $\bar{f}$ is the non-local (smoothed) porosity field.
As before, this equation can be discretised using the described cell-centred finite volume method and zero-flux Neumann boundary conditions.
%  The effective porosity $f^\ast$ is then calculated according to equation \ref{eqn:GTNCoalescence} using the non-local porosity $\bar{f}$. Where $f$ appears in the system of equations \ref{eqn:discritesedGTNSystem} the non-local porosity is used.



\subsubsection{Computational Procedure}

%\hl{Philip reminder: make notation consistent for tensor multiplication}\\
For the GTN model, the elastoplasticity stress calculation is extended to determine porosity $f$ in addition to stress and plastic strain.
The adopted computational algorithm is shown in Appendix \ref{app:stressCalcAlg}. %Algorithm \ref{alg:GTN}.
As in the Lemaitre computational procedure, we propose a deferred correction algorithm to solve the system of equations:
Equations \ref{eqn:GTN1}, \ref{eqn:GTN2} and \ref{eqn:GTN3} are solved implicitly for the variables ${\varepsilon}_\text{vol}$, ${\varepsilon}_\text{dev}$ and $\overline{{\varepsilon}}_p$ using a Newon-Raphson method, while the porosity $f$ (Equation \ref{eqn:GTN4}) is calculated in a deferred-correction manner.
Once again, the overall procedure is implicit in time.

%For each cell, the incremental displacement field $\Delta\bb{u}$ for the current time step, at the current iteration, is given. The values of the following variables from the previous time step are also provided:
%\begin{equation}
%\left\{F_n^p,\ {{\bar{\varepsilon}}^p}_n,f_n\right\}
%\end{equation}
%The goal is then to have a computational procedure to obtain the following variables at time $t^{[m+1]}$
%\begin{equation}
%\left\{F^{[m+1]}^p,\ {{\bar{\varepsilon}}^p}^{[m+1]},\boldsymbol{\sigma}^{[m+1]},f^{[m+1]}\right\}
%\end{equation}
%This is achieved in the material solver by solving the set of equations laid out in equation \ref{eqn:4.79}.
%
%Equation 3.30 is given in terms of the GTN yield equation:
%\begin{equation}
%	{\dot{\bb{F}}}^p\bb{F}^{p-1}=\Delta\gamma\bb{R}^{eT}\frac{\partial\phi}{\partial\boldsymbol{\tau}}\bb{R}^e
%\end{equation}
%Employing the exponential map backward scheme for the time-discretisation of the plastic flow rule, one can obtain:
%\begin{equation}
%	\bb{F}^{[m+1]}^p=exp\left[\Delta\gamma\bb{R}^{[m+1]}^{e^T}\frac{\partial\phi}{\partial\boldsymbol{\tau}^{[m+1]}}\bb{R}^{[m+1]}^e\right]\bb{F}_n^p
%\end{equation}
%Due to plastic isotropy this equation can be written as:
%\begin{equation}
%	\bb{F}^{[m+1]}^p=\bb{R}^{[m+1]}^{e^T}exp\left[\Delta\gamma\frac{\partial\phi}{\partial\boldsymbol{\tau}^{[m+1]}}\right]\bb{R}^{[m+1]}^e\bb{F}_n^p
%\end{equation}
%Subbing in equation \ref{eqn:4.67}
%\begin{equation}	\bb{F}^{[m+1]}^p=\bb{R}^{[m+1]}^{e^T}exp\left[\Delta{\boldsymbol{\varepsilon}}^p^{[m+1]}\right]\bb{R}^{[m+1]}^e\bb{F}_n^p	
%\end{equation}
%Using the same procedure laid out in section 3.2.3, the additive split for the elastic and plastic contributions is obtained:
%\begin{equation}
%\boldsymbol{\varepsilon}^{[m+1]}^e=\boldsymbol{\varepsilon}^{[m+1]}^{e \text { trial }}-\Delta \varepsilon^{[m+1]}^p
%\end{equation}

%The porosity $f^{[m+1]}$ is then solved for explicitly. 
%Using the fact that:
%\begin{equation}
%p^{[m+1]}=p_{\text {trial }}-K \Delta \varepsilon^{[m+1]}^h 
%\end{equation}
%\begin{equation}
%q^{[m+1]}=q_{\text {trial }}-3 \mu \Delta \varepsilon^{[m+1]}^q
%\end{equation}


%The system of equations to be solved, $r_i$, implicitly are given by
%\begin{equation}
%\label{eqn:discritesedGTNSystem}
%\left\{\begin{array}{c}
%r_{\Delta \varepsilon^{[m+1]}^q}=\left(\frac{q_{\text {trial }}-3 \mu \Delta \varepsilon^{[m+1]}^q}{\sigma_y\left(\bar{\varepsilon}^p+\Delta \bar{\varepsilon}^p{ }^{[m+1]}\right)}\right)^2+2 q_1 f^{*i}^{[m+1]} \cosh \left(\frac{3 q_2\left(p_{\text {trial }}-K \Delta \varepsilon^{[m+1]}^h\right)}{2 \sigma_y\left(\bar{\varepsilon}^p+\Delta \bar{\varepsilon}^p{ }^{[m+1]}\right)}\right)-\left(1-q_1^2 {f^{*i}}^2^{[m+1]}\right)=0 \\
%r_{\Delta \varepsilon^{[m+1]}^h}=\Delta \varepsilon^{[m+1]}^h \frac{\partial \phi}{\partial q}-\Delta \varepsilon^{[m+1]}^q \frac{\partial \phi}{\partial p}=0 \\
%r_{\Delta \bar{\varepsilon}^p{ }^{[m+1]}}=\Delta \bar{\varepsilon}^p{ }^{[m+1]}-\frac{p \Delta \varepsilon^{[m+1]}^h+q \Delta \varepsilon^{[m+1]}^q}{(1-f^i^{[m+1]}) \sigma_y\left(\bar{\varepsilon}^p+\Delta \bar{\varepsilon}^p{ }^{[m+1]}\right)}=0
%\end{array}\right.
%\end{equation}
%The group of unknowns associated with this system of equations is given by $x_i$
%\begin{equation}
%x_i=\left\{\begin{array}{c}
%\Delta \varepsilon^{[m+1]}^q \\
%\Delta \varepsilon^{[m+1]}^h \\
%\Delta \bar{\varepsilon}^p
%\end{array}\right\}
%\end{equation}
%The system of equations is solved at the centre of each volume using the Newton-Raphson method
%\begin{equation}
%\boldsymbol{x}_{i n+1}=\boldsymbol{x}_{i n}-\left[\left.\frac{\partial \boldsymbol{r}_i}{\partial \boldsymbol{x}_i}\right|_{\boldsymbol{x}_n}\right]^{-1} \boldsymbol{r}_i\left(\boldsymbol{x}_n\right)
%\end{equation}
%$\frac{\partial r_i}{\partial x_i}$ is the Jacobian of the equations $r_i$ with respect to the variables $x_i$ given by:
%\begin{equation}
%\frac{\partial \boldsymbol{r}_i}{\partial \boldsymbol{x}_i}=\left[\begin{array}{ccc}
%\frac{\partial r_{\Delta \varepsilon^{[m+1]}^q}^q}{\partial \Delta \boldsymbol{\varepsilon}^{[m+1]}^q} & \frac{\partial r_{\Delta \varepsilon^{[m+1]}^q}^q}{\partial \Delta \boldsymbol{\varepsilon}^{[m+1]}^h} & \frac{\partial r_{\Delta \varepsilon^{[m+1]}^q}^q}{\partial \Delta \overline{\boldsymbol{\varepsilon}}^p^{[m+1]}} \\
%\frac{\partial r_{\Delta \varepsilon^{[m+1]}^h}}{\partial \Delta \boldsymbol{\varepsilon}^{[m+1]}^q} & \frac{\partial r_{\Delta \varepsilon^{[m+1]}^h}}{\partial \Delta \boldsymbol{\varepsilon}^{[m+1]}^h} & \frac{\partial r_{\Delta \varepsilon^{[m+1]}^h}}{\partial \Delta \overline{\boldsymbol{\varepsilon}}^p{ }^{[m+1]}} \\
%\frac{\partial r_{\Delta \overline{\boldsymbol{\varepsilon}}^p{ }^{[m+1]}}}{\partial \Delta \boldsymbol{\varepsilon}^{[m+1]}^q} & \frac{\partial r_{\Delta \overline{\boldsymbol{\varepsilon}}^p{ }^{[m+1]}}}{\partial \Delta \boldsymbol{\varepsilon}^{[m+1]}^h} & \frac{\partial r_{\Delta \overline{\boldsymbol{\varepsilon}}^p{ }^{[m+1]}}}{\partial \Delta \overline{\boldsymbol{\varepsilon}}^p{ }^{[m+1]}}
%\end{array}\right]
%\end{equation}
%Using simple multivariable calculus operations these constituent partial derivatives of the Jacobian can then be derived. These derivatives are provided in Appendix C **. 
%After solving for these variables
%($\Delta {\varepsilon}^{[m+1]}^h$, $\Delta {\varepsilon}^{[m+1]}^q$ and $\Delta \overline{{\varepsilon}}^p$) the equivalent plastic strain, elastic strain, pressure, von Mises stress and stress can then be updated:
%\begin{equation}
%\vec{\varepsilon}^p{ }^{[m+1]}=\vec{\varepsilon}^p{ }_n+\Delta \vec{\varepsilon}^p{ }^{[m+1]} 
%\end{equation}
%\begin{equation}
%\boldsymbol{\varepsilon}^{e}^{[m+1]}=\boldsymbol{\varepsilon}^{e}_{trial}-\frac{1}{3}\Delta {\varepsilon}^{[m+1]}^h\ \bb{I}-\Delta {\varepsilon}^{[m+1]}^q\ \bb{n}
%\end{equation}
%\begin{equation}
%p^{[m+1]}=p_{\text {trial }}-K \Delta \varepsilon^{[m+1]}^h 
%\end{equation}
%\begin{equation}
%q^{[m+1]}=q_{\text {trial }}-3 \mu \Delta \varepsilon^{[m+1]}^q 
%\end{equation}
%\begin{equation}
%\boldsymbol{\tau}^{[m+1]}=p^{[m+1]} \boldsymbol{I}+\frac{2q^{[m+1]}}{3} \boldsymbol{n} 
%\end{equation}
%The porosity can then be determined:
%\begin{equation}
%f_{\mathrm{n}+1}^{\mathrm{i}+1}=f_{\mathrm{n}}+\left(1-f_{\mathrm{n}+1}^{\mathrm{i}}\right) \operatorname{tr}\left(\Delta \varepsilon^{[m+1]}^p\right)+A \Delta \bar{\varepsilon}^p{ }^{[m+1]}
%\end{equation}

%Where ${f}^{[m+1]}^{i+1}$ is the porosity for the current iteration and $f^{[m+1]}^i$ is the porosity from the previous iteration. The effective porosity $f^{*i+1}^{[m+1]}$ is then calculated according to equation \ref{eqn:GTNCoalescence}.
%This procedure is provided in Algorithm 5.






\subsection{Phase Field Fracture Model}

\subsubsection{Model Formulation}
In recent years, phase field approaches have received much attention for the prediction of fracture and failure \cite{borden_phase-field_2012, miehe_phase_2010, ambati_phase-field_2015, borden_phase-field_2016, miehe_phase_2016, dittmann_variational_2018, samaniego_phase-field_2021}, showing an ability to predict complex crack patterns, including branching and merging in both two and three dimensions \cite{borden_phase-field_2012, miehe_phase_2010}.
In this method, sharp cracks are \emph{regularised} over a continuum, leading to a system of partial differential equations that are relatively simple to implement in finite element, finite volume and related solvers.
%The method has proven robust with computations being performed on the original mesh without any need to track the interface of the crack, such as in the Cohesive-zone model method.

The phase field method for damage, initially proposed by \citet{francfort_revisiting_1998} to describe brittle fracture, is based on a variational approach to minimise a Griffiths theory potential energy functional. %proposed based on Griffith's theory of brittle fracture.
This approach leads to a Mumford-Shah \cite{mumford_optimal_1989} type energy potential that can be approximated by a phase-field formulation following the work of \citet{ambrosio_approximation_1990}.
This approximation was adopted by \citet{bourdin_time-discrete_2011} to facilitate numerical solutions of the variational formulation and further extended by \citet{miehe_phase_2010}, who derived the phase field approach from continuum mechanics and thermodynamic arguments.
%In addition to an alternative derivation,
\citet{miehe_phase_2010} also added an important mechanism for distinguishing between tensile and compressive effects on crack growth, as well as including a history variable $\mathcal{H}$, ensuring the irreversibility of crack growth.
Several studies have shown the ability of these models to produce results consistent with benchmark fracture cases \cite{borden_phase-field_2012,miehe_phase_2010}.

The phase field approach has since been extended to ductile fracture by \citet{ambati_phase-field_2015, borden_phase-field_2016} and \citet{miehe_phase_2016}.
The approach from \citet{ambati_phase-field_2015} involves incorporating a plastic strain dependency in the elastic degradation function while the approach from \citet{miehe_phase_2016} incorporates the plastic strain energy into the crack driving variable $\mathcal{H}$.
\citet{borden_phase-field_2016} uses a similar approach to \citet{miehe_phase_2016} by incorporating the plastic strain into the crack driving variable $\mathcal{H}$ while also introducing a plastic degradation function to ensure that fracture is preceded by large plastic strains, as is the seen experimentally.



%%%%%%%%%%%%%%%%
%\subsection{Phase Field Damage Model}
%%%%%%%%%%%%%%%%
%
%The original formulation of the potential energy of the body \cite{mumford_optimal_1989} is given in terms of the deformation tensor and the crack surface
%\begin{equation}
%\label{eqn:originalPotentialEnergyFormulation}
%	E\left(\boldsymbol{\varepsilon}^e,\Gamma_0\right)=\int_{\Omega_0}{\psi\left(\boldsymbol{\varepsilon}^e\right)d\Omega_0}+\int_{\Gamma_0}{G_c^0\ d\Gamma_0}
%\end{equation}
%Where $\psi\left(\boldsymbol{\varepsilon}^e\right)$ is the elastic contribution to the potential energy per unit volume and $G_c$ is the critical fracture energy per unit area. This energy functional is an extension of Griffith’s definition of brittle fracture. This definition of the fracture surface however requires an a priori determination of the fracture surface. In order to enable an efficient numerical treatment of equation \ref{eqn:originalPotentialEnergyFormulation}, \citet{bourdin_time-discrete_2011} introduced the phase field approximation: 
%\begin{equation}
%	E\left(\boldsymbol{\varepsilon}^e,\Gamma_0\right)=\int_{\Omega_0}{g_e(d)\psi\left(\boldsymbol{\varepsilon^e}\right)d\Omega_0}+\int_{\Gamma_0}{G_c^0\ \Gamma_l\left(d\right)d\Omega_0}
%\end{equation}
%
%where $d\left(x\right)\in\left[0,1\right]$,  $d=0$ characterises the unbroken state and d=1 characterises the fully broken state. The variable $d$ is conceptually similar to the damage variable $D$ used in continuum damage mechanics, with $d$ being a macroscopic variable that characterizes the growth of micro voids and micro-cracks, $g_e(d)$ is the elastic degradation function which reduces the elastic strength of the material and $\Gamma_l$ is the crack density functional, which for the model of \citet{borden_phase-field_2016} is given by
%
%\begin{equation}
%	\Gamma_l\left(d\right)=\frac{1}{l}I\left(d\right)=\frac{1}{4l}\left(d^2+4l^2|\nabla d|\right)
%\end{equation}
%The minimization of this functional gives the regularised crack surface as depicted in Figure \ref{fig:Regularising effects of l}. The parameter $l$ is a length scale variable which regularises the crack surface.
%
%% \begin{figure}[t!]
%%	\centering
%%		\subfigure[] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/damageModels/phaseSharpCrack.png}}		
%%	  \qquad
%%		\subfigure[] {\label{boeing} \includegraphics[width=0.3\textwidth]{./Figures/damageModels/phaseRegularised.png}}		
%%\caption{Comparison of a) sharp crack and b) diffusive crack (adapted from \cite{borden_phase-field_2016})}
%%	\label{fig:diffusedSharpCrack}
%%\end{figure}
%%\FloatBarrier
%%
%%\begin{figure}[htb]
%%\begin{center}
%%	\includegraphics[width=0.65\textwidth]{./Figures/damageModels/effectsofl.png}
%%\caption{Illustration of the regularising effect of $l$, as $l$ is reduced the crack variable $d$ is regularised over a smaller area}
%%\label{fig:Regularising effects of l}
%%\end{center}
%%\end{figure}
%%\FloatBarrier
%
%As in \citet{amor_regularized_2009,miehe_phase_2010-1} the elastic strain energy contribution is further split into its tensile and compressive contribution, to ensure that there is no elastic contribution to crack growth when a given volume is under compression
%\begin{equation}
%\label{eqn:energyElasticFunctional}
%E_l\left(\bb{\boldsymbol{\varepsilon}^e},d\right)=\int_{\Omega_0}\left(g_e\left(d\right){\psi_e}^+\left(\boldsymbol{\varepsilon}^e\right)+g_e\left(d\right){\psi_e}^-\left(\boldsymbol{\varepsilon}^e\right)\right)\ d\Omega_0+\int_{\Gamma_0}{G_c^0\Gamma_l\left(d\right)\Omega_0}	
%\end{equation}
%
%Where ${\psi_e}^+\left(\boldsymbol{\varepsilon}^e\right)$ is the contribution of the tensile strains and ${\psi_e}^-\left(\boldsymbol{\varepsilon}^e\right)$ is the contribution of the compressive strains. The energy functional in equation \ref{eqn:energyElasticFunctional} only accounts for the elastic contribution to crack growth. For ductile materials, it is necessary to incorporate a plastic energy contribution to the crack growth. To this end, a plastic energy contribution is added to equation \ref{eqn:energyElasticFunctional} in \citet{borden_phase-field_2016}
%\begin{equation}
%	E_l\left(\boldsymbol{\varepsilon}^e,{\bar{\varepsilon}}^p,d\right)=\int_{\Omega_0}\left(g_e\left(d\right){\psi_e}^+\left(\boldsymbol{\varepsilon}^e\right)+g_e\left(d\right){\psi_e}^-\left(\boldsymbol{\varepsilon}^e\right)+g_p\left(d\right)\psi_p\left({\bar{\varepsilon}}^p\right)\right)\ d\Omega_0+\int_{\Gamma_0}{G_c^0\Gamma_l\left(d\right)d\Omega_0}	
%\end{equation}
%
%Where $g_p\left(d\right)$ is the plastic degradation function, $\psi_p\left({\bar{\varepsilon}}^p\right)$ is the plastic energy contribution. 
%The plastic and elastic degradation functions are given by:
%\begin{equation}
%	g_e\left(d\right)=1-d^2	
%\end{equation}
%\begin{equation}
%	g_p\left(d\right)=1-d^2	
%\end{equation}
%
%\subsection{Model Formulation}

In this work, the approach form \citet{borden_phase-field_2016} is chosen to be most suitable, given the large plastic strains expected in wire drawing.
The strong differential form of the phase field equation is given by:
%, by incorporating a plastic degradation function, it displays a more physically realistic fracture behaviour.
%Following the work of \citet{borden_phase-field_2016}  the 
\begin{equation} \label{eqn:phaseFieldEquation}
	\frac{G_c}{2l} \left(d - 4 l^2 \bb{\nabla}^2 d \right) = \mathcal{H} %\left(\underline{\mathrm{x}},t \right)	
\end{equation}
where $0 < d \leq 1$ is the damage variable, with $d = 0$ characterising the unbroken state and $d = 1$ characterising the fully broken state. 
The variable $d$ is conceptually similar to the damage variable $D$ used in the Lemaitre model and the porosity $f$ in the GTN model, with $d$ being a macroscopic variable that characterises the growth of micro-voids and micro-cracks.
The critical fracture energy per unit area is given by $G_c$.
The parameter $l$ is a length-scale variable that regularises the crack surface. It is typically chosen as a function of the local element/cell size.
The crack driving variable $\mathcal{H}$ is
\begin{equation}
	\mathcal{H} %\left(\underline{\mathrm{x}},t\right)
	=
%		g_e^\prime(d) \,
		-2d \,
		\text{max}
		\left[
			\psi_e
			\left(\bb{\varepsilon}^e\right), \,
			\bar{\psi}_{e}\left(\bb{\varepsilon}^e\right)
		\right]
%	+g_p^\prime \left(d\right)
	-2d
	\langle \psi_p({\bar{\varepsilon}}^p)-w_0 \rangle
\end{equation}
where $\psi_e \left(\bb{\varepsilon}^e\right)$ is the current elastic energy contribution, and $\bar{\psi}_e \left(\bb{\varepsilon}^e\right)$ is a history variable which gives the largest value reached by the elastic energy contribution in time.
%$<\psi_p\left({\bar{\varepsilon}}^p\right)-w_0>$ is a Macaulay bracket
%\subsubsection{Elastic model}
%The spherical-deviatoric decomposition of the elastic strain energy is employed as in \citet{amor_regularized_2009}.
The elastic energy contribution $\psi_e \left(\bb{\varepsilon}^e\right)$ is decomposed into positive and negative components, such that only positive elastic strain energy contributes towards the crack driving energy \citep{amor_regularized_2009}:
\begin{eqnarray}
	\psi_e &=&
	(1 - d^2) \, \psi_{e}^{+} \left(\bb{\varepsilon}_e \right)
	+ \psi_{e}^{-} \left(\bb{\varepsilon}_e \right) \\
	\psi_e^{+}\left(\bb{\varepsilon}^{e}\right) &=&
	\frac{\kappa}{2} \langle \text{tr}\left(\bb{\varepsilon}_{e}\right)\rangle^2
	+\mu \,\text{dev}(\bb{\varepsilon}_e): \text{dev}(\bb{\varepsilon}_e) \\
    	\psi_e^{-} \left(\bb{\varepsilon}_{e}\right) &=&
	\frac{\kappa}{2} \langle-\text{tr}\left(\bb{\varepsilon}_{e}\right) \rangle^2
\end{eqnarray}
%where $\boldsymbol{\varepsilon}_{dev}^{\mathrm{e}}=dev({\boldsymbol{\varepsilon}}^e)$. The positive elastic strain energy is what contributes towards crack driving energy.

%$\psi_p\left({\bar{\varepsilon}}^p\right)$ is the plastic energy contribution, and $w_0$ is the plastic work threshold, below which the plastic strain will not contribute to crack growth.

The plastic energy contribution to the crack growth $\psi_p\left({\bar{\varepsilon}}^p\right)$ is given by \cite{eldahshan_3d_2022}:
\begin{equation}
	\psi_p({\bar{\varepsilon}}^p)=\int_0^{\bar{\varepsilon}^p} \sigma_y \, d \bar{\varepsilon}^p
\end{equation}
and $w_0$ is the plastic work threshold, below which the plastic strain will not contribute to crack growth.



%\subsection{Mechanical constitutive laws}



%The stress is therefore given by
%\begin{equation}
%\boldsymbol{\sigma}=\frac{\partial \psi}{\partial \varepsilon^e}=(1-a d)^2 \operatorname{Ktr}\left(\boldsymbol{\varepsilon}^{\mathrm{e}}\right) \bb{I}+(1-d)^2 2 \mu \boldsymbol{\varepsilon}_{\mathrm{dev}}^{\mathrm{e}}
%\end{equation}
%\begin{equation}
%a= \begin{cases}1 & \text { if } \operatorname{tr}\left(\boldsymbol{\varepsilon}^{\mathrm{e}}\right)>0 \\ 0 & \text { else } \end{cases}
%\end{equation}


%\subsubsection{Elasto-plastic model}

%The return mapping algorithm which employs the logarithmic (Hencky strain) is employed as laid out in Chapter 3. The standard von Mises yield function is given by
%\begin{equation}
%\mathrm{F}=\tau_{\mathrm{eq}}-\sigma_{\mathrm{y}}
%\end{equation}
%As previously mentioned, this formulation leads to an unphysical material response when coupled with the phase field model. As the material degrades, the elastic response pulls the stress back within the yield surface, leading to the material failure being preceded by an elastic response. As noted by \citet{borden_phase-field_2016} however, it has been observed experimentally that failure is preceded by plastic strain for ductile materials. In order to account for this behaviour, 

Finally, the isotropic $J_2$ yield function (Equation \ref{eq:yieldFunc}) is modified as \citep{borden_phase-field_2016}
%The plastic degradation function $g_p(d)$ is incorporated by \citet{borden_phase-field_2016} into the yield function:
\begin{equation}
%	\mathrm{F}=\tau_{\mathrm{eq}}-g_p(d)\sigma_y
	\Phi = \sigma_{v}' \; - \; (1 - d^2) \, \sigma_y\left(\bar{\varepsilon}_p \right)
\end{equation}
where 
\begin{eqnarray}
	\sigma_{v}' &=& \sqrt{\sfrac{3}{2} \, \bb{s}' : \bb{s}'} \\
%	\tau_{eq}=\sqrt{\frac{3}{2} \boldsymbol{\tau}_d:\boldsymbol{\tau}_d}
	\boldsymbol{s}' &=& (1 - d^2)\, 2 \mu \, \text{dev}\left(\bb{\varepsilon}_{e}\right)
\end{eqnarray}
%\begin{equation}
%	\boldsymbol{\tau}_d=g_{\mathrm{e}}(d)\ 2 \mu \, \text{dev}\left(\bb{\varepsilon}_{e}\right)
%	%\boldsymbol{\tau}_d= (1 - d^2)\, 2 \mu \, \text{dev}\left(\bb{\varepsilon}_{e}\right)
%\end{equation}

Similar to the non-local equations in the Lemaitre and GTN models, in this work, the phase field equation (Equation \ref{eqn:phaseFieldEquation}) is discretised using the described cell-centred finite volume method, and zero-flux Neumann boundary conditions.
To facilitate the cell-centred finite volume method, we express the phase field equation in integral form:
\begin{eqnarray}
	%\frac{G_c}{2l} \left(d - 4 l^2 \bb{\nabla}^2 d \right) = \mathcal{H} \\
	\underbrace{ \int_{\Omega_u} d \, d \Omega_u }_{\text {implicit}}
	- \underbrace{ \oint_{\mathrm{\Gamma}_u}  \bb{n}_u \cdot \left(  4 l^2 \nabla d \right) \,  d\mathrm{\Gamma}_u }_{\text {implicit}}
	 &=&  \underbrace{ \int_{\Omega_u} \frac{2l}{G_c} \mathcal{H} \, d \Omega_u }_{\text {explicit}}
\end{eqnarray}
where both sides have been multipled by $\frac{2l}{G_c}$ and the divergence theorem has been used to express the diffusion term (second on the left-hand side) in terms of a surface integral.

This equation is applied to each cell and discretised in the same fashion as described for the the non-local damage equation (Equation \ref{eqn:nonLocalEquationIntegral}), where the terms on the left-hand side are discretised implicitly and the term on the right is treated in a deferred correction manner.
The resulting algebraic equation for each computational cell becomes:
\begin{eqnarray}
	\left(
		\Omega_{u_P}
		+ \sum_{f \in N_f}
		\frac{4 l^2 \left|\boldsymbol{\Delta}_{u_f} \right| \left| \bb{\Gamma}_{u_f} \right|}{\left|\bb{d}_f\right|}
	\right) d_P
	- \sum_{f \in N_f}
	\frac{4 l^2 \left|\boldsymbol{\Delta}_{u_f}\right| \left|\bb{\Gamma}_{u_f} \right|}{\left|\bb{d}_f\right|} d_{N_f}
	&=&
	\frac{2l}{G_c} \mathcal{H} \Omega_{u_P}
	+ \sum_{f \in N_f} l_c^2 \; \bb{k}_{u_f} \cdot   \left(  \boldsymbol{\nabla} d   \right)_f   \left|\bb{\Gamma}_{u_f}\right| \notag \\
\end{eqnarray}
in terms of the unknown phase field variable at the centres of cell $P$ and the neighbouring cells $N_f$.
Like in the case of the non-local damage equation, this algebraic equation is formed for each cell in the mesh and assembled into a system of linear equations, which is iteratively solved once per outer (Picard) iteration.



\subsubsection{Computational Procedure}

%%As has been previously described, the displacement field is solved at each iteration using the stress field calculated from the return mapping scheme. This displacement field is then used to find a new value for the stress from the material model return mapping scheme. This iterative procedure continues until convergence is achieved. For each cell, we are given the incremental displacement field for the current time step $t^{[m+1]}$, at the current outer iteration, denoted by $\Delta \bb{u}^{[m+1]}_{[i+1]}$. The values of the following variables from the previous time step $t^{[m]}$ are also provided:
%%\begin{equation}
%%\left\{\bb{F}_n^p, \bar{\varepsilon}^p_n, d_n\right\}
%%\end{equation}
%%The goal is then for the algorithm to obtain the following variables at time $t^{[m+1]}$
%%\begin{equation}
%%\left\{\bb{F}^{[m+1]}_p, \bar{\varepsilon}_p^{[m+1]},\boldsymbol{\sigma}^{[m+1]}, d^{[m+1]}\right\}
%%\end{equation}
%%
%%In order to obtain these values, the algorithm must satisfy the following constitutive behaviour:
%%\begin{equation}
%%\dot{\boldsymbol{F}}^p \boldsymbol{F}^{p-1}=\dot{\gamma} \boldsymbol{R}^{e T} \frac{\boldsymbol{\tau}_d}{\tau_{eq}} \boldsymbol{R}^e=\overline{\boldsymbol{d}}^p 
%%\end{equation}
%%
%%\begin{equation}
%%\dot{\bar{\varepsilon}}^p=\dot{\gamma}
%%\end{equation}
%%Subject to the Kuhn-Tucker conditions 
%%\begin{equation}
%%\left\{\begin{array}{c}
%%\dot{\gamma}=\geq 0 \\
%%F_p\geq 0 \\
%%\dot{\gamma}F_p=0
%%\end{array}\right.
%%\end{equation}
%
%At each iteration, after the plasticity has been solved for each volume, the phase field crack variable $d$ is solved for globally (equation \ref{eqn:phaseFieldEquation}).
%
%Using the procedure outlined in section 3.2.3, the system of equations to be solved for when the material is undergoing plastic straining is given as: 
%\begin{equation}
%\left\{\begin{array}{c}
%F_p=\tau_{eq\ n+1} - g_p(d)\sigma_y\left(\bar{\varepsilon}_p^{[m+1]}\right)=0 \\
%\boldsymbol{\varepsilon}^{[m+1]}_e=\boldsymbol{\varepsilon}^{[m+1]}_{trial}-\frac{3}{2} \Delta \gamma \frac{\boldsymbol{\tau}^{[m+1]}}{\tau_{eq\ n+1}} \\
%\bar{\varepsilon}_p^{[m+1]}=\bar{\varepsilon}^p_n+\Delta \gamma
%\end{array}\right.
%\end{equation}
%These equations are satisfied by solving equation \ref{eqn:phaseFinal} using the Newton-Raphson method
%\begin{equation}
%\label{eqn:phaseFinal}
%q^{[m+1]}_{\text {trial }}-g_{\mathrm{p}}(d) 3 \mu \Delta \gamma-g_{\mathrm{p}}(d) \sigma_y\left(\bar{\varepsilon}^p{ }_n+\Delta \gamma\right)=0
%\end{equation}

Like the Lemaitre and GTN procedures, a deferred-correction procedure is adopted here to incorporate the phase (damage) evolution equation.
Within each outer iteration, the elastoplastic quantities are calculated using the latest available phase field variable $d^{[m+1]}_{[i]}$ from the previous outer iteration $i$.
Subsequently, the phase field equation (Equation \ref{eqn:phaseFieldEquation}) is solved using the latest available stress and strain fields.
The algorithm for the phase field stress calculation procedure is given in Appendix \ref{app:stressCalcAlg}. %Algorithm \ref{alg:phaseField}.















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Benchmark Cases} \label{sec:test_cases}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This section assesses the performance of the developed finite volume procedures on two benchmark test cases: (i) a 2-D axisymmetric notched round bar and (ii) a 3-D flat notched bar. %and (iii) 2-D axisymmetric wire drawing.
In both cases, a region of localised plastic strain develops at the centre of the specimen, but the levels of triaxiality experienced differ.
The cases are presented simultaneously rather than sequentially to allow easier comparison of the material models.

%The effect of the Rhie-Chow scale factor $\mathcal{R} is studied in Section \ref{sec:RhieChow}
%A global momentum Rhie-Chow scale factor $\mathcal{R} = 0.01$ was used unless stated otherwise, and the pressure Rhie-Chow scale factor was $\mathcal{R}_p = 10^3$.

%\hl{Update:} All simulations were run in parallel on eight CPU cores (Intel Xeon 6152).

Comparisons are made with predictions from previously developed procedures, finite element software Abaqus and results from the literature.
In the Abaqus models, linear interpolation functions are used (Abaqus element code \texttt{C3D8T} for 3-D and \texttt{CAX4RT} for axisymmetry).
For reference, single-cell verifications of the proposed material models are provided in Appendix \ref{app:one_cell}.
% providing confidence that the constitutive laws are implemented as intended.

%- refer to one element tests in the literature.
%- three cases
%- for each: geom, mesh, loading, materials, results, discussion
%- Case showing the effect of Rhie-Chow
%- Case showing the effect of new Lematire model

%In this section, simulations of displacements being applied to a notched round bar (NRB) and a flat notched bar (FNB) are conducted in Abaqus and OpenFOAM with results compared to each other as well as to results in the literature.

% to mitigate its effect on damage localisation behaviour}
% (the effect of the Rhie-Chow method will be explored in more detail in chapter 6).
%Linear (first-order) interpolation is used in the finite volume and finite element simulations with C3D8T and CAX4RT elements used in Abaqus for the three-dimensional and axi-symmetric simulations respectively.
%The following simulations in this work for a notched round bar and a flat notched bar were performed in parallel on the UCD Sonic High Performance Computing (HPC) cluster, utilizing 8 processors.


%%%%%%%%%%%
\subsection{Geometries and Meshes}
%%%%%%%%%%%
The notched round bar (Figure \ref{fig:notched_bar_geom}) has been widely used for benchmarking plasticity and damage procedures \cite{cesar_de_sa_damage_2006, fincato_return_2018, vaz_aspects_2001}.
The geometry consists of a 40 \si{\milli\meter} long round bar of diameter 18 \si{\milli\meter} with a 4 \si{\milli\meter} rounded notch.
A 2-D axisymmetric model is created, including a horizontal symmetry plane, where a graded structured quadrilateral mesh is employed (Figure \ref{fig:notched_bar_mesh}).

%\begin{figure}[htb] \label{fig:notched_bar_geom}
%\begin{center}
%	\includegraphics[width=0.4\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/axiNotchedCase.png}
%\caption{Geometry of the notched round bar}
%\end{center}
%\end{figure}

\begin{figure}[htbp]
	\centering
%		\subfigure[8000 cell mesh] {\label{airbus}\includegraphics[width=0.1\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/axiNotchedMeshBW.png}}
		\subfigure[Geometry and solution domain (in grey). Adapted from \citet{cesar_de_sa_damage_2006}.]
		{
			\label{fig:notched_bar_geom}
			\includegraphics[height=0.5\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/axiNotchedCase2}
		} \quad
		\subfigure[Mesh with 8,000 cells]
		{
			\label{fig:notched_bar_mesh}
			\includegraphics[height=0.5\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/axiNotchedMesh2}
		}
%		\includegraphics[width=0.1\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/axiNotchedMeshBW.png}
		
%		\subfigure[Marked cell in pink where results are analysed] {\label{boeing} \includegraphics[width=0.3\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/markedCellAxi.png}}
		
		\caption{Notched round bar geometry and mesh}
	\label{fig:notched_bar_geom_mesh}
\end{figure}


The 3-D flat notched tensile specimen (Figure \ref{fig:flat_bar_geom}) is another common test case for assessing damage models \citep{borden_phase-field_2016, eldahshan_phase_2021}.
The 3-D geometry comprises a $152.4 \times 25.4 \times 2.37$ mm plate with 4.06 mm diameter side notches.
The solution domain comprises one-eighth of the specimen by exploiting three symmetry planes.
A graded structured hexahedral mesh is employed with 10,000 hexahedral cells (Figure \ref{fig:flat_bar_mesh}).

The mesh spacing and time-step size have been chosen so that spatial and temporal discretisation are small for all cases.

%\begin{figure}[htb] \label{fig:flat_bar_geom}
%\begin{center}
%	\includegraphics[width=0.3\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/flatNotchedTensile.png}
%\caption{Geometry of the flat notched bar}
%\end{center}
%\end{figure}

\begin{figure}[htbp]
	\centering
		\subfigure[Geometry and solution domain (in grey)]
		{
			\label{fig:flat_bar_geom}
			\includegraphics[height=0.6\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/flatNotchedTensile2}
		} \quad
		\subfigure[Mesh with 10,000 cells]
		{
			\label{fig:flat_bar_mesh}
			\includegraphics[height=0.6\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/flatNotchedTensileMesh}
		}
%		\subfigure[Marked cell in pink where results are analysed]
%		{
%			\label{boeing}
%			\includegraphics[width=0.3\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/bordenCell.png}
%		}
		
		\caption{Flat notched bar geometry and mesh}
	\label{fig:flat_bar_geom_mesh}
\end{figure}




\subsection{Loading Conditions}

For both cases, an axial displacement of $1.0$ mm is quasi-statically applied to the upper boundary over 1 s, resulting in a total elongation of $2$ mm applied to the entire sample when accounting for the symmetry planes (Figures \ref{fig:notched_bar_geom_mesh} and \ref{fig:flat_bar_geom_mesh}).
%For the elastoplastic cases without damage, a displacement increment size of $0.01$ mm is used, whereas a smaller increment size of $0.001$ mm is used for the cases with damage.
The loading is applied over 1000 equal loading steps, resulting in a time step size of 1 ms.
A global Rhie-Chow stabilisation factor of $\mathcal{R} = 0.01$ is used for all cases unless stated otherwise; the effect of this term is examined in Section \ref{sec:RhieChowResults}.
It was found that the pressure equation approach described in Section \ref{sec:pressureApproach} was not required for the benchmark cases presented in this section, as pressure oscillations were not present.

% For the elastoplastic cases without damage, a displacement increment size of $0.01$ mm is used, whereas a smaller increment size of $0.001$ mm is used for the cases with damage.
%A displacement of $0.8\ mm$ is applied to the top boundary of the NRB specimen, with 800 time steps used in these simulations corresponding to displacement increments of $0.001\ mm$.

%\hl{remove this paragraph: we might as well use the same displacement}
%For the flat notched bar case, a vertical displacement of $1.143$ mm is quasi-statically applied to the upper boundary.
%\hl{why such a strangely specific number?} \hl{why not 1 mm?}
%% over 100 quasi-static loading steps, corresponding to 0.01143 \si{\milli\meter} increments.
%In the elastoplastic cases, displacement increments of $0.01143$ m are applied, and in the damage cases, displacement increments of $0.001143$ m are applied.

% by default in this case until the rapid loss of load-carrying capacity is observed.
For the Abaqus finite element cases, an adaptive time-stepping procedure was employed, with a maximum time increment size of $1$ ms and a minimum of $0.001$ ms.
% increment of $0.01143$ mm.
%From the result data, it seems that abaqus was run with a fix step of 10 ms for no damage and 1 ms for damage. We could use this in OF for easy comparison. running and check with Andrew.

%\hl{we can easily add a plot of the number of outer iterations}



\subsection{Plasticity Model Verification} \label{PlasticityTestCases}

Before verifying the damage and fracture models, the implementation of the described plasticity model is verified by comparison with three other procedures:
\begin{enumerate}[label=(\alph*)]
	\item The approach of \citet{clancy_improving_2019} implemented in OpenFOAM that uses the logarithmic strain and the Mandel stress \cite{caminero_modeling_2011};
	\item The approach of \citet{cardiff_lagrangian_2017} implemented in OpenFOAM, which uses the Green strain tensor (left Cauchy–Green deformation tensor) and the return mapping algorithm described by \citet{simo_computational_1998};
	\item The default approach in the finite element software Abaqus, which is based on the Jaumann stress rate.
\end{enumerate}

%Verification consists of examining the reaction forces at the loading boundary and the equivalent plastic strain $\bar{\varepsilon}_p$, equivalent stress $\sigma_v$, hydrostatic pressure $p$ and axial stress $\sigma_{yy}$ (stress in the loading direction) at the centre of the notched round bar and at the coordinate $(7.02\ 0\ 0)$ mm for the flat notched bar, where the origin is the geometric centre and the first coordinate is in the direction of the notch.
Verification consists of examining the reaction forces at the loading boundary and the equivalent plastic strain $\bar{\varepsilon}_p$ at the centre of the notched round bar and the coordinate $(7.02\ 0\ 0)$ mm for the flat notched bar, where the origin is the geometric centre and the first coordinate is in the direction of the notch.
These locations have been chosen as the damage is greatest here in the later test cases.

%  discrepancy is unrelated to the time-step or mesh size discretisation error.
%Throughout this chapter, relatively fine meshes and small time steps are used to ensure that this form of error is negligible.


%These simulations are conducted using the material properties described in Tables 5.5 and 5.6.


%A displacement of $1.0\ mm$ is applied to the top boundary of the notched round bar specimen, with 100 time steps used in this simulation corresponding to increments of $0.01\ mm$. 
%
%A displacement of $1.143\ mm$ is applied to the top boundary of the flat notched bar specimen, with 100 time steps used in this simulation corresponding to increments of $0.01143\ mm$. 

\subsubsection{Material Parameters}

The elastoplastic material parameters for the notched round bar are given in Table \ref{tab:notched_bar_mat}, while the parameters for the flat notched bar are given in Table \ref{tab:flat_bar_mat}.
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
			Property & Symbol & Value  & Units \\ \hline 
			Young's modulus & $E$ & $69$ & GPa \\
			Poisson's ratio & $v$ & $0.3$  & - \\
			Hardening law & $\sigma_y$ & $589({10^{-4}+\bar{\varepsilon}}_p)^{0.216}$ & MPa  \\
			\hline
		\end{tabular}
	\caption{Material properties for the notched round bar case}
	\label{tab:notched_bar_mat}
\end{table}
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
			Property & Symbol & Value & Units  \\ \hline 
			Young's modulus & $E$ & $68.8$ & GPa \\
			Poisson's ratio & $v$ & $0.33$   & -\\
			Hardening law & $\sigma_y$ & $320+688\bar{\varepsilon}_p$ & MPa  \\
			\hline
		\end{tabular}
	\caption{Material properties for the flat notched bar case}
	\label{tab:flat_bar_mat}
\end{table}

%\hl{We could report run times and number of outer iterations, e.g. elastic vs plastic steps}
% OK: leave it out and see if a reviewer requests it.


\subsubsection{Reaction Forces}

The predicted reaction forces at the loading boundaries (Figures \ref{fig:plastic_forces}) align closely between all approaches, showing the forces and displacements for half the domain.
It is worth noting that the reaction forces for both the \citet{clancy_improving_2019} implementation and the implementation in this work (which both use the logarithmic strain) are slightly less than the \citet{cardiff_lagrangian_2017}  and Abaqus predictions in the latter stages of the deformation.
These differences have been found to remain as the mesh spacing and time step are reduced, ruling out discretisation error as the cause.
Although the reason for these subtle differences is unclear, the lack of mathematical equivalence between the logarithmic and Green/Jaumann strain approaches may be the cause.
Similarly, the use of the Jaumann objective rate in Abaqus \cite{soyarslan_finite_2010} may also contribute to the subtle differences, as it is known to exhibit unphysical stress oscillations at large shear deformations.
Although it is outside the scope of the current study, implementing a similar Jaumann rate formulation in OpenFOAM is one approach for checking this hypothesis.
For the purposes of benchmarking in the current work, these subtle differences are considered acceptable.
%in contrast to the logarithmic and Green strain approaches used in OpenFOAM.
\begin{figure}[htbp]
	\centering
		\subfigure[Notched round bar]
		{
			\label{airbus}\includegraphics[height=0.45\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/forceDispAxi2}
		}
		\subfigure[Flat notched bar]
		{
			\label{airbus}\includegraphics[height=0.44\textwidth]{./Figures/finiteVolumeImplementation/inhomogenousDeformation/forceDispFlat2}
		}
		\caption{Reaction forces at the upper loading boundary for the notched round bar and flat notched bar cases compared with predictions from the methods of \citet{cardiff_lagrangian_2017}, \citet{clancy_improving_2019} and finite element software Abaqus}
	\label{fig:plastic_forces}
\end{figure}
\FloatBarrier



\subsubsection{Plastic Strains}

%The results at the centroid of a chosen cell (marked in pink in Figures 5.9 and 5.10) are here compared for the implementation of this work, the \citet{cardiff_lagrangian_2017} implementation and the results from Abaqus.
The equivalent plastic strain predictions at the points of interest agree for all approaches (Figure \ref{fig:eqPlasticStrainPlasticity}), with the values being marginally greater in the later stages for the finite volume (OpenFOAM) simulations compared with the Abaqus predictions.
The equivalent plastic strain value is seen to increase smoothly in the notched round bar case (Figure \ref{fig:eps_round_bar}), whereas there is an initial elastic region followed by a steeper slope in the flat notched bar case (Figure \ref{fig:eps_flat_bar}).
Once again, the cause of the subtle differences in the latter stages is unclear but may be attributed to the mathematical differences between the logarithmic, Green and Jaumann strain approaches.
%It is unclear exactly why this difference (or other small differences which will be encountered) later in the chapter exists, though it could be related to the fact that in Abaqus the Jaumann rate is used to update the stress tensor \cite{soyarslan_finite_2010}, unlike in OpenFOAM.
\begin{figure}[htbp]
%\begin{center}
%	\includegraphics[width=0.4\textwidth]{./Figures/plasticityCompare/axiCompare/disp_EpsPEq.png}
%	\caption{Equivalent plastic strain vs. displacement}
%	\label{fig:eqPlasticStrainNotchedRoundBar}
%\end{center}
	\centering
		\subfigure[Notched round bar]
		{
			\includegraphics[width=0.45\textwidth]{./Figures/plasticityCompare/axiCompare/disp_EpsPEq3}
			\label{fig:eps_round_bar}
		}
		\subfigure[Flat notched bar] 
		{
			\includegraphics[width=0.45\textwidth]{./Figures/plasticityCompare/bordenCompare/disp_EpsPEq3}
			\label{fig:eps_flat_bar}
		}
	\caption{Equivalent plastic strain at the specimen centres for the notched round bar and flat notched bar cases}
	\label{fig:eqPlasticStrainPlasticity}
\end{figure}


%\subsubsection{Notched round bar}

%Similarly, the predictions for equivalent stress $\sigma_v$, hydrostatic pressure $p$, and axial stress (stress in the loading direction) $\sigma_{yy}$ are shown to agree for the different approaches (Figure \ref{fig:stressStrainCentre}).
%Of particular note is the pressure distribution, which is smooth and does not show numerical oscillations, providing confidence in the proposed pressure smoothing approach (Section \ref{sec:pressureApproach}).
%%For the NRB, the cells' results at the centre of the specimen are compared (Figure 5.9).
%%This cell is chosen because it is where fracture initiates for both the Lemaitre and GTN model simulations that will be encountered later in this chapter. 
%%For the FNB, results are shown for the cell that is $6.912\ mm$ to the right of the centre of this specimen.
%%This cell is chosen because it is where fracture initiates for the Lemaitre model (Figure 5.10).
%\hl{Images of stress distributions may be better here} \hl{point values are already shown above}
%\begin{figure}[htbp]
%	\centering
%		\subfigure[Notched round bar: Equivalent stress $\sigma_v$ vs displacement]
%		{\includegraphics[width=0.45\textwidth]{./Figures/plasticityCompare/axiCompare/disp_sigmaEq.png}}
%		\subfigure[Flat notched bar: Equivalent stress $\sigma_v$ vs displacement]
%		{\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/plasticityCompare/bordenCompare/disp_sigmaEq.png}}
%		
%		\subfigure[Notched round bar: Pressure $p$ vs displacement] 
%		{\includegraphics[width=0.45\textwidth]{./Figures/plasticityCompare/axiCompare/disp_Pressure.png}}
%		\subfigure[Flat notched bar: Pressure $p$ vs displacement] 
%		{\includegraphics[width=0.45\textwidth]{./Figures/plasticityCompare/bordenCompare/disp_Pressure.png}}
%		
%%		\subfigure[Notched round bar: Axial stress $\sigma_{yy}$ vs displacement] 
%%  		{\includegraphics[width=0.45\textwidth]{./Figures/plasticityCompare/axiCompare/disp_sigmaYY.png}}
%%		\subfigure[Flat notched bar: Axial stress $\sigma_{yy}$ vs displacement] 
%%		{\includegraphics[width=0.45\textwidth]{./Figures/plasticityCompare/bordenCompare/disp_sigmaYY.png}}
%				
%		\caption{Stress and Strain Quantities at the Centre of the notched round bar and flat notched bar specimens}
%	\label{fig:stressStrainCentre}
%\end{figure}
%\FloatBarrier




%\subsubsection{Flat notched bar}

%For the FNB, results are shown for the cell that is $6.912\ mm$ to the right of the centre of this specimen. This cell is chosen because it is where fracture initiates for the Lemaitre model (Figure 5.10).

%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.3\textwidth]{./Figures/plasticityCompare/bordenCompare/disp_EpsPEq.png}
%\caption{Equivalent plastic strain vs. displacement}
%\label{fig:notchedRoundBAr}
%\end{center}
%\end{figure}


%\begin{figure}[htbp]
%	\centering
%		\subfigure[Equivalent stress vs. displacement] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/plasticityCompare/bordenCompare/disp_sigmaEq.png}}
%		
%		\subfigure[Pressure vs. displacement]
%		{\includegraphics[width=0.3\textwidth]{./Figures/plasticityCompare/bordenCompare/disp_Pressure.png}}
%		
%		\subfigure[Sigma YY vs. displacement]
%		{\includegraphics[width=0.3\textwidth]{./Figures/plasticityCompare/bordenCompare/disp_sigmaYY.png}}
%		
%		\caption{Comparison of stress state}
%	\label{label_for_entire_figure}
%\end{figure}




\subsection{Lemaitre Model}
We now move on to verifying the damage procedures, starting with the Lemaitre model.
%As the elastoplasticity procedure has been verified, the notched round and flat bar test cases are examined using the proposed damage models.
Comparisons are given against results from the literature and those generated using Abaqus.

%A displacement of $0.8\ mm$ is applied to the top boundary of the NRB specimen, with 800 time steps used in these simulations corresponding to displacement increments of $0.001\ mm$.

\subsubsection{Material Parameters}

The Lemaitre material parameters for the notched round bar case, taken from \citet{cesar_de_sa_damage_2006}, are given in Table \ref{table:NRB_material_properties_lemaitre}, while the Lemaitre material parameters for the flat notched bar case are given in Table \ref{table:FNB_material_properties_lemaitre}.
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
			Property & Symbol & Value & Units \\ \hline 
			Young's modulus & $E$ & $69.9$ & GPa \\
			Poisson's ratio & $v$ & $0.3$  & - \\
			Damage denominator & $S_0$ & $1.1$ & MPa  \\
			Damage exponent & $b$ & 1.0 & - \\
			Critical damage & $D_c$ & 0.99 & - \\
			Characteristic length & $l_c$ & $0.6325$ & mm  \\
			Hardening law & $\sigma_y$ & $589({10^{-4} +\bar{\varepsilon}}_p)^{0.216}$ & MPa \\
			\hline
		\end{tabular}
	\caption{Lemaitre material parameters for the notched round bar case}
	\label{table:NRB_material_properties_lemaitre}
\end{table}
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
			Property & Symbol & Value & Units  \\ \hline 
			Young's modulus & $E$ & $68.9$ & GPa \\
			Poisson's ratio & $v$ & $0.33$  & - \\
			Damage denominator & $S_0$ & $0.5$ & MPa  \\
			Damage exponent & $b$ & 1.0 & -  \\
			Critical damage & $D_c$ & 0.99 & - \\
			Characteristic length & $l_c$ & $0.6325$ & mm  \\
			Hardening law & $\sigma_y$ & $320+688 \, \bar{\varepsilon}_p$ & MPa \\
			\hline
		\end{tabular}
	\caption{Lemaitre material parameters for the flat notched bar case}
	\label{table:FNB_material_properties_lemaitre}
\end{table}


\subsubsection{Reaction Forces}
Comparing the current (OpenFOAM) implementation and Abaqus reaction force predictions (Figure \ref{fig:lemaitre_forces}), the current work and Abaqus predictions can be seen to agree closely. 
%This has been encountered earlier in the comparison of the equivalent plastic strain in section 5.3.2. The marginally faster increase of the equivalent plastic strain and damage results in a slightly quicker loss of load-carrying capacity for the specimen, as shown in Figure 5.18.
The Abaqus simulations struggled to converge in the rapid crack propagation stage of the flat notched bar case, requiring very small time increments until it eventually crashed before reaching the end time.
%of $~0.463$ mm.
In contrast, convergence issues were not encountered with the current segregated, finite-volume OpenFOAM simulations.
The reason for this difference in convergence behaviour is unclear, but it may stem from the different solution algorithms employed (Newton-Raphson vs. Picard).
The Newton-Raphson approach used in Abaqus requires the calculation of the tangent stiffness matrix.
For elastoplastic damage models, plastic deformation influences the onset and progression of damage and vice versa.
This interaction can result in a significant coupling in the tangent stiffness matrix, manifesting as non-trivial off-diagonal terms \cite{bathe_finite_1996}, potentially leading to convergence difficulties.
\begin{figure}[htbp]
	\centering
		\subfigure[Notched round bar]
		{
			\includegraphics[height=0.35\textwidth]{./Figures/LemaitreCompare/axiCompare/1.1LemaitreCompare3}
		}
		\subfigure[Flat notched bar]
		{
			\includegraphics[height=0.345\textwidth]{./Figures/LemaitreCompare/borden/bordenDispForce3}
		}
		\caption{Reaction force predictions using the Lemaitre damage model}
	\label{fig:lemaitre_forces}
\end{figure}


\subsubsection{Damage and Plastic Strains}
Similar to the forces, the local values for damage and equivalent plastic strain can be seen to closely agree between the current work and Abaqus (Figures \ref{fig:lemaitre_point_values_axi} and \ref{fig:lemaitre_point_values_flat}).
Nonetheless, upon examining the figures closely, the damage and plastic strain in the current work increase slightly quicker than those in Abaqus.
This effect can also be observed when viewing the reaction forces (Figure \ref{fig:lemaitre_forces}) in the previous section.
The reason for this is unclear but could be related to the differences in plasticity model formulation, as noted above.
\begin{figure}[htbp]
	\centering
		\subfigure[Non-local damage vs displacement]
		{
			\includegraphics[width=0.4\textwidth]{./Figures/LemaitreCompare/axiCompare/disp_damageNonLocal4}
		}
		\subfigure[Equivalent plastic strain vs displacement]
		{
			\includegraphics[width=0.4\textwidth]{./Figures/LemaitreCompare/axiCompare/disp_EpsPEq3}
		}
	\caption{Damage and plastic strain predictions for the notched round bar case using the Lemaitre model}
	\label{fig:lemaitre_point_values_axi}
\end{figure}
\begin{figure}[htb]
	\centering
		\subfigure[Non-local damage vs displacement]
		{
			%\label{airbus}
			\includegraphics[width=0.4\textwidth]{./Figures/LemaitreCompare/borden/disp_damageNonLocal2}
		}
		\subfigure[Equivalent plastic strain vs displacement]
		{
			%\label{boeing}
			\includegraphics[width=0.41\textwidth]{./Figures/LemaitreCompare/borden/disp_EpsPEq2}
		}
	\caption{Damage (non-local) and plastic strain predictions for the flat notched bar case using the Lemaitre model}
	\label{fig:lemaitre_point_values_flat}
\end{figure}

For the notched round bar case, Figure \ref{fig:lemaitre_damage_field} compares the predicted non-local damage distribution at a loading displacement of $1.2$ mm with the predictions provided in \citet{cesar_de_sa_damage_2006}, where the results are displayed on the initial mesh.
Qualitative agreement can be observed between the distributions and values, allowing for the differences in the colour palettes.
\begin{figure}[htbp]
	\centering
		\includegraphics[height=0.4\textwidth]{./Figures/LemaitreCompare/axi_lemaitre_compare}
%		\subfigure[OpenFOAM simulation]
%		{
%			\includegraphics[height=0.4\textwidth]{./Figures/LemaitreCompare/nlDamageLemaitre.png}
%		}
%		\qquad
%		\subfigure[Results from \citet{cesar_de_sa_damage_2006}]
%		{
%			\includegraphics[height=0.4\textwidth]{./Figures/LemaitreCompare/updated_deSaNonLocal2}
%		}
		\caption{Comparison of non-local damage distribution in the notched round bar case using the Lemaitre model at a total displacement of 1.2 mm. Predicted from the current work are on the left, while results from \citet{cesar_de_sa_damage_2006} are on the right. The results are displayed on the initial mesh.}
	\label{fig:lemaitre_damage_field}
\end{figure}




%\subsubsection{Lemaitre model: Abaqus vs. OpenFOAM}

%In this sub-section results from the OpenFOAM and Abaqus implementations of the non-local gradient Lemaitre model are compared.




%\textbf{Flat notched bar}

%Simulations are also performed on the flat notched bar case. Displacement increments of $0.001143\ mm$ are applied by default in this case until the rapid loss of load-carrying capacity is observed.
%For the Abaqus case, the option was given for the simulation to use displacement increments as small as $0.00001143\ mm$, via the adaptive time stepping scheme available in this software.


%It is clear from Figure 5.19 that the results align well.



\subsubsection{Effect of the $S_0$ Parameter}
The flat notched bar simulations are repeated here for different values to demonstrate the effect of the material damage parameter $S_0$.
As the value of $S_0$ increases, rapid crack propagation occurs later in the deformation process.
In Figure \ref{fig:vary_S0}, the current work and Abaqus simulations are seen to be in agreement up to the point of early termination of the Abaqus models.
%The discrepancies between OpenFOAM and Abaqus simulations are larger the later in the deformation process that fracture occurs, although a full comparison is not possible due to the early termination of the Abaqus models.
\begin{figure}[htb]
\begin{center}
	\includegraphics[width=0.5\textwidth]{./Figures/LemaitreCompare/borden/lemaitreBordenCompare2}
\caption{Force vs. displacement for different values of the Lemaitre parameter $S_0$ on the flat notched bar case. The forces and displacements are shown for the half model.}
\label{fig:vary_S0}
\end{center}
\end{figure}




\subsubsection{Effect of the Rhie Chow Stabilisation Term} \label{sec:RhieChowResults}
This section explores the effect of the Rhie-Chow stabilisation term (Section \ref{sec:RhieChowStab}) by examining its impact on the predicted force-displacement curves for the notched round bar and flat notched bar cases.

%, where the Rhie-Chow stabilisation term is independently changed as follows:
%\begin{enumerate}[label=(\alph*)]
%	\item The Rhie-Chow global scale factor $\mathcal{R}$ is varied from 0.01 to 0.2;
%	%\item The effect of loading (time) step size
%	\item The Rhie-Chow field is scaled as a function of the damage variable according to $\mathcal{R} (1-D)^2$.
%\end{enumerate}

To get insight into its effect, the Rhie-Chow global scale factor $\mathcal{R}$ is varied from 0.01 to 0.2 (Figure \ref{fig:vary_RC_global}).
As the Rhie-Chow global scale factor $\mathcal{R}$ is decreased, a greater level of localisation is predicted to occur.
In contrast, as the scale factor increases, a greater smoothing is seen in the force-displacement trace.
As the purpose of the Rhie-Chow term is to smooth out oscillations in the solution field, it is perhaps unsurprising that it tends to quell physical localisations due to damage.
The predictions for the notched round bar (Figure \ref{fig:vary_RC_global}(a)) are seen to be less sensitive than in the flat notched bar case (Figure \ref{fig:vary_RC_global}(b).
This difference can be explained by the increased damage localisation in the latter stages of the flat-notched bar case.
\begin{figure}[htbp]
	\centering
		\subfigure[Notched round bar]
		{
		\includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/0.015_forceDispNonLocalLemaitreAxi.png}
		}
		\subfigure[Flat notched bar]
		{
		\includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/0.015_forceDispBordenNonLocalLemaitre.png}
		}
	\caption{Force vs displacement predictions using the Lemaitre model where the Rhie-Chow global scale factor $\mathcal{R}$ is varied from 0.01 to 0.2.}
	\label{fig:vary_RC_global}
\end{figure}

These results suggest that a small value of the Rhie-Chow scale factor $\mathcal{R}$ should be used to avoid excessive smoothing in regions of localised damage.
Nonetheless, as noted in Section \ref{sec:RhieChowStab}, the Rhie-Chow term plays an important role in quelling numerical oscillations, particularly in the elastic regions where no dissipative mechanisms exist.
In addition, smaller values of the Rhie-Chow term scale factor have been found to slow the convergence of the outer Picard iterations.
Consequently, as described in Section \ref{sec:RhieChowStab}, a damage-dependent Rhie-Chow scaling field is proposed here: $\mathcal{R} (1-D)^2$.
In this case, a larger global scale factor $\mathcal{R} = 0.1$ can be used throughout the domain, which is then automatically reduced in regions where damage develops ($D > 1$).
Many forms of scaling field could be chosen, where the form examined here has been chosen to quickly (greater than linear) reduce the Rhie-Chow stabilisation as the damage variable reduces from unity.


The predicted force-displacement curves using the proposed spatially-varying approach are shown in Figure \ref{fig:RC_proposed}, where the predictions obtained using uniform global Rhie-Chow scale factors of $0.1$ and $0.01$ are given for comparison.
It can be observed that the proposed strategy reduces the effect of the Rhie-Chow scale factor on the localisation behaviour.
%when employing the Rhie-Chow scale field $\mathcal{R}_{field}$ approach.
Therefore, this scheme gains the benefits of a higher Rhie-Chow scale factor (improved convergence properties, reduction of numerical oscillations) up until crack propagation begins.
At this point, the Rhie-Chow effects are reduced; therefore, its over-smoothing effect on fracture behaviour is mitigated.
%It is noticeable that the proposed strategy leads to slightly lower reaction forces.
%This is due to the fact that by reducing the scale factor below 0.01, these residual forces that exist after the crack propagation stage are reduced.
%These residual forces are somewhat non-physical in any case, as will be discussed in the next section.
\begin{figure}[htb]
	\centering
		\subfigure[Notched round bar]
		{
			\includegraphics[width=0.45\textwidth]{./Figures/finiteVolumeCharacteristics/0.005_forceDispAxi.png}
		}
		\subfigure[Flat notched bar]
		{
			\includegraphics[width=0.45\textwidth]{./Figures/finiteVolumeCharacteristics/0.005_forceDispBorden.png}
		}
	\caption{The effect of the proposed spatially-varying Rhie-Chow scaling field on the predicted force-displacement curves, compared with uniform global scale factors of 0.01 and 0.1}
	\label{fig:RC_proposed}
\end{figure}

The effect of the Rhie-Chow stabilisation term has been shown here for the Lemaitre damage model; however, the same behaviour is seen using the GTN and phase field models.
Similarly, this effect can even be important in purely elastoplastic cases (no damage), particularly when localised plastic regions, e.g., shear bands, are present.
%To illustrate the benefit of this proposed scheme, simulations are conducted for cases a, b and c with a time-step of $0.005\ s$. Rhie-Chow scaling fields of $\mathcal{R}_{field}(D)=(1-D)^2\ 0.1$ and $\mathcal{R}_{field}(d)=(1-d)^2\ 0.1$ are used for the Lemaitre and phase field model simulations respectively.



%To explore the effect of the Rhie-Chow stabilisation term, various simulations are conducted for different values of the Rhie-Chow scale factor. The values of the Rhie-Chow scale factor used are $0.01,0.02,0.05,0.1,0.15$ and $0.2$.
%The geometry of the cases is the same as in Chapter 5.
%The cases looked at are as follows:
%\hl{Consider what to add here from comment text and figures}

%\begin{enumerate}[label=(\alph*)]
%\item Flat notched bar - non-local Lemaitre
%
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{llll} \hline
%		    %Loading Conditions \\ \hline 
%		    Applied total displacement & $u$ & $0.6\ mm$ \\
%		    Time step & $\Delta t$ & $0.015\ s$ \\
%			Displacement increment  & $\Delta u$ & $0.017145\ mm$   \\
%			\hline
%		\end{tabular}
%	\caption{Loading conditions for case a}
%	\label{tab:material_properties}
%\end{table}
%
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%			Property & Symbol & Value  \\ \hline 
%			Young's modulus & $E$ & $68.9$ GPa \\
%			Poisson's ratio & $v$ & $0.33$   \\
%			Lemaitre damage denominator & $S_0$ & $0.5$ MPa  \\
%			Lemaitre damage exponent & $b$ & 1.0  \\
%			Characteristic length & $l_c$ & $0.6325$ mm  \\
%			Hardening law & $\sigma_y$ & $320+688\times\bar{\varepsilon}^p$ MPa \\
%			\hline
%		\end{tabular}
%	\caption{Material properties for case a}
%	\label{tab:material_properties}
%\end{table}
%
%\item Round notched bar - non-local Lemaitre
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%		    %Loading Conditions \\ \hline 
%		    Applied total displacement & $u$ & $0.8\ mm$ \\
%		    Time step & $\Delta t$ & $0.015\ s$ \\
%			Displacement increment  & $\Delta u$ & $0.015\ mm$   \\
%			\hline
%		\end{tabular}
%	\caption{Loading conditions for case b}
%	\label{tab:material_properties}
%\end{table}
%
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%			Property & Symbol & Value  \\ \hline 
%			Young's modulus & $E$ & $69.9$ GPa \\
%			Poisson's ratio & $v$ & $0.3$   \\
%			Lemaitre damage denominator & $S_0$ & $1.1$ MPa  \\
%			Lemaitre damage exponent & $b$ & 1.0  \\
%			Characteristic length & $l_c$ & $0.6325$ mm  \\
%			Hardening law & $\sigma_y$ & $589({0.0001+\bar{\varepsilon}}^p)^{0.216}$ MPa \\
%			\hline
%		\end{tabular}
%	\caption{Material properties for case b}
%	\label{tab:material_properties}
%\end{table}
%
%\item Flat notched bar - phase field model
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%		    %Loading Conditions \\ \hline 
%		    Applied total displacement & $u$ & $0.41148\ mm$ \\
%		    Time step & $\Delta t$ & $0.015\ s$ \\
%			Displacement increment  & $\Delta u$ & $0.017145\ mm$   \\
%			\hline
%		\end{tabular}
%	\caption{loading conditions for case c}
%	\label{tab:material_properties}
%\end{table}
%
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%			Property & Symbol & Value  \\ \hline 
%			Young's modulus & $E$ & $68.8$ GPa \\
%			Poisson's ratio & $v$ & $0.33$   \\
%			Critical fracture energy & $G_c$ & $60\times10^3$ $J/m^2$ \\
%			Plastic threshold & $W_o$ & $1\times10^7$ MPa \\
%			Characteristic length & $l$ & $0.3226mm$    \\
%			Hardening law & $\sigma_y$ & $320+688\times{\bar{\varepsilon}}^p$ MPa  \\
%			\hline
%		\end{tabular}
%	\caption{Material properties for case c}
%	\label{tab:material_properties}
%\end{table}
%\end{enumerate}
%
%%\subsection{Results}
%
%For each of the cases, the following comparisons are made in the figures below
%\begin{itemize}
%    \item The force-displacement curves are plotted together
%    \item  Through the use of an objective function (equation 6.3), the average percentage difference between the resultant force-displacement points for a Rhie-Chow scale factor of $0.01$ are compared with those for Rhie-Chow scale factors $0.02,0.05,0.1,0.15$ and $0.05$
%\end{itemize}
%\begin{equation}
%g_0(\boldsymbol{p})=\frac{1}{N} \sum_{q=1}^N\left(\frac{R_q^{0.01}(\boldsymbol{p})-R_q^{\mathcal{R}}}{R_q^{0.01}}\right)
%\end{equation}
%
%\begin{figure}[t!]
%	\centering
%		\subfigure[Force vs. displacement] {\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/0.015_forceDispPhaseBorden.png}}
%		\qquad
%		\subfigure[\% difference vs. scale factor] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/0.015_obj_phaseBorden.png}}
%	
%	\caption{Case c - flat notched bar w) phase field fracture}
%	\label{label_for_entire_figure}
%\end{figure}
%
%It can be observed in the force-displacement curves (Figures 6.1a, 6.2a and 6.3a) that the Rhie-Chow term has the effect of slowing down the localisation behaviour of the models. In all cases, it can be seen that the rate at which the force declines with displacement is reduced with increasing Rhie-Chow scale factor. 
%
%\subsubsection{Time step dependancy}
%
%The effects of the Rhie-Cow stabilisation term are reduced with smaller time steps. To illustrate the effect this has on damage and fracture behaviour, the cases described above are conducted with varying time steps, and therefore varying displacement increments.
%
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%		    Time step ($\Delta t$) & Displacement increment ($\Delta u$) \\
%		    $0.015$ &  $0.017145\ mm$ \\
%		    $0.0125$ &  $0.0142875\ mm$ \\
%		    $0.01$ &  $0.01143 \ mm$ \\
%		    $0.0075$ &  $0.0085725 \ mm$ \\
%		    $0.005$ &  $0.005715 \ mm$ \\
%		    $0.0025$ &  $0.0028575 \ mm$ \\
%			\hline
%		\end{tabular}
%	\caption{Time steps with associated displacement increments for case a}
%	\label{tab:material_properties}
%\end{table}
%
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%		    Time step ($\Delta t$) & Displacement increment ($\Delta u$) \\
%		    $0.015$ &  $0.015\ mm$ \\
%		    $0.0125$ &  $0.0125\ mm$ \\
%		    $0.01$ &  $0.01 \ mm$ \\
%		    $0.0075$ &  $0.0075 \ mm$ \\
%		    $0.005$ &  $0.005 \ mm$ \\
%		    $0.0025$ &  $0.0025 \ mm$ \\
%			\hline
%		\end{tabular}
%	\caption{Time steps with associated displacement increments for case b}
%	\label{tab:material_properties}
%\end{table}
%
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%		    Time step ($\Delta t$) & Displacement increment ($\Delta u$) \\
%		    $0.015$ &  $0.017145\ mm$ \\
%		    $0.0125$ &  $0.0142875\ mm$ \\
%		    $0.01$ &  $0.01143 \ mm$ \\
%		    $0.0075$ &  $0.0085725 \ mm$ \\
%		    $0.005$ &  $0.005715 \ mm$ \\
%		    $0.0025$ &  $0.0028575 \ mm$ \\
%			\hline
%		\end{tabular}
%	\caption{Time steps with associated displacement increments for case c}
%	\label{tab:material_properties}
%\end{table}
%
%In Figures 6.4, 6.5 and 6.6 the force-displacement curves for various Rhie-Chow scale factors and time step $0.001s$ are displayed. Comparing these with those obtained for a time step of $0.015s$ in the previous subsection, it is evident that the Rhie-Chow term is having less of an effect on the solution. 
%
%The reduction of the effects of the Rhie-Chow term with the time-step size is further quantified in Figure 6.7. In these figures, the objective function from equation 6.3 is used to quantify the difference between the force-displacements obtained with Rhie-Chow scale factors 0.01 and 0.1 for each time step given in Tables 6.7, 6.8 and 6.9. 
%
%It is evident that for case a and case b there is a reduction in the effects of the Rhie-Chow term with decreasing time step. This relationship is a little more complicated for case c. This is likely due to the fact that by varying the time steps, we are not just altering the Rhie-Chow effects, but given the time-step dependency inherent in the finite volume method, some aspects of the solution itself are being affected.
%
%\begin{figure}[t!]
%	\centering
%		\subfigure[Force vs. displacement] {\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/0.001_forceDispBordenNonLocalLemaitre.png}}
%		\qquad
%		\subfigure[\% difference vs. scale factor] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/obj_BordenNonLocalLemaitre.png}}
%	
%	\caption{Case a - flat notched bar w) non-local Lemaitre}
%	\label{label_for_entire_figure}
%\end{figure}
%
%\begin{figure}[t!]
%	\centering
%		\subfigure[Force vs. displacement] {\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/0.001_forceDispNonLocalLemaitreAxi.png}}
%		\qquad
%		\subfigure[\% difference vs. scale factor] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/0.001_obj_nonLocalLemaitreAxi.png}}
%	
%	\caption{Case b - notched round bar w) non-local Lemaitre}
%	\label{label_for_entire_figure}
%\end{figure}
%
%\begin{figure}[t!]
%	\centering
%		\subfigure[Force vs. displacement] {\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/0.001_forceDispPhaseBorden.png}}
%		\qquad
%		\subfigure[\% difference vs. scale factor] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/0.001_obj_phaseBorden.png}}
%	
%	\caption{Case c - flat notched bar w) phase field fracture}
%	\label{label_for_entire_figure}
%\end{figure}
%
%\begin{figure}[t!]
%	\centering
%		\subfigure[\% difference vs. time step - case a] {\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/timeStep_BordenNonLocal.png}}
%		\qquad
%		\subfigure[\% difference vs. time step - case b] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/timeStep_nonLocalLemaitreAxi.png}}
%				\qquad
%		\subfigure[\% difference vs. time step - case c] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/RhieChowCompare/timeStep_phaseBorden.png}}
%	
%	\caption{Comparison of Rhie-Chow effects with time-step size}
%	\label{label_for_entire_figure}
%\end{figure}
%
%
%
%In order to illustrate the benefit of this proposed scheme, simulations are conducted for cases a, b and c with a time-step of $0.005\ s$. Rhie-Chow scaling fields of $\mathcal{R}_{field}(D)=(1-D)^2\ 0.1$ and $\mathcal{R}_{field}(d)=(1-d)^2\ 0.1$ are used for the Lemaitre and phase field model simulations respectively. The results from these simulations are compared with those obtained for Rhie-Chow scale factors of $0.1$ and $0.01$ in Figure \ref{Rhie-Chow Compare}.
%
%\begin{figure}[t!]
%	\centering
%		\subfigure[Case a] {\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/finiteVolumeCharacteristics/0.005_forceDispBorden.png}}
%		\qquad
%		\subfigure[Case b] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/finiteVolumeCharacteristics/0.005_forceDispAxi.png}}
%				\qquad
%		\subfigure[Case c] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/finiteVolumeCharacteristics/0.005_forceDispPhase.png}}
%	
%	\caption{Comparison of Rhie-Chow field approach with different Rhie-Chow scale factors}
%	\label{Rhie-Chow Compare}
%\end{figure}
%
%It can be observed that the proposed strategy reduces the effect that the Rhie-Chow scale factor has on the localisation behaviour when employing the Rhie-Chow scale field $\mathcal{R}_{field}$ approach. The benefits to a higher Rhie-Chow scale factor (improved convergence properties, reduction of "checker-boarding errors") are therefore gained using this scheme up until the point where crack propagation begins to occur. At this point, the Rhie-Chow effects are reduced and therefore, its effect on the fracture behaviour is mitigated.
%
%It is noticeable that the proposed strategy leads to lower reaction force for cases a and c (Figure \ref{Rhie-Chow Compare}). This is due to the fact that by reducing the scale factor below 0.01, these residual forces that exist after the crack propagation stage are reduced. These residual forces are somewhat non-physical in any case, as will be discussed in the next section.
%
%


%%%%
\subsubsection{Effect of the Effective Non-Local Damage Approach} \label{sec:effectiveNonLocalDamResults}
%%%%
This section examines the effect of the proposed \emph{effective} non-local damage approach introduced in Section \ref{sec:effNonLocalDam}.
The classic non-local damage approach was adopted in the sections above.
%with the critical damage parameter $D_c = 0.99$.
Here, the effective and classic non-local damage approaches are compared, where a more physically realistic critical damage parameter $D_c = 0.55$ is employed.

Figure \ref{fig:effectDamForces} shows the predicted reaction forces for the notched round bar and flat notched bar cases, where the effective non-local damage approach is compared with the classic approach.
A more physically realistic rapid crack propagation is evident in the force-displacement curve.
Such a rapid loss of load-carrying capacity at a certain point for tensile specimens has been observed experimentally \citep{li_ductile_2011, malcher_improved_2014}.
Figure \ref{fig:effectDamagPointValue} shows a similar rapid increase in the damage evolution.
It is worth noting that the maximum damage is set at $0.99$, which, combined with the Rhie-Chow diffusive effects, still leads to some nonphysical residual force-displacement behaviour in the simulations.
The benefit of the developed scheme can be further seen in Section \ref{sec:chevron_cracks}, with the model correctly predicting the development of \emph{chevron cracks} in the wire drawing process.
% (e.g. the residual force required for further displacement in Figure \ref{bordenCaseEffNL}).
%Figure %fig:lemaitre_forces
%fig:lemaitre_point_values_axi
%fig:lemaitre_point_values_flat
%Non-physical issues with the damage evolution can be observed in Figures \ref{BordenNonLocalIssue} and \ref{AxiNonLocalIssue}. 
%The benefits of this scheme can be seen in Figures \ref{axiCaseEffNL} and \ref{bordenCaseEffNL}.
%These figures show the results obtained with the novel formulation.
\begin{figure}[htbp]
	\centering
		\subfigure[Notched round bar]
		{
		\includegraphics[height=0.4\textwidth]{./Figures/effectiveNonLocalDamage/effNLDispForceAxi2}
		}
		\subfigure[Flat notched bar]
		{
		\includegraphics[height=0.4\textwidth]{./Figures/effectiveNonLocalDamage/effNLDispForceBorden2}
		}
	\caption{Reaction force predictions using the Lemaitre damage model and the effective non-local damage approach}
	\label{fig:effectDamForces}
\end{figure}
\begin{figure}[htbp]
	\centering
		\subfigure[Notched round bar]
		{
		\includegraphics[height=0.4\textwidth]{./Figures/effectiveNonLocalDamage/eff_disp_damageNonLocalAxi3}
		}
		\subfigure[Flat notched bar]
		{
		\includegraphics[height=0.4\textwidth]{./Figures/effectiveNonLocalDamage/eff_disp_damageNonLocalBorden3}
		}
	\caption{Non-local damage predictions for the notched round bar and flat notched bar cases using the Lemaitre model and the effective non-local damage approach}
	\label{fig:effectDamagPointValue}
\end{figure}

%The benefits of this scheme can be seen in Figures \ref{axiCaseEffNL} and \ref{bordenCaseEffNL}. These figures show the results obtained with the novel formulation. For these simulations, the material parameter $D_c$ is set as $0.55$. A more physically realistic damage evolution can be observed, and rapid crack propagation is evident in the force-displacement curve. Such a rapid loss of load-carrying capacity at a certain point for tensile specimens has been observed experimentally \cite{li_ductile_2011,malcher_improved_2014}. It is worth noting that the fact that the damage is set as $0.99$ combined with the diffusive effects of the Rhie-Chow term will still lead to some nonphysical residual force-displacement behaviour of the simulations (e.g. the residual force required for further displacement in Figure \ref{bordenCaseEffNL}).
%\hl{Consider what comment figures to add here}.

%\begin{figure}[t!]
%	\centering
%		\subfigure[Force vs. displacement] {\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/effNLDispForceBorden.png}}
%		\qquad
%		\subfigure[non-local Damage vs. displacement] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/eff_disp_damageNonLocalBorden.png}}
%	\caption{Flat notched bar (case a)}
%	\label{axiCaseEffNL}
%\end{figure}
%\begin{figure}[t!]
%	\centering
%		\subfigure[Force vs. displacement] {\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/effNLDispForceAxi.png}}
%		\qquad
%		\subfigure[non-local Damage vs. displacement] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/eff_disp_damageNonLocalAxi.png}}
%	\caption{Notched round bar (case b)}
%	\label{bordenCaseEffNL}
%\end{figure}


%To illustrate this point, the results for the flat notched bar case with non-local Lemaitre damage (case a) and the notched round bar with non-local Lemaitre damage (case b) from the previous section are analysed.
%The cases looked at here use a time step of $0.001$ and a Rhie-Chow scale factor of $0.1$.
%The force-displacement curves and the damage evolution plotted at the cells where fracture first occurs (Figures \ref{axiMesh} and \ref{bordenMesh}) are given in Figures \ref{BordenNonLocalIssue} and \ref{AxiNonLocalIssue}.


% Move results to section 4
%\begin{figure}[htbp]
%	\centering
%		\subfigure[Force vs. displacement]
%		{
%		\includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/CNLDispForceAxi.png}
%		}
%		\subfigure[non-local Damage vs. displacement]
%		{
%		\includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/disp_damageNonLocalAxi.png}
%		}
%	\caption{Notched round bar}
%	\label{AxiNonLocalIssue}
%\end{figure}
%\begin{figure}[htbp]
%	\centering
%		\subfigure[Force vs. displacement]
%		{
%		\includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/CNLDispForceBorden.png}
%		}
%		\subfigure[non-local Damage vs. displacement]
%		{
%		\includegraphics[width=0.45\textwidth]{./Figures/effectiveNonLocalDamage/disp_damageNonLocalBorden.png}
%		}
%	\caption{Flat notched bar}
%	\label{BordenNonLocalIssue}
%\end{figure}





%%%%
\subsection{GTN Model}
%%%%

\subsubsection{Material Parameters}
For the GTN model, the notched round bar is only examined here.
The GTN material properties for the notched round bar case are given in Table \ref{table:NRB_material_properties_GTN}.
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
		    Property & Symbol & Value & Units  \\ \hline 
		    Young's modulus & $E$ & $69$ & GPa \\
		    Poisson's ratio & $v$ & $0.3$   & - \\
		    $q_1$ & $q_1$ & $1.5$  & -\\
		    $q_2$ & $q_2$ & $1$  & -\\
		    $q_3$ & $q_3$ & $2.25$  & -\\
		    Initial porosity & $f_0$ & $0.002$  &  -\\
		    Nucleation strain mean & $\varepsilon_n$ & $0.15$  &  -\\
		    Nucleation strain standard deviation & $S_n$ & $0.08$  &  -\\
		    Void volume fraction parameter & $f_n$ & $0.2$  & -\\
		    Hardening law & $\sigma_y$ & $589({10^{-4}+\bar{\varepsilon}}_p)^{0.216}$ & MPa  \\
		\hline
		\end{tabular}
	\caption{GTN material parameters for the notched round bar case}
	\label{table:NRB_material_properties_GTN}
\end{table}

%In this section, simulations are conducted on the implemented GTN model in OpenFOAM as well as on Abaqus using the inbuilt GTN model. A displacement of $0.5\ mm$ is applied. Increments of displacement of $0.001\ mm$ are applied by default. The Abaqus simulation is given the option to use increments as small as $0.00001\ mm$ to aid with convergence. 

%%%%
\subsubsection{Reaction Forces}
%%%%
The predicted force-displacement curves for the GTN model are compared with predictions from Abaqus in Figure \ref{fig:axi_GTN_forceDisp}.
The forces align well, where, as with the Lemaitre model, a slightly quicker localisation can be observed in the OpenFOAM implementation.
A feature of this test case when using the current GTN model and parameters is the sharp crack propagation, i.e. the sudden drop off in force in Figure \ref{fig:axi_GTN_forceDisp}.
Consistent with the Lemaitre cases, the Abaqus simulation has convergence issues and eventually crashes, while convergence issues were not encountered in the current (OpenFOAM) simulations.
% at approximately $0.371$ mm displacement
%As noted above, the segregated solution procedure likely contributes to the superior convergence abilities of the OpenFOAM simulations.
\begin{figure}[htb]
\begin{center}
	\includegraphics[width=0.5\textwidth]{./Figures/GTNCompare/forceDispGTN2}
	\caption{Predicted force vs displacement for the notched round bar case using the GTN model, compared with predictions from Abaqus.}
	\label{fig:axi_GTN_forceDisp}
\end{center}
\end{figure}

%%%%
\subsubsection{Porosity and Plastic Strains}
%%%%
The predicted porosity and equivalent plastic strain at the neck's centre are compared with Abaqus's predictions in Figure \ref{fig:axi_GTN_pointResults}.
Porosity and plastic strain increase smoothly up to the point at which the crack propagates, after which their values significantly increase.
The differences between the current OpenFOAM formulation and the Abaqus formulation are more pronounced here, after the onset of necking.
The GTN model in Abaqus is once again based on a Jaumann-rate plasticity formulation, which may be one reason for the observed differences.
%appears to use the same plasticity formulation as the other Abaqus simulations so the same reasoning behind explaining observed differences in Lemaitre/Plasticity models would hold: \url{https://classes.engineering.wustl.edu/2009/spring/mase5513/abaqus/docs/v6.6/books/usb/default.htm?startat=pt05ch18s02abm23.html}
\begin{figure}[htb]
	\centering
		\subfigure[Porosity vs displacement]
		{
			\includegraphics[width=0.4\textwidth]{./Figures/GTNCompare/epsilonPEq_GTN.jpg}
		}
		\subfigure[Equivalent plastic strain vs displacement]
		{
			\includegraphics[width=0.4\textwidth]{./Figures/GTNCompare/displacement_porosity.jpg}
		}
		\caption{Predicted porosity and equivalent plastic strain at the centre of the notched round bar case using the GTN model, compared with predictions from Abaqus.}
	\label{fig:axi_GTN_pointResults}
\end{figure}




\subsection{Phase Field Model}

%In this section, OpenFOAM simulations are conducted for the flat notched bar case in \citet{borden_phase-field_2016}.

\subsubsection{Material Parameters}
For the phase field model, the flat notched bar is only examined here, and the predictions are compared with the results from \citet{borden_phase-field_2016} and \citet{eldahshan_phase_2021}.
The phase field model material properties are given in Table \ref{table:FNB_material_properties_phaseField}.
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
			Property & Symbol & Value & Units  \\ \hline 
			Young's modulus & $E$ & $68.8$ & GPa \\
			Poisson's ratio & $v$ & $0.33$  & - \\
			Critical Fracture Energy & $G_c$ & $60\times10^3$ &  J/m$^2$ \\
			Plastic Threshold & $W_o$ & $10$ &  MPa \\
			Characteristic Length & $l_c$ & $0.3226$ &  mm    \\
			Hardening law & $\sigma_y$ & $320+688\, {\bar{\varepsilon}}_p$ &  MPa  \\
			\hline
		\end{tabular}
	\caption{Phase field material parameters for the notched flat notched bar case}
	\label{table:FNB_material_properties_phaseField}
\end{table}


\subsubsection{Reaction Forces}
For consistency with results in the literature, the results are presented here as normalised stress vs normalised displacement, resulting in a scaled version of the force vs displacement curve.
The normalised stress is the reaction force divided by the initial area of the narrowest cross-section, and the normalised displacement is the total displacement divided by the specimen's initial length.
The predicted normalised stress vs normalised displacement for the phase field model of the flat notched bar is shown in Figure \ref{fig:phaseFieldForce}.
The normalised stress trace plateaus after the initial elastic region, followed by a rapid drop corresponding to crack propagation.
The results agree closely with those from \citet{borden_phase-field_2016} and \citet{eldahshan_phase_2021}.
%It can be seen that the results line up well, verifying the implementation of the model.
It is worth noting that the normalised stress reported by \citet{borden_phase-field_2016} before the rapid crack propagation is slightly lower than that obtained here and by \citet{eldahshan_phase_2021}.
\begin{figure}[htb]
\begin{center}
	\includegraphics[width=0.5\textwidth]{./Figures/phaseCompare.png}
	\caption{Predicted normalised stress vs normalised displacement for the flat notched bar case using the phase field model, compared with predictions from \citet{borden_phase-field_2016} and \citet{eldahshan_phase_2021}.}
	\label{fig:phaseFieldForce}
\end{center}
\end{figure}


%\subsubsection{Stresses, Strains and Damage}
%\hl{No comparisons in the thesis: check references to see what can be compared}

\subsection{Benchmarking the Layer Addition-Removal Remeshing Procedure}
%%%%
As a final benchmark, the proposed layer addition-removal remeshing procedure is compared with the traditional Lagrangian approach (no remeshing) for a wire drawing case where no damage accumulation is assumed.
Here, the wire drawing setup is the same as described in Section \ref{sec:wireDrawingDamageComparison}, except no damage model is employed.
In the layer addition-removal case, the wire length is keep constant at $L_w = 30$ mm, while in the traditional Lagrangian approach $L_w = 60$ mm.
In both cases, a drawing displacement of $45$ mm is applied over $150$ ms.

Figure \ref{fig:benchmarkLayersForces} compares the predicted drawing force (force in the axial direction on the wire downstream boundary) as a function of time for the layer addition-removal and traditional (no remeshing) approaches.
After the startup phase ($< 20$ ms), the drawing forces are seen to closely agree for both approaches.
The oscillations in force come from the mesh resolution effects on the contact procedure and are seen to reduce as the mesh is refined.
After $100$ ms, the oscillations are seen to reduce in the layer addition-removal approach, which is attributed to the wire axial cell widths approximately matching the axial distance travelled each time step.
Near the end time ($> 140$ ms), the predicted forces from the Lagrangian (no remeshing) approach are seen to drop, due to the boundary effects fromt he approaching wire upstream boundary.
\begin{figure}[htb]
	\centering
		\subfigure[Drawing forces]
		{
			\includegraphics[width=0.7\textwidth]{./Figures/compareForcesNoLayers.pdf}
		}
	\label{fig:benchmarkLayersForces}
\end{figure}

Figures \ref{fig:benchmarkLayersPeeq}(a) and (b) compares the predicted epsilon plastic strain distribution at the $t = 100$ ms and $t = 150$ ms respectively for both approaches, where the layer addition-removal results are shown on the top and the Lagrangian (no remeshing) results are reflected on the bottom.
The plastic strain fields are seen to be qualitatitively similar in both approaches at $t = 100$ ms.
At $t = 150$ ms, minor changes can be seen in the Lagrangian (no remeshing) approach due to the proximity of the wire upstream boundary.
\begin{figure}[htb]
	\centering
		\subfigure[Equivalent plastic strain distribution at 100 ms for the layer addition-removal (upper) and Lagrangian (lower) approaches]
		{
			\includegraphics[width=\textwidth]{./Figures/comparePeeqNoLayersT100ms}
		}
		\subfigure[Equivalent plastic strain distribution at 150 ms for the layer addition-removal (upper) and Lagrangian (lower) approaches]
		{
			\includegraphics[width=\textwidth]{./Figures/comparePeeqNoLayersT150ms}
		}
		\caption{Comparison of the predictions from the layer addition-removal remeshing procedure and the traditional Lagrangian (no remeshing) procedure}
	\label{fig:benchmarkLayersPeeq}
\end{figure}

The clock time for the layer addition-removal aproach is 279 s, while it was 783 s for the Lagrangian (no remeshing) approach, highlighting that doubling number of wire cells more than doubled the clock time ($\times 2.8$ in this case).

This benchmark case demonstrates that the proposed layer addition-removal approach achieves it goal of reducing the computational time, while still delivering the same predictions.



%%%%%%%%%%%%%%%%%%%%%%%%
\section{Wire Drawing Simulations} \label{sec:wire_drawing}
%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{The Wire Drawing Process}

This section applies the developed damage procedures to the wire drawing process (Figure \ref{fig:wireDrawing}).
The key parameters are the die semi-angle $\alpha$ (in $^{\circ}$), which is the angle made by the die with the wire axis, and the reduction ratio $r$ ($\%$), given by
\begin{equation}
    r = 100 \times \left(\frac{d_i^2 - d_o^2}{d_i^2}\right)
\end{equation}
where $d_i$ is the wire's initial diameter, and $d_o$ is the die outlet diameter.
The final wire diameter tends to be marginally larger than the die outlet diameter due to elastic \emph{spring back}.
\begin{figure}[htb]
\begin{center}
	\includegraphics[width=0.5\textwidth]{./Figures/SimulationAndAnalysis/modelCompare/drawingSchematic.pdf}
	\caption{Schematic of the axisymmetric wire drawing process with a conical die. See Table \ref{tab:wire_Draw_geom} for the definition of the symbols.}
	\label{fig:wireDrawing}
\end{center}
\end{figure}

 % (Figure 7.3).
%For these wire-drawing simulations, an Eulerian-inspired Lagrangian method is employed \cite{cardiff_eulerian-inspired_2017}. In this approach, as the wire is being pulled through the die, cells are added to the wire at the inlet (or upstream) boundary and cells are deleted from the mesh at the outlet (or downstream) boundary (Figure 7.2). The simulation is
%carried out until consistent values are reached along the wire for its properties after exiting the outlet patch. The wire is continuously being pulled in the axial direction by a fixed increment of displacement at each time step. More details on this procedure can be seen in \citet{cardiff_eulerian-inspired_2017}. The contact boundary is handled using the method developed in \citet{cardiff_development_2012,cardiff_lagrangian_2017}.
%The wire drawing simulations were performed in serial on the UCD Sonic High Performance Computing (HPC) cluster.

%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/wireMesh_InletOutlet.jpg}
%\caption{Process for cell layer addition and removal}
%\label{fig:wireInletOutlet}
%\end{center}
%\end{figure}

%\begin{figure}[htbp]
%	\centering
%		\subfigure[Initial contact at first time step] {\label{airbus}\includegraphics[width=0.8\textwidth]{./Figures/SimulationAndAnalysis/initialContact.png}}		
%	  \qquad
%		\subfigure[Equivalent plastic strain after $30\ mm$ displacement] {\label{boeing} \includegraphics[width=0.8\textwidth]{./Figures/SimulationAndAnalysis/settledEpsilonPEq.png}}
%        \qquad
%  	\subfigure[Damage after $30\ mm$ displacement] {\label{boeing} \includegraphics[width=0.8\textwidth]{./Figures/SimulationAndAnalysis/settledDamage.png}}
%		
%		\caption{Wire drawing simulation}
%	\label{label_for_entire_figure}
%\end{figure}
%\FloatBarrier
%
%%\subsubsection{Incorporating damage}
%
%
%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/damageIssue.png}
%\caption{Issue with incorporating damage at initial stages of case}
%\label{fig:notchedRoundBAr}
%\end{center}
%\end{figure}

%\FloatBarrier

%%%%
\subsection{Comparison of Damage Models for Wire Drawing}
%%%%
In wire drawing, fracture typically originates in the centre of the specimen due to the combination of triaxiality and plastic strain \cite{gonzalez_assessment_2018, norasethasopon_prediction_2008, hoffmanner_selection_1971, choi_study_2010}.
To compare the ability of the damage models to predict this type of damage, a \emph{typical} wire drawing pass is considered, with a reduction ratio $r$ of 10\% and a semi-angle $\alpha$ of $6^{\circ}$ \cite{roh_process_2021}.
This case is not expected to display \emph{catastrophic} fracture; however, damage accumulation is envisaged.
The simulations are performed as 2-D axisymmetric with a structured quadrilateral mesh.
An average cell width of $0.4$ mm is employed, which has been found to minimise mesh errors.
Table \ref{tab:wire_Draw_geom} summarises the geometry and mesh parameters.
%This case examines the ability of the developed damage models (Lemaitre, GTN, phase field) to predict damage in a wire drawing process.
\begin{table}[htb]
	\centering
		\begin{tabular}{llll} \hline
		    %Loading Conditions \\ \hline 
		    Quantity & Symbol & Value & Units \\
		    \hline
		    Die inlet diameter & $\phi_i$ & $16$ & mm \\
		    Die outer diameter & $\phi_o$ & $20$ & mm \\
	      	    Die outlet diameter & $d_o$ & $12.33$ & mm \\
	            Die semi-angle & $\alpha$ &  $6$ & $^{\circ}$ \\
		    Wire length & $L_w$ & $30$ & mm \\
		    Wire initial diameter & $d_i$ & $13$ & mm \\
%     	            Die average cell width & & $0.4$ & mm \\
%	            Wire average cell width & & $0.4$ & mm \\
			\hline
		\end{tabular}
	\caption{Die and wire geometry for comparing damage modelling approaches. Refer to Figure \ref{fig:wireDrawing} for interpretation of the parameters.}
	\label{tab:wire_Draw_geom}
\end{table}

The wire elastoplastic material parameters, typical of a high-carbon steel, are given in Table \ref{tab:wire_draw_material_properties} \citep{clancy_improving_2019}.
A modified Voce Law \cite{cao_modelling_2014} (Equation \ref{eqn:modifiedVoce}) is chosen to describe the plastic hardening law, as Cao \cite{cao_modelling_2014} found that this law accurately described the hardening behaviour of high carbon steel in tensile, torsion and compression tests.
\begin{equation} \label{eqn:modifiedVoce}
    \sigma_y=\sigma_{0} + (\sigma_{\infty} - \sigma_{0} + k\bar{\varepsilon}_p)(1 - e^{-\beta\bar{\varepsilon}_p})
\end{equation}
%Aside from this, the parameters taken for the GTN, phase field and Lemaitre damage model are somewhat arbitrary and are mainly chosen for illustrative purposes.
%The chosen damage parameters have not been calibrated to specific experiments, but have been chosen to demonstrate the abaility of the damage laws.
% values of these parameters will not affect the area of the wire where damage or fracture is predicted to occur but rather the level of damage or porosity that accumulates.
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
			Term  & Value & Units  \\ \hline 
			Young's modulus & 200  & GPa \\
			Poisson's ratio & 0.3 & -  \\
			%Hardening law & $689+(1340-689+250\,\bar{\varepsilon}_p)(1-e^{-32.82\,\bar{\varepsilon}_p})$ & MPa  \\
			$\sigma_0$ & $689$ & MPa  \\
			$\sigma_\infty$ & $1340$ & MPa  \\
			$k$ & $250$ & MPa  \\
			$\beta$ & $32.82$ & -  \\
			\hline
		\end{tabular}
	\caption{Wire elastoplastic material parameters, where the hardening behaviour is given by Equation \ref{eqn:modifiedVoce}}
	\label{tab:wire_draw_material_properties}
\end{table}
The die elastic parameters (Table \ref{tab:die_draw_material_properties}) correspond to tungsten carbide, as is typically used for drawing die nibs.
\begin{table}[htb]
	\centering
		\begin{tabular}{llll} \hline
			Term  & Value & Units \\ \hline 
            		Young's modulus & 600 & GPa \\
			Poisson's ratio & 0.22 & -  \\
			\hline
		\end{tabular}
	\caption{Die elastic material parameters}
	\label{tab:die_draw_material_properties}
\end{table}

A back tension of 20 MPa is applied to the wire upstream boundary, while a total drawing displacement of 45 mm is applied to the downstream wire boundary over 150 ms, allowing quasi-steady-state conditions to be reached.
Frictional contact (Coulomb coefficient of 0.1) is assumed between the wire and die contact surfaces.
All other die surfaces are assumed to have a zero displacement condition, mimicking the steel casings typically used.
%The loading conditions are summarised in Table \ref{tab:wire_draw_BCs}.
The pressure equation approach described in Section \ref{sec:pressureApproach} is used for all wire drawing cases presented here, where the Rhie-Chow pressure scale factor was set as $\mathcal{R}_p = 100$.
The Eulerian-type mesh layer addition and removal procedure (Section \ref{sec:euler_BCs}) is employed at the wire upstream and 
downstream boundaries.
In the modelling approach adopted here, the entire length of the wire starts at the initial diameter, resulting in an overlap with the die.
In the first time step, the contact procedure `pushes' the wire back, enforcing the contact constraints.
This procedure has been found to reach quasi-steady-state drawing conditions efficiently; however,
it can lead to convergence issues when incorporating damage, particularly in cases with large reduction ratios and high die angles. % which will be encountered in section 7.3.
%The high amount of deformation in this region of the wire in contact with the die in the initial time steps may lead to a large amount of damage accruing and an unstable numerical solution.
This issue is ameliorated here by allowing the damage to evolve only after a user-specified drawing displacement, chosen here as $2$ mm.
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{lllll} \hline
%		    %Loading Conditions \\ \hline 
%		    Quantity & Symbol & Value & Units \\
%		    \hline
%		    Applied total displacement & - & $30$ & mm \\
%		    Total simulation time & - & 150 & ms \\
%		    Time step & $\Delta t$ & $1$ & ms \\
%		    %Displacement increment  & - & $0.2$ & mm   \\
%		    Friction coefficient & $\mu$ & $0.1$ & - \\
%		    \hline
%		\end{tabular}
%	\caption{Loading conditions for wire drawing case}
%	\label{tab:wire_draw_BCs}
%\end{table}
%%%%


%%%%
\subsection{Comparison of Damage Models for Wire Drawing} \label{sec:wireDrawingDamageComparison}
%%%%
In wire drawing, fracture typically originates in the centre of the specimen due to the combination of triaxiality and plastic strain \cite{gonzalez_assessment_2018, norasethasopon_prediction_2008, hoffmanner_selection_1971, choi_study_2010}.
To compare the ability of the damage models to predict this type of damage, a \emph{typical} wire drawing pass is considered, with a reduction ratio $r$ of 10\% and a semi-angle $\alpha$ of $6^{\circ}$ \cite{roh_process_2021}.
This case is not expected to display \emph{catastrophic} fracture; however, damage accumulation is envisaged.
The simulations are performed as 2-D axisymmetric with a structured quadrilateral mesh.
An average cell width of $0.4$ mm is employed, which has been found to minimise mesh errors.
Table \ref{tab:wire_Draw_geom} summarises the geometry and mesh parameters.
%This case examines the ability of the developed damage models (Lemaitre, GTN, phase field) to predict damage in a wire drawing process.
\begin{table}[htb]
	\centering
		\begin{tabular}{llll} \hline
		    %Loading Conditions \\ \hline 
		    Quantity & Symbol & Value & Units \\
		    \hline
		    Die inlet diameter & $\phi_i$ & $16$ & mm \\
		    Die outer diameter & $\phi_o$ & $20$ & mm \\
	      	    Die outlet diameter & $d_o$ & $12.33$ & mm \\
	            Die semi-angle & $\alpha$ &  $6$ & $^{\circ}$ \\
		    Wire length & $L_w$ & $30$ & mm \\
		    Wire initial diameter & $d_i$ & $13$ & mm \\
%     	            Die average cell width & & $0.4$ & mm \\
%	            Wire average cell width & & $0.4$ & mm \\
			\hline
		\end{tabular}
	\caption{Die and wire geometry for comparing damage modelling approaches. Refer to Figure \ref{fig:wireDrawing} for interpretation of the parameters.}
	\label{tab:wire_Draw_geom}
\end{table}

The wire elastoplastic material parameters, typical of a high-carbon steel, are given in Table \ref{tab:wire_draw_material_properties} \citep{clancy_improving_2019}.
A modified Voce Law \cite{cao_modelling_2014} (Equation \ref{eqn:modifiedVoce}) is chosen to describe the plastic hardening law, as Cao \cite{cao_modelling_2014} found that this law accurately described the hardening behaviour of high carbon steel in tensile, torsion and compression tests.
\begin{equation} \label{eqn:modifiedVoce}
    \sigma_y=\sigma_{0} + (\sigma_{\infty} - \sigma_{0} + k\bar{\varepsilon}_p)(1 - e^{-\beta\bar{\varepsilon}_p})
\end{equation}
%Aside from this, the parameters taken for the GTN, phase field and Lemaitre damage model are somewhat arbitrary and are mainly chosen for illustrative purposes.
%The chosen damage parameters have not been calibrated to specific experiments, but have been chosen to demonstrate the abaility of the damage laws.
% values of these parameters will not affect the area of the wire where damage or fracture is predicted to occur but rather the level of damage or porosity that accumulates.
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
			Term  & Value & Units  \\ \hline 
			Young's modulus & 200  & GPa \\
			Poisson's ratio & 0.3 & -  \\
			%Hardening law & $689+(1340-689+250\,\bar{\varepsilon}_p)(1-e^{-32.82\,\bar{\varepsilon}_p})$ & MPa  \\
			$\sigma_0$ & $689$ & MPa  \\
			$\sigma_\infty$ & $1340$ & MPa  \\
			$k$ & $250$ & MPa  \\
			$\beta$ & $32.82$ & -  \\
			\hline
		\end{tabular}
	\caption{Wire elastoplastic material parameters, where the hardening behaviour is given by Equation \ref{eqn:modifiedVoce}}
	\label{tab:wire_draw_material_properties}
\end{table}
The die elastic parameters (Table \ref{tab:die_draw_material_properties}) correspond to tungsten carbide, as is typically used for drawing die nibs.
\begin{table}[htb]
	\centering
		\begin{tabular}{llll} \hline
			Term  & Value & Units \\ \hline 
            		Young's modulus & 600 & GPa \\
			Poisson's ratio & 0.22 & -  \\
			\hline
		\end{tabular}
	\caption{Die elastic material parameters}
	\label{tab:die_draw_material_properties}
\end{table}

A back tension of 20 MPa is applied to the wire upstream boundary, while a total drawing displacement of 30 mm is applied to the downstream wire boundary over 150 ms, allowing quasi-steady-state conditions to be reached.
Frictional contact (Coulomb coefficient of 0.1) is assumed between the wire and die contact surfaces.
All other die surfaces are assumed to have a zero displacement condition, mimicking the steel casings typically used.
%The loading conditions are summarised in Table \ref{tab:wire_draw_BCs}.
The pressure equation approach described in Section \ref{sec:pressureApproach} is used for all wire drawing cases presented here, where the Rhie-Chow pressure scale factor was set as $\mathcal{R}_p = 100$.
The Eulerian-type mesh layer addition and removal procedure (Section \ref{sec:euler_BCs}) is employed at the wire upstream and 
downstream boundaries.
In the modelling approach adopted here, the entire length of the wire starts at the initial diameter, resulting in an overlap with the die.
In the first time step, the contact procedure `pushes' the wire back, enforcing the contact constraints.
This procedure has been found to reach quasi-steady-state drawing conditions efficiently; however,
it can lead to convergence issues when incorporating damage, particularly in cases with large reduction ratios and high die angles. % which will be encountered in section 7.3.
%The high amount of deformation in this region of the wire in contact with the die in the initial time steps may lead to a large amount of damage accruing and an unstable numerical solution.
This issue is ameliorated here by allowing the damage to evolve only after a user-specified drawing displacement, chosen here as $2$ mm.
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{lllll} \hline
%		    %Loading Conditions \\ \hline 
%		    Quantity & Symbol & Value & Units \\
%		    \hline
%		    Applied total displacement & - & $30$ & mm \\
%		    Total simulation time & - & 150 & ms \\
%		    Time step & $\Delta t$ & $1$ & ms \\
%		    %Displacement increment  & - & $0.2$ & mm   \\
%		    Friction coefficient & $\mu$ & $0.1$ & - \\
%		    \hline
%		\end{tabular}
%	\caption{Loading conditions for wire drawing case}
%	\label{tab:wire_draw_BCs}
%\end{table}


%%%%
\subsubsection{Lemaitre Model}
%%%%
Table \ref{tab:lemaitre_wire_draw_mat} gives the Lemaitre model wire parameters.
Simulations are conducted here, both with and without crack-closure effects.
For the Lemaitre model \emph{with} crack-closure effects, the crack-closure parameter is taken to be 0.2 \cite{desmorat_modeling_2008, lemaitre_course_1996, bouchard_enhanced_2011}.
\begin{table}[htb]
	\centering
		\begin{tabular}{llll} \hline
			Property & Symbol & Value & Units \\ \hline 
			Lemaitre damage denominator & $S_0$ & $13.5$ & MPa  \\
			Lemaitre damage exponent & $b$ & 1.0 & - \\
			Lemaitre critical damage  & $D_c$ & 0.99 & - \\
			Crack closure parameter & $h$ & 0.2 & -\\
			\hline
		\end{tabular}
	\caption{Lemaitre model parameters for wire drawing}
	\label{tab:lemaitre_wire_draw_mat}
\end{table}

Figure \ref{fig:lemaitre_wire_draw_damage} provides the predicted Lemaitre damage distributions.
It can be observed that without crack-closure effects (upper image in Figure \ref{fig:lemaitre_wire_draw_damage}), the Lemaitre model gives a somewhat unrealistic damage distribution, with damage being at a maximum away from the centre of the wire.
This is because it does not distinguish between positive and negative triaxialities. 
In contrast, the damage is correctly predicted at a maximum in the centre of the wire for the Lemaitre model \emph{with} crack-closure effects (lower image in Figure \ref{fig:lemaitre_wire_draw_damage}).
This is where the triaxiality and, relatedly, the positive stress tensor are at a maximum.
Both models predict limited damage evolution towards the outer surface of the wire due to the triaxiality cut-off $\left(-\sfrac{1}{3}\right)$ for damage evolution.
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.6\textwidth]{./Figures/SimulationAndAnalysis/modelCompare/compareLemaitre.pdf}
%		\subfigure[Without crack closure effects]
%		{
%		\label{fig:lemaitre_wire_draw_damage_no_crack_close}
%		\includegraphics[width=0.8\textwidth]{./Figures/SimulationAndAnalysis/modelCompare/classicLemaitre.png}
%		}
%%	  \qquad
%%		\subfigure[Triaxiality distribution] {\label{boeing} \includegraphics[width=0.5\textwidth]{./Figures/SimulationAndAnalysis/modelCompare/classsicLemaitreTriaxiality.png}}
%		\subfigure[With crack closure effects]
%		{
%		\label{fig:lemaitre_wire_draw_damage_with_crack_close}
%		\includegraphics[width=0.8\textwidth]{./Figures/SimulationAndAnalysis/modelCompare/crackClosureDamage.png}
%		}
%	  \qquad
%		\subfigure[Positive stress tensor distribution] {\label{boeing} \includegraphics[width=0.5\textwidth]{./Figures/SimulationAndAnalysis/modelCompare/crackClosureTauPositive.png}}
		\caption{Predicted damage distribution from the the Lemaitre damage model with (lower) and without (upper) crack-closure effects}
	\label{fig:lemaitre_wire_draw_damage}
\end{figure}


%%%%
\subsubsection{GTN Model}
%%%%
The GTN model wire parameters are given in Table \ref{tab:GTN_wire_draw_mat}, corresponding to those of a typical high-strength steel.
\begin{table}[htb]
	\centering
		\begin{tabular}{llll} \hline
		Property & Symbol & Value & Units  \\ \hline 
		$q_1$ & $q_1$ & $1.5$ & - \\
		$q_2$ & $q_2$ & $1$ & - \\
		$q_3$ & $q_3$ & $2.25$ & - \\
		Initial porosity & $f_0$ & $0.002$ & -  \\
		Mean & $\varepsilon_n$ & $0.03$ & -  \\
		Standard deviation & $S_n$ & $0.02$ & - \\
		Volume fraction & $f_N$ & $0.04$ & - \\
		\hline
		\end{tabular}
	\caption{GTN model parameters for wire drawing}
	\label{tab:GTN_wire_draw_mat}
\end{table}

For the GTN model, porosity growth is negligible for typical wire drawing passes due to the high hydrostatic pressures, making void nucleation the dominant mechanism driving the evolution of the porosity \cite{cao_modelling_2014}.
The GTN model accurately predicts the porosity to be maximum at the centre of the wire (Figure \ref{fig:GTN_wire_draw_poro}).
This is because porosity evolution due to nucleation is only set to occur when the hydrostatic pressure is negative (Equation \ref{eqn:nucleatonA}).
However, there are apparent issues with the assumption of the Gaussian distribution for void nucleation.
To illustrate this, the evolution of the equivalent plastic strain and porosity are shown in Figure \ref{fig:GTN_wire_draw_plot} for a cell near the axis of the wire.
% and which has a cell-centre $0.3047\ mm$ to the right of the wire inlet at the initial time step.
%The evolution of these variables is only displayed while this cell is in the process zone i.e. the region where it undergoes plastic straining.
It can be observed that the Gaussian assumption leads to the porosity saturating.
This is unlikely to reflect the true material behaviour \cite{cao_modelling_2014}, suggesting an alternative assumption may be more appropriate.
%\hl{What is expected?} \hl{Could we not change the parameters to avoid this?}
\begin{figure}[htb]
\begin{center}
	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/modelCompare/gtnModel2.png}
	\caption{Predicted porosity distribution in wire drawing for the GTN model}
	\label{fig:GTN_wire_draw_poro}
\end{center}
\end{figure}
\begin{figure}[htb]
\begin{center}
	\includegraphics[width=0.5\textwidth]{./Figures/SimulationAndAnalysis/modelCompare/GTNElement.png}
	\caption{Predicted porosity and equivalent plastic strain evolution along the wire axis in the axial (x) direction for the GTN model.}
	\label{fig:GTN_wire_draw_plot}
\end{center}
\end{figure}



%%%%
\subsubsection{Phase Field Model}
%%%%
The phase field model wire parameters are given in Table \ref{tab:PF_wire_draw_mat}, also chosen to correspond to those of a typical high-strength steel.
\begin{table}[htb]
	\centering
		\begin{tabular}{llll} \hline
			Property & Symbol & Value & Units  \\ \hline 
			Critical fracture energy & $G_c$ & $1$ & MJ/m$^2$ \\
   			Plastic work threshold & $W_o$ & $0$ & J \\
			Characteristic length & $l$ & $0.3266$ & mm   \\
			\hline
		\end{tabular}
	\caption{Phase field fracture model parameters for wire drawing}
	\label{tab:PF_wire_draw_mat}
\end{table}

The phase field fracture model predicts material degradation to be at its greatest towards the outer surface of the wire (Figure \ref{fig:PF_wire_draw}).
The region with the greatest plastic straining corresponds to the region where material degradation is predicted to be highest.
This is contrary to what is expected.
The current phase field model does not distinguish between tensile and compressive stress states for the plastic contribution towards crack growth, leading to this unrealistic behaviour.
\begin{figure}[htbp]
	\centering
		\subfigure[Distribution for the damage variable $d$]
		{
		%\label{airbus}
		\includegraphics[width=0.8\textwidth]{./Figures/SimulationAndAnalysis/modelCompare/phaseFieldExample2.png}
		}
	  \qquad
		\subfigure[Distribution of the equivalent plastic strain $\bar{\epsilon}_p$]
		{
		%\label{boeing}
		\includegraphics[width=0.8\textwidth]{./Figures/SimulationAndAnalysis/modelCompare/phaseFieldEpsPEq2.png}
		}
	\caption{Predicted damage and equivalent plastic strain fields in wire drawing for the phase field model.}
	\label{fig:PF_wire_draw}
\end{figure}

%%%%
\subsubsection{Summary}
%%%%
Along with the limitations in the GTN and phase field models described in the previous section, other factors make them unsuitable for further investigation in predicting fracture in wire drawing processes.
The phase field fracture model requires a relatively fine mesh \cite{borden_phase-field_2016}, making it computationally expensive. The GTN model requires the calibration of multiple parameters, which is not feasible given the data available for the cases that will be looked at here.
To rigorously calibrate these parameters, the characterisation of each stage of ductile damage requires the continuous monitoring of void nucleation, growth and coalescence during deformation.
This is possible (for example, using X-ray tomography measurements such as in \citet{thuillier_ductile_2012} and \citet{fansi_numerical_2013}), but is far more demanding than required of the Lemaitre-type models.
Consequently, Lemaitre-based damage models with crack-closure effects are chosen here for further evaluation.


%%%%
\subsection{Prediction of Chevron Cracks} \label{sec:chevron_cracks}
%%%%
%Following the initial wire drawing study, the Lemaitre damage model is the most promising for predicting damage in wire drawing.
To test the Lemaitre models further, their ability to predict \emph{chevron cracks} is examined in this section.
Chevron cracks, also known as central burst defects, are common defects that occur at the wire centre in drawing (Figure \ref{fig:chevronCracks}).
%The ability of the developed scheme is tested in its ability to model their occurrence. The relevant material properties and loading conditions are given in Tables 6.10-13 (further details on these wire drawing simulations are given in the next chapter). 
\begin{figure}[htb]
\begin{center}
	\includegraphics[width=0.55\textwidth]{./Figures/finiteVolumeCharacteristics/chevronCracked.png}
	\caption{Chevron cracks in steel rods, similar to those that can occur in drawn wires \cite{krauss_steels_2015}}
	\label{fig:chevronCracks}
\end{center}
\end{figure}

A reduction of $r = 20\%$ and a die semi-angle of $\alpha = 10^{\circ}$ are chosen, where all geometric parameters are given in Table \ref{tab:chevron_geom}.
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
		    Die inlet diameter & $\phi_i$ & $16$ & mm \\
		    Die outer diameter & $\phi_o$ & $20$ & mm \\
	      	    Die outlet diameter & $d_o$ & $11.627$ & mm \\
		    Die semi-angle & $\alpha$ &  $10$ & $^{\circ}$ \\
		    Wire length & $L_w$ & $30$ & mm \\
		    Wire initial diameter & $d_i$ & $13$ & mm \\
		    \hline
		\end{tabular}
	\caption{Die and wire geometry used for the chevron crack predictions.}
	\label{tab:chevron_geom}
\end{table}

%\hl{compare BCs to previous; is it the same?}
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{llll} \hline
%		    %Loading Conditions \\ \hline 
%		    Applied total displacement & $u$ & $30\ mm$ \\
%		    Uncoupled displacement & $u$ & $50\ mm$ \\
%		    Time dtep & $\Delta t$ & $0.001\ s$ \\
%			Displacement increment  & $\Delta u$ & $2\ mm$   \\
%			Friction coefficient & $\mu$ & $0.1$ \\
%			\hline
%		\end{tabular}
%	\caption{Loading conditions for wire drawing case}
%	\label{tab:chevron_BCs}
%\end{table}

Table \ref{tab:chevron_mat} gives the assumed wire elastoplastic Lemaitre properties.
These properties, along with the drawing reduction and angle, have been chosen to be in a drawing regime expected to produce chevron cracks.
Table \ref{tab:die_draw_material_properties} gives the die elastic properties.
%\hl{Where did these props come from?}
\begin{table}[htb]
	\centering
		\begin{tabular}{llll} \hline
			Property & Symbol & Value & Units  \\ \hline 
			Young's modulus & $E$ & $200$ & GPa \\
			Poisson's ratio & $v$ & $0.33$  &  - \\
			Lemaitre damage denominator & $S_0$ & $15$ & MPa  \\
			Lemaitre damage exponent & $b$ & 1.0 & - \\
			Critical damage & $D_c$ & $0.052$ & -\\
			Characteristic length & $l_c$ & $0.325$ & mm  \\
			%Hardening law & $\sigma_y$ & $600+(1218-600+250\bar{\varepsilon}^p) \left(1-e^{43.44\bar{\varepsilon}^p}\right)$ &  MPa \\
			Initial yield stress & $\sigma_0$ & $600$ & MPa  \\
			Asymptotic yield stress & $\sigma_\infty$ & $1280$ & MPa  \\
			Hardening paramter & $k$ & $250$ & MPa  \\
			Hardening parameter & $\beta$ & $43.44$ & -  \\
			\hline
		\end{tabular}
	\caption{Wire material parameters for the chevron crack simulation. The hardening behaviour is given by Equation \ref{eqn:modifiedVoce}.}
	\label{tab:chevron_mat}
\end{table}
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{llll} \hline
%			Property & Symbol & Value & Units  \\ \hline 
%			Young's modulus & $E$ & $600$ & GPa \\
%			Poisson's ratio & $v$ & $0.22$ & -  \\
%			\hline
%		\end{tabular}
%	\caption{Die elastic material properties}
%	\label{tab:material_properties}
%\end{table}

The effective non-local damage field (Figure \ref{simulatedChevronCrack}) predicts the formation of expected chevron cracks.
The characteristic semi-lunar-shaped cracks are found to occur at a fixed frequency and continue to form as long as the drawing continues.
From the modelling perspective, it has been found that without the proposed effective non-local damage approach described in Section \ref{sec:effNonLocalDam}, the non-local damage field grows excessively, resulting in the over-prediction of damage.
Consequently, rapid crack propagation ensues, and the formation of chevron cracks is not predicted.
Hence, including such an effective damage-limiting procedure is crucial in predicting these types of defects.
%The unrestricted growth of the local damage field $D$ leads to the rapid growth of the $\bar{D}$ field, and therefore, many cells have a value for $\bar{D}$ which exceeds $D_c$.
% (Figure \ref{simulatedDamageNotLimited} b). 
%the results can be seen if the growth of the local damage field $D$ is not restricted when $\bar{D}_{eff}>D_c$ (step (i) in Algorithm \ref{effectiveNonLocalDamage}).
\begin{figure}[htbp]
	\centering
		\subfigure[Axisymmetric mesh]
		{
			%\label{airbus}
			\includegraphics[width=0.7\textwidth]{./Figures/finiteVolumeCharacteristics/simulatedChevron2.png}
		}
		\subfigure[Rotational extrusion ($270^{\circ}$) of the axisymmetric mesh]
		{
			%\label{boeing}
			\includegraphics[width=0.7\textwidth]{./Figures/finiteVolumeCharacteristics/270ChevronCracking2.png}
		}
		\caption{Prediction of chevron cracks in wire drawing using the Lemaitre damage model. The distribution of the damage variable $d$ is shown.}
	\label{simulatedChevronCrack}
\end{figure}

%\begin{figure}[htbp]
%	\centering
%		\subfigure[$\bar{D}_{eff}$ field prior to reaching $D_c$] {\label{airbus}\includegraphics[width=0.8\textwidth]{./Figures/finiteVolumeCharacteristics/otherDrawing.png}}
%		
%		\subfigure[$\bar{D}_{eff}$ field after reaching $D_c$] {\label{boeing} \includegraphics[width=0.8\textwidth]{./Figures/finiteVolumeCharacteristics/simulatedDrawingGrowth.png}}
%		
%		\caption{Unstable crack propogation}
%	\label{simulatedDamageNotLimited}
%\end{figure}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Fracture Prediction in a Drawing Series}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%
\subsubsection{Drawing Series Overview}
%%%%

%In this section, \hl{wip}
%- check Lemaitre on test series from XX, where the fracture is noted
%- a secondary output is the calibration approach.

In this final section, the experimental wire drawing series from \citet{roh_process_2021} is used to investigate the ability of the Lemaitre-based damage models to predict fracture.
Data is available for die half-angles $\alpha$ from $2$ to $16^{\circ}$, and reduction ratios $r$ from $20$ to $36\%$.
The initial wire diameter was $13$ mm.
%The case in \citet{roh_process_2021} where $r=36\%$ and $\alpha=2^{\circ}$ is not looked at in this work due to the fact Roh et al. attribute the fracture that occurs to the combination of high $r$ and low $\alpha$ leading to excessive pulling force and friction effects that are not captured by the friction model used in the simulations. The improvement of the friction model to account for this is beyond the scope of this work.  
Table \ref{tab:roh_draw_series} summarises the experimental drawing test data available for the examined high-carbon steel wire, where tests which displayed catastrophic wire fracture are indicated with the symbol $X$.
\begin{table}[htb]
	\centering
		\begin{tabular}{llll} \hline
			Reduction $r$ (\%) & Drawing Die Half-Angle $\alpha$ $(^{\circ})$ & Fracture  \\ \toprule 
			& 2 & - \\
			& 4 & - \\
			& 6 & - \\
			20 & 8 & - \\
			& 10 & - \\
			& 12 & $X$ \\
			& 14 & $X$ \\
			& 16 & $X$ \\
			\hline
			& 4 & - \\
			& 6 & - \\
			& 8 & - \\
			36  & 10 & - \\
			& 12 & $X$ \\
			& 14 & $X$ \\
			& 16 & $X$ \\
			\bottomrule
		\end{tabular}
	\caption{Experimental high-carbon steel wire drawing series data from \citet{roh_process_2021}, where tests which displayed catastrophic wire fracture are indicated with the symbol $X$}
	\label{tab:roh_draw_series}
\end{table}


A $30$ mm long wire was used for drawing simulations, aside from the cases where $r=36\%$, $\alpha=4^{\circ}$ and $r=20\%$, $\alpha=2^{\circ}$.
In these cases, a longer 50 mm wire was used to ensure minimum upstream and downstream boundary effects.
Table \ref{tab:drawing_series_die_geom} summarises the die and wire geometry.
%the loading conditions and wire geometry given in Table \ref{} are used.
An average cell width of $0.25$ mm was found to be sufficient to minimise mesh errors.
%achieve a consistent solution for the drawing simulations (Appendix F2).
%Die outlet diameters of $11.627$ mm and  $10.4$ mm$ were used, which resulted in reductions of $20\%$ and $36\%$ respectively.
The coefficient of friction was taken as $\mu = 0.08$, as determined in \citet{roh_process_2021}.
Neither the die's specific geometry nor the die's material properties are specified in \citet{roh_process_2021}, so a conical die is assumed here with die material parameters taken from \citet{clancy_improving_2019}, corresponding to tungsten carbide.
%The material properties for both die and wire are given in Tables 7.17 and 7.18.
A total drawing displacement of 30 mm is applied to the wire downstream boundary in increments of 0.1 mm with a time step size of 0.5 ms (the total simulation time was 150 ms).
A back tension of 20 MPa was applied to the wire upstream boundary.
%All other die surfaces are assumed to have a zero displacement condition \hl{check}.
As before, the damage can only evolve after a drawing displacement of $2$ mm to avoid localisation in the initial time steps.
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{llll} \hline
%		    %Loading Conditions \\ \hline 
%		    Applied total displacement & $u$ & $30\ mm$ \\
%		    Time step & $\Delta t$ & $0.0005\ s$ \\
%			Displacement increment  & $\Delta u$ & $0.1\ mm$   \\
%			Friction coefficient & $\mu$ & $0.08$ \\
%			\hline
%		\end{tabular}
%	\caption{Loading conditions for wire drawing case}
%	\label{tab:material_properties}
%\end{table}
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
		    Die inlet diameter & $\phi_i$ & $16$ & mm \\
		    Die outer diameter & $\phi_o$ & $20$ & mm \\
	      	    Die outlet diameter & $d_o$ & $[11.627, 10.4]$ & mm \\
		    Die semi-angle & $\alpha$ &  $[2, 4, 6, 8, 10, 12, 14, 16] $ & $^{\circ}$ \\
		    Wire length & $L_w$ & $[30, 50]$ & mm \\
		    Wire initial diameter & $d_i$ & $13$ & mm \\
		    \hline
		\end{tabular}
	\caption{Die and wire geometry used for the drawing series analyses.}
	\label{tab:drawing_series_die_geom}
\end{table}

%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%		    %Loading Conditions \\ \hline 
%      	Wire length & $l$ & $50\ mm$ \\
%		    Applied total displacement & $u$ & $50\ mm$ \\
%		    Time step & $\Delta t$ & $0.00025\ s$ \\
%			Displacement increment  & $\Delta u$ & $0.05\ mm$   \\
%			\hline
%		\end{tabular}
%	\caption{Conditions for cases where $r=36\%$, $\alpha=4^{\circ}$ and $r=20\%$, $\alpha=2^{\circ}$} 
%	\label{tab:material_properties}
%\end{table}

%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%			Term  & Value & Units\\ \hline 
%            Young's modulus & 200 & GPa \\
%			Poisson's ration & 0.3  \\
%   		Hardening law & $689+(1340-689+104\bar{\varepsilon}^p)(1-e^{-32.82\times\bar{\varepsilon}^p})$ & MPa  \\
%        	$S_0$ & $13.81$, $14.29$ & ? \\
%        	b & $1.0$ & - \\
%            $D_c$ & $0.078$, $0.087$ & - \\
%			\hline
%		\end{tabular}
%	\caption{Wire material parameters}
%	\label{tab:material_properties}
%\end{table}

%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%			Term  & Value  \\ \hline 
%            Young's modulus & 600 $GPa$ \\
%			Poisson's ration & 0.22  \\
%			\hline
%		\end{tabular}
%	\caption{Die material parameters}
%	\label{tab:material_properties}
%\end{table}


%In the models, the damage is not set to $0.99$ after exceeding the critical damage $D_c$ (equation 4.47).
%This is because the crack path is not of interest given that the details of the fracture surface are not provided in \citet{roh_process_2021}.
%In any case relatively small time steps are required to track the crack growth which is computationally expensive.
%As well as this, insight into the damage behaviour can be made by seeing how much the damage $D$ exceeds $D_c$, in cases where it does.
In the models presented here, the non-local gradient equation is not incorporated as localisation behaviour is limited due to the low calibrated value of $D_c$, and hence, it would not significantly change the results.
%into these simulations. As will be shown show later, the calibrated value for $D_c$ is quite low meaning that localisation behaviour is limited.
%In any case, the mesh cell size is kept consistent in all simulations to ensure that any localisation behaviour is consistent between the simulations.


%%%%
\subsubsection{Material Model Calibration}
%%%%

To calibrate the elastoplastic and Lemaitre parameters, tensile test data provided in \citet{roh_process_2021} is used (Figure \ref{fig:roh_tensile_test}).
%for a round bar of diameter 6.25 $mm$ and gauge length $12.5\ mm$ until fracture (Figure 7.10).
%The dataset sampled from \citet{roh_process_2021} which will be examined in this thesis is provided in Figure 7.10 and Table 7.9. In Figure 7.10 the engineering stress and strain until fracture are given for a tensile test.
The calibration procedure follows that of \citet{masse_study_2010}, where the plastic hardening law is first calibrated against the experimental force-displacement data up to the point where necking is observed ($\approx6.5\%$ engineering strain).
Subsequently, the damage parameters are calibrated while the elastoplastic parameters are fixed.
The calibration procedure is simplified by separating out the calibration of the plastic hardening law and the damage parameters, and the risk of over-fitting is reduced.
The Young's modulus (200 GPa), Poisson's ratio (0.3) and initial yield stress (689 MPa) are taken directly from \citet{roh_process_2021}.
%These values are $200\ GPa,\ 0.3$ and $689\ MPa$ respectively.
\begin{figure}[htbp]
\begin{center}
	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/experimentalData.png}
\caption{Tensile test experimental data from \citet{roh_process_2021}}
\label{fig:roh_tensile_test}
\end{center}
\end{figure}
%The material parameters are calibrated using the tensile test data.

A combined global-local approach is taken to calibrate the elastoplastic and damage parameters.
Initially, 50 sets of values for $\sigma_{\infty}$, $k$ and $\beta$ (Equation \ref{eqn:modifiedVoce}) are taken from the range of values given in Table \ref{tab:material_model_calibration} using Latin hypercube sampling \cite{loh_latin_1996}.
%The tensile test is simulated using an axisymmetric mesh as shown in Figure 7.11, by making use of symmetries only a quarter of the specimen needs to be modelled. A cell size of $0.25\ mm$ is used in the critical zone of the wire mesh where fracture is expected to occur.
%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/simTensileTest.png}
%\caption{Tensile test mesh, marked cell in pink for where fracture initiates}
%\label{fig:notchedRoundBAr}
%\end{center}
%\end{figure}
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{llll} \hline
%		    %Loading Conditions \\ \hline 
%		    Applied total displacement & $u$ & $1.3375\ mm$ \\
%		    Time step & $\Delta t$ & $0.01\ s$ \\
%			Displacement increment  & $\Delta u$ & $0.0125\ mm$   \\
%			\hline
%		\end{tabular}
%	\caption{loading conditions for case a}
%	\label{tab:material_properties}
%\end{table}
Each of these sets of values is used to simulate a tensile test. The force-displacement curves from each simulation are then compared to the experimental data up to 6.5\% engineering strain (onset of necking).
The parameter sets with the minimum difference from this \emph{global} sampling are then further optimised using the \emph{local} Nelder-Mead method \cite{luersen_globalized_2004} to refine the material parameters.
Table \ref{tab:material_model_calibration} gives the final optimised values.
Here, two forms of the Lemaitre model are compared: (i) the classic form, where the $S$ parameter is a constant, and (ii) the form proposed in Equation \ref{eqn:proposedLemaitre}, which introduces a triaxiality dependence to the $S$ parameter. 
% The resulting parameters are given in Table 7.11
\begin{table}[htb]
	\centering
		\begin{tabular}{llllll} \hline
			Term  & \multicolumn{2}{c}{Range} & Optimal Value & Units \\ 
				  & Lower & Upper &  &  \\ \hline 
			$\sigma_{\infty}$ & 1.1 & 1.5 & 1.34 & GPa \\
			$k$ & 50 & 500 & 104 & MPa  \\
			$\beta$ & 25 & 80 & 32.82 & - \\
			\hline
		\end{tabular}
	\caption{Elastoplastic parameter search ranges and optimal calibrated values}
	\label{tab:material_model_calibration}
\end{table}
%A tensile test is simulated using each of these sets of values. The force-displacement curves that result from each of these simulations are then compared to the experimental data for up to 6.5\% engineering strain using the objective function in equation \ref{eqn:plastictyObjFunction}. 
%\begin{equation}
%\label{eqn:plastictyObjFunction}
%S(b_j)=\frac{1}{N} \sum_{i=1}^N\left(\frac{|F^{sim}_i(b_j)-F^{exp}_{l,\ i}|}{F^{exp}_i}\right)
%\end{equation}
%where $b_j$ is the vector of variables, $N$ is the number of experimental points, $F^{sim}_i$ is the value of the simulated force point and $F^{exp}_{l,\ i}$ is the experimental point determined by linear interpolation to a specified displacement.
%The results which minimise this objective function are then further optimised using the Nelder-Mead method \cite{luersen_globalized_2004} to refine the material parameters. 
% The resulting parameters are given in Table 7.11
% \begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%			Term  & Value  \\ \hline 
%            $\sigma_{yinf}$ & 1.34 ($\times10e9$) MPa \\
%			$k$ & 0.104 ($\times10e9$) MPa  \\
%   		$beta$ & 32.82 &  \\
%			\hline
%		\end{tabular}
%	\caption{Calibrated material parameters for the plastic hardening law}
%	\label{tab:material_properties}
%\end{table}


%%%%
%\subsubsection{Lemaitre damage parameter}
%%%%
Once the elastoplastic parameters have been fit, the Lemaitre damage parameter $S_0$ is determined. % is calibrated for each Lemaitre-based law.
%As before, 50 values are sampled at constant intervals for the range given in Table 7.12.
To do this, 50 values are sampled in the range in Table \ref{tab:material_model_calibration_lemaitre}.
For the classic and proposed Lemaitre laws, tensile test simulations are conducted for each value of $S_0$, with the elastoplastic parameters held constant at the previously found optimal values.
As before, the parameter sets with the minimum difference from this \emph{global} sampling are then further optimised using the \emph{local} Nelder-Mead method \cite{luersen_globalized_2004} to refine the material parameters (Table \ref{tab:material_model_calibration_lemaitre}).
%The parameters that minimise the objective function (equation \ref{eqn:damageObjFunction}) are then further optimised using the Nelder-Mead method.
%The objective function to be minimised is given in equation \ref{eqn:damageObjFunction}.
%For this objective function, simulated force values that are lower than the experimental values are punished. This is to ensure a solution is not obtained that performs well in the latter-middle part of the deformation path (engineering strain between ~7\% and ~9\%) but leads to an unrealistically high amount of necking (``1" in Figure 7.12).
%This in turn results in an unrealistically high level of plastic straining, triaxiality and ultimately damage in the critical region of the round bar. ``2" in Figure 7.12 gives the simulated force-displacement curve for the parameter calibrated using the objective function in equation \ref{eqn:damageObjFunction}.
%\begin{equation}
%\label{eqn:damageObjFunction}
%S(b_j)=\frac{1}{N} \sum_{i=1}^N\left(\frac{<F^{sim}_i(S_0)-F^{exp}_{l,\ i}>+6\times<-\left(F^{sim}_i(S_0)-F^{exp}_{l,\ i}\right)>}{F^{exp}_i}\right)
%\end{equation}
%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/compareNecking.png}
%	\caption{Comparison of simulated and experimental data}
%	\label{fig:calibrated_lemaitre_wire_draw}
%\end{center}
%\end{figure}
Finally, the critical damage parameter $D_c$ is set as the maximum value for the simulated damage obtained at the failure strain ($10.7 \%$ engineering strain) \cite{malcher_continuum_2012}.
%The resultant material parameters are given in Table 7.13. 
\begin{table}[htb]
	\centering
		\begin{tabular}{llllll} \hline
			Term  & \multicolumn{2}{c}{Range} & \multicolumn{2}{c}{Optimal Value} & Units \\ 
				  & Lower & Upper & Classic & Proposed &  \\ \hline 
			$S_0$ & 5 & 25 & 13.81 & 14.29 & MPa \\
			$D_c$ & - & - & 0.078 & 0.087 & - \\
			\hline
		\end{tabular}
	\caption{Lemaitre damage parameter search ranges and optimal calibrated values, where the proposed law corresponds to Equation \ref{eqn:proposedLemaitre}.}
	\label{tab:material_model_calibration_lemaitre}
\end{table}
%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%			Law & $S_0$ &  $D_c$ \\ \hline 
%             Classic Lemaitre & $13.81\ MPa$ & 0.078 \\
%    		Proposed Lemaitre & $14.29\ MPa$ & 0.087   \\
%			\hline
%		\end{tabular}
%	\caption{Calibrated material - classic Lemaitre damage law}
%	\label{tab:material_properties}
%\end{table}

The resultant force-displacement curves obtained using the calibrated parameters are given in Figure \ref{fig:calibrated_tensile_test}, and the optimal calibrated parameters in Tables \ref{tab:material_model_calibration} and \ref{tab:material_model_calibration_lemaitre}.
\begin{figure}[htb]
\begin{center}
	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/compareAllLemaitreExp.png}
	\caption{Comparison of the experimental tensile test curve and the calibrated elastoplastic Lematire material laws. The `Novel Lemaitre` model corresponds to Equation \ref{eqn:proposedLemaitre}.}
	\label{fig:calibrated_tensile_test}
\end{center}
\end{figure}




%\begin{figure}[htbp]
%	\centering
%		\subfigure[Damage vs. engineering strain] {\label{airbus}\includegraphics[width=0.8\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/compareSimDamage.png}}
%		\qquad
%		\subfigure[Equivalent plastic strain vs. engineering strain] {\label{boeing} \includegraphics[width=0.8\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/compareSimEpsPeq.png}}
%	
%	\caption{Damage and equivalent plastic strain evolution at centre of specimen}
%	\label{label_for_entire_figure}
%\end{figure}
%
%\begin{figure}[htbp]
%	\centering
%		\subfigure[Damage vs. engineering strain] {\label{airbus}\includegraphics[width=0.45\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/compareSimDamage.png}}
%		\subfigure[Equivalent plastic strain vs. engineering strain] {\label{boeing} \includegraphics[width=0.45\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/compareSimEpsPeq.png}}
%	
%	\caption{Damage and equivalent plastic strain evolution at centre of specimen}
%	\label{label_for_entire_figure}
%\end{figure}
%




\subsubsection{Predicted Evolution of Damage}
For all of the cases simulated here, the damage is at a maximum towards the centre of the specimen.
As an example, the predicted damage distribution for the case where $r=36\%,\ \alpha=6^{\circ}$ using the classic Lemaitre damage evolution equation is shown in Figure \ref{fig:wire_draw_damage_lemaitre}.
The greatest damage occurs at the centre of the wire because this is where the triaxiality and, relatedly, the positive stress tensor are greatest.
%The relationship between the triaxiality $\eta$ and the positive stress tensor $\tau^+$ will be further explored later in this section.
The evolution of the triaxiality and axial (xx) component of the plastic strain increment in the active deformation zone is shown in Figure \ref{fig:wire_draw_other_results}.
%This cell is located at the centre of the wire and has a cell centre $1.66\ mm$ to the right of the wire inlet at the initial time step.
It can be observed that the damage evolution primarily occurs with the increase in triaxiality towards the latter stages of the plastic straining.
\begin{figure}[htb]
\begin{center}
	\includegraphics[width=0.8\textwidth]{./Figures/SimulationAndAnalysis/compare36_12/36_6Damage2.png}
	\caption{Distribution of damage for $r=36\%,\ \alpha=6^{\circ}$}
	\label{fig:wire_draw_damage_lemaitre}
\end{center}
\end{figure}
\begin{figure}[htbp]
	\centering
%	\subfigure[Positve stress tensor]
%	{
%%		\label{airbus}
%		\includegraphics[width=0.4\textwidth]{./Figures/SimulationAndAnalysis/compare36_12/36_6tauPositive2.png}
%	}
%	\qquad
  	\subfigure[Triaxiality $\eta$]
	{
%		\label{boeing}
		\includegraphics[width=0.48\textwidth]{./Figures/SimulationAndAnalysis/compare36_12/36_6Triaxiality2}
	}
%        \qquad
  	\subfigure[Axial (xx) component of the plastic strain increment tensor]
	{
%		\label{boeing}
		\includegraphics[width=0.48\textwidth]{./Figures/SimulationAndAnalysis/compare36_12/36_6Dpxx2}
	}	
	\caption{Predicted distribution of triaxiality and axial component of the plastic strain increment tensor in the active deformation zone for the $r=36\%,\ \alpha=6^{\circ}$ wire drawing case}
	\label{fig:wire_draw_other_results}
\end{figure}

%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/compareCellData/cellCompare.png}
%\caption{Evolution of variables}
%\label{fig:notchedRoundBAr}
%\end{center}
%\end{figure}
%\FloatBarrier

%%%%
\subsubsection{Fracture Prediction}
%%%%
To determine whether a fracture is predicted to occur, the accumulated damage at the wire axis is compared with the critical damage $D_c$ (Figure \ref{fig:final_damage}).
Fracture can be expected to occur when the quantity $\sfrac{D}{D_c}$ becomes greater than or equal to 1.
Figure \ref{fig:final_damage} shows that both the classic and the proposed formulations of the Lemaitre model are reasonably consistent with the experimental results.
The classic model accurately predicts fracture for the $20\%$ reduction cases but overpredicts fracture in the $36\%$ reduction cases.
The novel Lemaitre-based model slightly underpredicts fracture in both the $20\%$ and $36\%$ reduction cases, with a value for $D$ that is 90.4\% and 90.8\% of $D_c$, respectively.
Nonetheless, both models produce good predictive capabilities, with the novel approach being slightly closer to the experimental data.
\begin{figure}[htbp]
	\centering
		\subfigure[$20\%$ Reduction]
		{
%			\label{airbus}
			\includegraphics[width=0.45\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/20Reduction.png}
		}
  		\subfigure[$36\%$ Reduction]
		{
%			\label{boeing}
			\includegraphics[width=0.45\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/36Reduction.png}
		}
		\caption{Comparison of predicted and experimental fractures. The shaded region indicates where fractures occurred in experiments, corresponding to the $X$ symbols in Table \ref{tab:roh_draw_series}.}
	\label{fig:final_damage}
\end{figure}


%In Figure 7.19, the resultant equivalent plastic strain and the weighted triaxiality $\eta_{w}$ (equation \ref{eqn:weightedTriax}) are given for each test case.
%These values are taken from the cases simulated using the novel formulation.
%The resultant values for these are extremely similar between the classic and novel formulations, so only the values obtained for the novel formulation are displayed for clarity's sake.
%\begin{figure}[htbp]
%	\centering
%		\subfigure[Weighted triaxiality] {\label{airbus}\includegraphics[width=0.6\textwidth]{./Figures/SimulationAndAnalysis/compareCellData/compareWeightedTriaxAll.png}}		
%	  \qquad
%  	\subfigure[Equivalent plastic strain] {\label{boeing} \includegraphics[width=0.6\textwidth]{./Figures/SimulationAndAnalysis/compareCellData/comparePlasticStrain.png}}		
%		\caption{Comparison of weighted triaxiality and equivalent plastic strain}
%	\label{label_for_entire_figure}
%\end{figure}
%
%\begin{equation} \label{eqn:weightedTriax}
%	\eta_{w} = \frac{1}{\bar{\varepsilon}^p}\int^{\bar{\varepsilon}^p}_{0}\eta\ d \bar{\varepsilon}^p
%\end{equation}

%The differences in the accumulated damage value for each case and damage law can be explained by viewing this figure.
%The equivalent plastic strain is considerably higher in the $36\%$ reduction cases than in the $20\%$ reduction cases, while the triaxiality is greater when $\alpha\geq6^{\circ}$, in the $20\%$ reduction cases.
%The accumulated damage is largely determined by the level of plastic straining and the triaxiality state as it undergoes this plastic straining.
%The added triaxiality dependence in the novel formulation leads to considerably lower accumulated damage in the low $\eta_{w}$ cases compared to the classic formulation. 

%%%%%
%\subsubsection{Scanning electron microscopy (SEM)}
%%%%%
%In \citet{roh_process_2021}, SEM analysis was conducted for many of the cases where fracture did not occur to observe the development of micro-voids around inclusions (non-metallic inclusions within the steel), and for the formation of micro-cracks. For an accurate damage model, there should be a correlation between the damage $D$ and the observed level of micro-voids and micro-cracks. 
%
%In Figure 7.20, several micrographs are provided for a selection of the cases. The accumulated damage $D$ normalised against the critical damage $D_c$ for each of these cases is also provided in Table 7.19.
%
%The normalised damage values for the novel model are reasonably consistent with the micrographs. Values of 0.23 and 0.34 are obtained  for a) and b) in Figure 7.20 where micro-voids can be observed, while values of 0.58 and 0.57 are obtained for the cases where micro-cracking can be observed in d) and e). The normalised damage of 0.35 for case c) where a ruptured inclusion can be observed is very similar to the value obtained for case b) where only microvoids are observed. It can be seen in Figure 7.19 that the $\alpha=4^{\circ}$ case has a greater peak value for the triaxiality $\eta$, while in Figure 7.21 it is clear that the $\eta_w$ is greater for the case where  $\alpha=8^{\circ}$. The net effect of this is that the model calculated similar accrued damage for the two cases. Given that in case c) a ruptured inclusion can be observed, this would suggest that the triaxiality relationship for the novel model is marginally too aggressive. 
%
%For the classic Lemaitre damage model, the normalised damage values are somewhat consistent with the micrographs. As with Figure 7.18 however, there is evidence for overprediction of damage. As well as predicting a $D/D_c$ value of 1.23 for case d) where fracture did not occur, values of 0.54 and 0.68 seem quite high for cases a) and b) where only micro-voids can be observed. 
%
%Conclusive remarks can be hard to make on the suitability of these damage models based on a small sample of micrographs, however. Ideally, SEM analysis would be conducted on tensile specimens that have undergone various engineering strains \cite{liu_microstructure_2017} to try better understand the expected pattern of void nucleation, growth and coalescence (micro-crack formation) for various $D$ values.
%


%\begin{figure}[t!]
%	\centering
%		\subfigure[$r=20\%,\ \alpha=6^{\circ}$] {\label{airbus}\includegraphics[width=0.3\textwidth]{./Figures/SimulationAndAnalysis/compareVoidGrowth/20_6.png}}		
%	  \qquad
%  	\subfigure[$r=36\%,\ \alpha=4^{\circ}$] {\label{boeing} \includegraphics[width=0.3\textwidth]{./Figures/SimulationAndAnalysis/compareVoidGrowth/36_4.png}}
%        \qquad
%  	\subfigure[$r=36\%,\ \alpha=8^{\circ}$] {\label{boeing} \includegraphics[width=0.3\textwidth]{./Figures/SimulationAndAnalysis/compareVoidGrowth/36_8.png}}
%           \qquad
%    		\subfigure[$r=36\%,\ \alpha=10^{\circ}$] {\label{boeing} \includegraphics[width=0.3\textwidth]{./Figures/SimulationAndAnalysis/compareVoidGrowth/36_10.png}}
%        \qquad
%  	\subfigure[$r=20\%,\ \alpha=10^{\circ}$] {\label{boeing} \includegraphics[width=0.5\textwidth]{./Figures/SimulationAndAnalysis/compareVoidGrowth/20_10.png}}
%		
%		\caption{Scanning electron microscopy (SEM) micrographs for various combinations of the half-angle $\alpha$ and reduction ratios (images adapted from \citet{roh_process_2021})}
%	\label{label_for_entire_figure}
%\end{figure}
%\FloatBarrier

%\begin{table}[htb]
%	\centering
%		\begin{tabular}{cccc} \hline
%			Reduction (\%) & Drawing half-angle ($^{\circ}$) &  Novel $D/D_c$ & Classic $D/D_c$\\ \hline 
%
%   		20 & 6 & 0.23 & 0.54\\
%      	 & 10 & 0.58 & 0.89\\
%			\hline
%			 & 4 & 0.34 & 0.68\\
%      	36 & 8 & 0.35 & 0.93\\
%             & 10 & 0.57 & 1.23\\
%			\hline
%		\end{tabular}
%	\caption{$D/D_c$ for selected drawing cases}
%	\label{tab:material_properties}
%\end{table}
%
%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/compareCellData/degreeCompare.png}
%\caption{Comparison of triaxiality evolution in process zone}
%\label{fig:notchedRoundBAr}
%\end{center}
%\end{figure}
%\FloatBarrier

%%\subsubsection{Simulated and experimental results discrepancy}

%There are various factors that could explain the differences between simulated and experimental results. One of these is experimental error, it can be observed in Figure 7.14 that there would be a sharp difference in the obtained $D_c$ if there was only a small difference in the engineering strain to fracture. It's worth noting that in \citet{roh_process_2021}, the critical fracture value was selected at $10\%$ engineering strain for the Ko fracture criterion. In this thesis, the critical damage value was selected at $10.7\%$ engineering strain in order to be consistent with the experimental engineering stress-strain curve provided in \citet{roh_process_2021}.

%Limitations in the proposed model could also explain the discrepancies. The added triaxiality relationship incorporated into the Lemaitre model was chosen as this is the relationship used in the Ko criterion \cite{ko_prediction_2007} which has been validated in the prediction of both the hub-hole expanding process \cite{ko_prediction_2007} and fracture in wire drawing \cite{roh_process_2021}. However, perhaps a different relationship, whether that be in the linear relationship proposed or an exponential relationship, could have achieved more accurate results. 

%Another limitation could be the friction model used. In this chapter, a friction coefficient $\mu$ of $0.08$ was assumed to be consistent with \citet{roh_process_2021}, however, a different friction model would alter the obtained results. In Figure 7.22 it can be observed how the accumulated damage changes with $\mu$ for the novel Lemaitre-based damage model.

%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/frictionDamage.png}
%\caption{Normalised damage vs. friction coeffiecient}
%\label{fig:notchedRoundBAr}
%\end{center}
%\end{figure}

%Another important consideration, that to this author's eye has been neglected in the literature, is the strong association between the positive stress tensor $\tau^+$ and the triaxiality $\eta$ at low triaxiality values ($<0.33$) that predominate in typical wire drawing cases. The normalised positive stress tensor $\tau^+_{norm}$ is defined here and given by equation \ref{eqn:normalisedTauPositive} and is plotted against the triaxiality for selected cases in Figure 7.23. Further incorporation of the positive stress tensor into the damage evolution law, via $\tau^+_{norm}$, may have the potential for a better description of material fracture behaviour. This could be incorporated into the existing Lemaitre-based laws by altering the function $S(\eta,\xi)$ to take the form given in equation \ref{eqn:alternativeLemaiterDenominator}. More experimental data, which include a range of experimental conditions where $\eta>0.33$ is required to better distinguish between the effects of the positive stress tensor and the triaxiality.

%\begin{equation}
%\label{eqn:normalisedTauPositive}
%    \tau^+_{norm}=\frac{\tau^+ : \tau^+}{\tau : \tau}
%\end{equation}
%
%\begin{equation}
%\label{eqn:alternativeLemaiterDenominator}
%    S(\eta,\xi,\tau^+_{norm})
%\end{equation}

%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/compareCellData/tauTriaxCompare.png}
%\caption{Positive stress tensor vs. triaxiality}
%\label{fig:notchedRoundBAr}
%\end{center}
%\end{figure}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions} \label{sec:conclusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
This article presents for the first time the implementation of three popular ductile damage models within a segregated, cell-centred finite volume framework.
The proposed procedures are verified against popular benchmark cases from the literature, where the proposed approach has shown a robust ability to solve the highly nonlinear coupled equations.
Subsequently, the ability of the examined damage models to predict damage accumulation in the wire drawing process is assessed.
The main conclusions of the work are:
\begin{itemize}
	\item An implicit, segregated solution algorithm with Picard iterations has been shown to be robust for damage modelling.
	\item Novel Eulerian-style layer addition and removal boundary conditions are demonstrated to be capable of simulating the continuous wire drawing process.
	\item Lemaitre-type models are more appropriate for predicting damage in wire drawing processes than current formulations of GTN and phase field models.
	\item A proposed incorporation of triaxiality dependency in the Lemaitre $S$ parameter improves the model's predictive capabilities for wire drawing.
	\item The proposed effective non-local damage approach demonstrates more physically realistic damage evolution.
	\item Care must be taken when scaling the Rhie-Chow stabilisation term in regions of damage and plasticity to minimise mesh and time-step errors.
	\item A combined global-local optimisation is suitable for calibrating elastoplastic and damage parameters from experimental test data.
\end{itemize}

Regarding the prediction of damage in a wire drawing series, although the predictions generally aligned with the experimental data, limitations in the modelling approach exist: (i) Prediction of catastrophic fracture is relatively sensitive to the critical damage $D_c$ parameter determined from tensile test data; (ii) The assumption of Coulomb friction may be limiting in wire drawing, where hydrodynamic lubrication is known to occur; (iii) In the authors' opinion, the strong association between the positive stress tensor $\tau^+$ and the triaxiality $\eta$ at low triaxiality values ($<0.33$), which occurs in wire drawing, has been neglected.
%The normalised positive stress tensor $\tau^+_{norm}$ is defined here and given by equation \ref{eqn:normalisedTauPositive} and is plotted against the triaxiality for selected cases in Figure 7.23.
Further incorporation of the positive stress tensor into the damage evolution law may potentially better describe material fracture behaviour.
%This could be incorporated into the existing Lemaitre-based laws by altering the function $S(\eta,\xi)$ to take the form given in equation \ref{eqn:alternativeLemaiterDenominator}. More experimental data, which include a range of experimental conditions where $\eta>0.33$ is required to better distinguish between the effects of the positive stress tensor and the triaxiality.

%There are various factors that could explain the differences between simulated and experimental results. One of these is experimental error, it can be observed in Figure 7.14 that there would be a sharp difference in the obtained $D_c$ if there was only a small difference in the engineering strain to fracture. It's worth noting that in \citet{roh_process_2021}, the critical fracture value was selected at $10\%$ engineering strain for the Ko fracture criterion. In this thesis, the critical damage value was selected at $10.7\%$ engineering strain in order to be consistent with the experimental engineering stress-strain curve provided in \citet{roh_process_2021}.

%Limitations in the proposed model could also explain the discrepancies. The added triaxiality relationship incorporated into the Lemaitre model was chosen as this is the relationship used in the Ko criterion \cite{ko_prediction_2007} which has been validated in the prediction of both the hub-hole expanding process \cite{ko_prediction_2007} and fracture in wire drawing \cite{roh_process_2021}. However, perhaps a different relationship, whether that be in the linear relationship proposed or an exponential relationship, could have achieved more accurate results. 

%Another limitation could be the friction model used. In this chapter, a friction coefficient $\mu$ of $0.08$ was assumed to be consistent with \citet{roh_process_2021}, however, a different friction model would alter the obtained results. In Figure 7.22 it can be observed how the accumulated damage changes with $\mu$ for the novel Lemaitre-based damage model.

%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.7\textwidth]{./Figures/SimulationAndAnalysis/compareExperimentalSimulation/frictionDamage.png}
%\caption{Normalised damage vs. friction coeffiecient}
%\label{fig:notchedRoundBAr}
%\end{center}
%\end{figure}

%Another important consideration, that to this author's eye has been neglected in the literature, is the strong association between the positive stress tensor $\tau^+$ and the triaxiality $\eta$ at low triaxiality values ($<0.33$) that predominate in typical wire drawing cases. The normalised positive stress tensor $\tau^+_{norm}$ is defined here and given by equation \ref{eqn:normalisedTauPositive} and is plotted against the triaxiality for selected cases in Figure 7.23. Further incorporation of the positive stress tensor into the damage evolution law, via $\tau^+_{norm}$, may have the potential for a better description of material fracture behaviour. This could be incorporated into the existing Lemaitre-based laws by altering the function $S(\eta,\xi)$ to take the form given in equation \ref{eqn:alternativeLemaiterDenominator}. More experimental data, which include a range of experimental conditions where $\eta>0.33$ is required to better distinguish between the effects of the positive stress tensor and the triaxiality.

%Look toward future steps.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\backmatter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bmhead{Acknowledgments}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
This work has emanated from research conducted with the financial support of/supported in part by a grant from Science Foundation Ireland (SFI) under Grant number {RC2302\_2}.
Philip Cardiff gratefully acknowledges financial support from the Irish Research Council through the Laureate program, grant number IRCLA/2017/45, and the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme (Grant agreement No. 101088740).
Vikram Pakrashi would also like to acknowledge FlowDyn RDD/966 and SiSDATA EAPA\_0040/2022.
Additionally, the authors want to acknowledge project affiliates, Bekaert, through the Bekaert University Technology Centre (UTC) at University College Dublin (www.ucd.ie/bekaert), I-Form, funded by SFI Grant Number 16/RC/3872, co-funded under European Regional Development Fund and by I-Form industry partners, NexSys, funded by SFI Grant Number 21/SPP/3756, and the DJEI/DES/SFI/HEA Irish Centre for High-End Computing (ICHEC) for the provision of computational facilities and support (www.ichec.ie). Finally, part of this work has been carried out using the UCD ResearchIT Sonic cluster funded by UCD IT Services and the UCD Research Office.



\newpage

\begin{appendices}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Stress Calculation Algorithms} \label{app:stressCalcAlg}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Isotropic Elastoplasticity}
 
\begin{algorithm}[htb] \label{alg:stressAlg} \footnotesize
\SetAlgoLined
(i) Update deformation gradients for a given incremental displacement

\begin{equation}
  \bb{f}^{[m+1]} = \bb{I} + \left[ \bb{\nabla}(\Delta\textbf{u}) \right]^T \nonumber
\end{equation}

\begin{equation}
  \bb{F}^{[m+1]} = \bb{f}^{[m+1]} \bb{F}^{[m]}  \nonumber
\end{equation}

\begin{equation}
  J^{[m+1]} = \text{det} \left( \bb{F}^{[m+1]} \right) \nonumber
\end{equation}

(ii) Compute trial elastic state
\begin{equation}
\bb{B}_{e}^{[m]} = \exp\left({2\boldsymbol{\varepsilon}_{e}^{[m]}}\right) \nonumber
\end{equation}
\begin{equation}
\bb{B}_{e}^{\text{trial}} = \bb{f}^{[m+1]}  \bb{B}_{e}^{[m]} \left(\bb{f}^{[m+1]} \right)^{T}\nonumber
\end{equation}
\begin{equation}
\boldsymbol{\varepsilon}_{e}^{\text{trial}} = \frac{1}{2} \ln\left(\textbf{B}_{e}^{\text{trial}} \right) \nonumber
\end{equation}
\begin{equation}
\bar{\varepsilon}^{\text{trial}}_p = \bar{\varepsilon}^{[m]}_p \nonumber
\end{equation}
\begin{equation}
\sigma_{v}^{\text{trial}} = \sqrt{\sfrac{3}{2}} \, || 2 \mu \, \text{dev}(\boldsymbol{\varepsilon}_{e}^{\text{trial}})|| \nonumber
\end{equation}
\begin{equation}
\Phi^{\text{trial}} =  \sigma_{v}^{\text{trial}} - \sigma_{y}(\bar{\varepsilon}^{\text{trial}}_p) \nonumber 
\end{equation}
  \eIf{$\Phi^{\text{trial}} > 0$}{
   Go to step (iii) to solve for $\Delta\bar{\varepsilon}_p$
   }{
   $\Delta\bar{\varepsilon}_p = 0$ and go to step (iv)
  }

(iii) Use the Newton-Raphson method to solve the yield function for $\Delta\bar{\varepsilon}_p$:
\begin{equation}
	\sigma_{v}^{\text{trial}} 
	- 3\mu \Delta\bar{\varepsilon}_p
	-\sigma_{y}(\bar{\varepsilon}^{[m]}_p + \Delta\bar{\varepsilon}_p) = 0 \nonumber
\end{equation}

(iv) Update the constitutive variables and deviatoric stress
\begin{equation}
	\boldsymbol{\varepsilon}_{e}^{[m+1]}
	=
	\boldsymbol{\varepsilon}_{e}^{\text{trial}}
	- \sqrt{\sfrac{3}{2}} \; \Delta\bar{\varepsilon}_p
	\frac{\text{dev}(\boldsymbol{\varepsilon}_{e}^{\text{trial}})}{||\boldsymbol{\varepsilon}_{e}^{\text{trial}}||}
	\nonumber
\end{equation}
\begin{equation}
	\bar{\varepsilon}_p^{[m+1]} = \bar{\varepsilon}_p^{[m]} + \Delta\bar{\varepsilon}_p \nonumber
\end{equation}

\begin{equation}
	\hat{p} = -\frac{\kappa}{J^{[m+1]}} \; \text{tr}\left(\boldsymbol{\varepsilon}_{e}^{[m+1]}\right) \nonumber
\end{equation}

\begin{equation}
%	\boldsymbol{\sigma}^{[m+1]} = \frac{1}{J} \bb{D}^e:\boldsymbol{\varepsilon}^{e} \nonumber
	\boldsymbol{s}^{[m+1]}
	=
	(\sfrac{1}{J^{[m+1]}}) \, 2\mu \;\text{dev}\left(\boldsymbol{\varepsilon}_{e}^{[m+1]}\right) \nonumber
\end{equation}

(v)
   \eIf{Solve pressure equation}{
   Implicitly solve the pressure Poisson's equation:
\begin{equation}
	p^{[m+1]} - \mathbb{D} \bb{\nabla}^2 p^{[m+1]} = \hat{p} - \bb{\nabla} \cdot \left( \mathbb{D} \bb{\nabla} p^{[m+1]}_{[i]} \right) \nonumber
\end{equation}
   }{
\begin{equation}
	p^{[m+1]} = \hat{p} \nonumber
\end{equation}
  }


(vi) Update the true (Cauchy) stress
\begin{equation}
	\boldsymbol{\sigma}^{[m+1]} = \boldsymbol{s}^{[m+1]} -  p^{[m+1]}\textbf{I} \nonumber
\end{equation}

\caption{Large strain $J_2$ (von Mises) isotropic elastoplastic stress calculation algorithm \citep{de_souza_neto_computational_2008} }
\end{algorithm}





\subsection{Lemaitre Damage Model}



\begin{algorithm}[htbp] \label{alg:lemaitre} \footnotesize
\SetAlgoLined
(i) Update deformation gradients for a given incremental displacement

\begin{equation}
  \bb{f}^{[m+1]} = \bb{I} + \left[ \bb{\nabla}(\Delta\textbf{u}) \right]^T \nonumber
\end{equation}
\begin{equation}
  \bb{F}^{[m+1]} = \bb{f}^{[m+1]} \bb{F}^{[m]}  \nonumber
\end{equation}
\begin{equation}
  J^{[m+1]} = \text{det} \left( \bb{F}^{[m+1]} \right) \nonumber
\end{equation}

(ii) Compute trial elastic state
\begin{equation}
\bb{B}_{e}^{[m]} = \exp\left({2\boldsymbol{\varepsilon}_{e}^{[m]}}\right) \nonumber
\end{equation}
\begin{equation}
\bb{B}_{e}^{\text{trial}} = \bb{f}^{[m+1]}  \bb{B}_{e}^{[m]}  \left(\bb{f}^{[m+1]}\right)^{T}\nonumber
\end{equation}
\begin{equation}
\boldsymbol{\varepsilon}_{e}^{\text{trial}} = \frac{1}{2} \ln(\textbf{B}_{e}^{\text{trial}}) \nonumber
\end{equation}
\begin{equation}
\bar{\varepsilon}^{\text{trial}}_p = \bar{\varepsilon}^{[m]}_p \nonumber
\end{equation}
\begin{equation}
\sigma_{v}^{\text{trial}} = \sqrt{\sfrac{3}{2}} \, || 2\mu\ \text{dev}(\boldsymbol{\varepsilon}_{e}^{\text{trial}})|| \nonumber
\end{equation}
\begin{equation}
%\Phi^{\text{trial}} =  \frac{\sigma_{v}^{\text{trial}}}{1 - \bar{D}^{[m]}} - \sigma_{y}(\bar{\varepsilon}^{\text{trial}}_p) \nonumber 
\Phi^{\text{trial}} =  \sigma_{v}^{\text{trial}} - \sigma_{y}(\bar{\varepsilon}^{\text{trial}}_p) \nonumber 
\end{equation}
  \eIf{$\Phi^{\text{trial}} > 0$}{
   Go to step (iii) to solve for $\Delta\bar{\varepsilon}_p$
   }{
   $\Delta\bar{\varepsilon}_p = 0$ and go to step (iv)
  }

(iii) Use the Newton-Raphson method to solve the yield function for $\Delta\bar{\varepsilon}_p$:
\begin{equation}
	\sigma_{v}^{\text{trial}} 
	- \frac{ 3\mu \Delta\bar{\varepsilon}_p }{1 - \bar{D}^{[m+1]}_{\text{eff}\,[i]}}
	-\sigma_{y}(\bar{\varepsilon}^{[m]}_p + \Delta\bar{\varepsilon}_p) = 0 \nonumber
\end{equation}

(iv) Update constitutive variables and deviatoric stress
\begin{equation}
	\boldsymbol{\varepsilon}_{e}^{[m+1]}
	=
	\boldsymbol{\varepsilon}_{e}^{\text{trial}}
	- \sqrt{\frac{3}{2}} \; \frac{ \Delta\bar{\varepsilon}_p}{1 - \bar{D}^{[m+1]}_{\text{eff}\,[i]}}
	\frac{\text{dev}(\boldsymbol{\varepsilon}_{e}^{\text{trial}})}{||\boldsymbol{\varepsilon}_{e}^{\text{trial}}||}
	\nonumber
\end{equation}
\begin{equation}
	\bar{\varepsilon}_p^{[m+1]} = \bar{\varepsilon}_p^{[m]} + \Delta\bar{\varepsilon}_p \nonumber
\end{equation}

\begin{equation}
	\hat{p} = -\left(1 - \bar{D}^{[m+1]}_{\text{eff}\,[i]}\right) \frac{\kappa}{J^{[m+1]}} \; \text{tr}\left(\boldsymbol{\varepsilon}_{e}^{[m+1]}\right) \nonumber
\end{equation}

\begin{equation}
%	\boldsymbol{\sigma}^{[m+1]} = \frac{1}{J} \bb{D}^e:\boldsymbol{\varepsilon}^{e} \nonumber
	\boldsymbol{s}^{[m+1]}
	=
	\left(1 - \bar{D}^{[m+1]}_{\text{eff}\,[i]}\right) \frac{1}{J^{[m+1]}}  \, 2\mu \;\text{dev}\left(\boldsymbol{\varepsilon}_{e}^{[m+1]}\right) \nonumber
\end{equation}

(v)
   \eIf{Solve pressure equation}{
   Implicitly solve the pressure Poisson's equation:
\begin{equation}
	p^{[m+1]} - \mathbb{D} \bb{\nabla}^2 p^{[m+1]} = \hat{p} - \bb{\nabla} \cdot \left( \mathbb{D} \bb{\nabla} p^{[m+1]}_{[i]} \right) \nonumber
\end{equation}
   }{
\begin{equation}
	p^{[m+1]} = \hat{p} \nonumber
\end{equation}
  }


(vi) Update the true (Cauchy) stress
\begin{equation}
	\boldsymbol{\sigma}^{[m+1]} = \boldsymbol{s}^{[m+1]} -  p^{[m+1]}\textbf{I} \nonumber
\end{equation}

(vii) Update the local damage (use the modified form for $Y$ if $h > 0$)
%\ref{eq:triaxCutoff} and \ref{eq:damageLimit}
\begin{equation} % note: flip sign from Andrew's thesis, as Andrew assume p = hyd(sigma), whereas we assume p = -hyd(sigma)
	D^{[m+1]}_{[i+1]}  =
	\begin{cases}
		D^{[m]} &
		\text { if } \eta \leq -\frac{1}{3} \text{ or } \bar{D}^{[m+1]}_{\text{eff}\,[i]} \geq D_c \\
		D^{[m]} + \frac{\dot{\bar{\varepsilon}}_p}{1 - D^{[m+1]}_{[i]}}\left(\frac{-Y}{S(\eta,\xi)}\right)^b
%		\text{max} \left[ D^{[m]} + \frac{\dot{\bar{\varepsilon}}_p}{1 - D^{[m+1]}_{[i]}}\left(\frac{-Y}{S(\eta,\xi)}\right)^b, \; D_c \right]
		& 
		\text { if } \eta>-\frac{1}{3} \text{ and }  \bar{D}^{[m+1]}_{\text{eff}\,[i]} < D_c
	\end{cases}  \nonumber
\end{equation}

(vii) Implicitly solve diffusion equation for non-local damage
\begin{equation}
	\bar{D}^{[m+1]} -  l_c^2 \bb{\nabla}^2 \bar{D}^{[m+1]} = D^{[m+1]}_{[i+1]} \nonumber
\end{equation}
  
(viii) Update the effective damage
\begin{equation}
	\bar{D}^{[m+1]}_{\text{eff}\,[i+1]}  =
	\begin{cases}
		\bar{D}^{[m+1]} &
		\text { if }  \bar{D}^{[m+1]} \leq D_c \\
		0.99	& 
		\text { if }  \bar{D}^{[m+1]} > D_c
	\end{cases}  \nonumber
\end{equation}
%\begin{equation}
%	\bar{D}^{[m+1]} = \text{max} \left( \bar{D}^{[m+1]} , D_c \right) \nonumber
%\end{equation}

\caption{Effective non-local damage Lemaitre model stress calculation algorithm}
\end{algorithm}
\normalsize







\subsection{GTN Damage Model}



\begin{algorithm}[htbp] \label{alg:GTN} \footnotesize
\SetAlgoLined
(i) Update deformation gradients for a given incremental displacement

\begin{equation}
  \bb{f}^{[m+1]} = \bb{I} + \left[ \bb{\nabla}(\Delta\textbf{u}) \right]^T \nonumber
\end{equation}
\begin{equation}
  \bb{F}^{[m+1]} = \bb{f}^{[m+1]} \bb{F}^{[m]}  \nonumber
\end{equation}
\begin{equation}
  J^{[m+1]} = \text{det} \left( \bb{F}^{[m+1]} \right) \nonumber
\end{equation}

(ii) Compute trial elastic state
\begin{equation}
	\bb{B}_{e}^{[m]} = \exp\left({2\boldsymbol{\varepsilon}_{e}^{[m]}}\right) \nonumber
\end{equation}
\begin{equation}
\bb{B}^{\text{trial}}_e =\bb{f}^{[m+1]}\bb{B}_{e}^{[m]} \left(\bb{f}^{[m+1]} \right)^{T}\nonumber
\end{equation}
\begin{equation}
\boldsymbol{\varepsilon}_e^{\text{trial}}=\frac{1}{2} \ln\left[\textbf{B}^{\text{trial}}_e \right]\nonumber
\end{equation}
%\begin{equation} % Philip: what is this used for?
%\bar{\varepsilon}^{p}_{\text{trial}}=\bar{\varepsilon}_{p}^{[m]}\nonumber
%\end{equation}
\begin{equation}
	p^{\text{trial}} = -\kappa \, \text{tr}(\boldsymbol{\varepsilon}_{e}^{\text{trial}})\nonumber
\end{equation}
\begin{equation}
	\bb{s}^{\text{trial}}=2 \mu \, \text{dev}(\boldsymbol{\varepsilon}_{e}^{\text{trial}})\nonumber
\end{equation}
\begin{equation}
	\sigma^{\text{trial}}_v = \sqrt{\sfrac{3}{2}} \, ||  2\mu \, \text{dev}(\boldsymbol{\varepsilon}^{e}_{\text{trial}})|| \nonumber
\end{equation}
\begin{equation}
    \bb{n}=\frac{3}{2}\frac{\bb{s}^{\text{\text{trial}}}}{\sigma_v^{\text{trial}}}\nonumber
\end{equation}
\begin{equation}
	\Phi^{\text{trial}} = 
	\left(\frac{\sigma_v^{\text{trial}}}{\sigma_{y}}\right)^{2}
	+ q_{1}f_{*[i]}^{[m+1]} \cosh\left(\frac{3q_{2}p^{\text{trial}}}{2\sigma_{y}}\right)
	-\left(1 + q_{3}{f_{*[i]}^{[m+1]}}^2\right)\nonumber
\end{equation}
  \eIf{$\Phi^{\text{trial}}>0$}{
   Go to step (iii)
   }{
   set $\Delta \varepsilon_\text{vol} = \Delta \varepsilon_\text{dev} = \Delta \bar{\varepsilon}_p = 0$ and $\Delta \bb{\varepsilon}_p = \bb{0}$. Go to step (iv)
  }

(iii) Enter small strain return map and solve the system of equations (Equations 49-51) for $\Delta {\varepsilon}^{[m+1]}_h$, $\Delta {\varepsilon}^{[m+1]}_q$ and $\Delta \overline{{\varepsilon}}^p_{[m+1]}$


(iv) Update the constitutive variables
\begin{equation}
	\bar{\varepsilon}_p^{[m+1]} = \bar{\varepsilon}_p^{[m]} + \Delta \bar{\varepsilon}_p \nonumber
\end{equation}
\begin{equation}
	\bb{\varepsilon}_p^{[m+1]} = \bb{\varepsilon}_p^{[m]} +\Delta \bb{\varepsilon}_p \nonumber
\end{equation}
\begin{equation}
	\boldsymbol{\varepsilon}_{e}^{[m+1]} = \boldsymbol{\varepsilon}^{\text{trial}}
	- (\sfrac{1}{3}) \Delta {\varepsilon}^{[m+1]}_\text{vol} \, \bb{I}
	- \Delta {\varepsilon}^{[m+1]}_\text{dev} \, \bb{n}\nonumber
\end{equation}
\begin{equation}
	\hat{p} = \left(\sfrac{1}{J^{[m+1]}} \right) \left(p_{\text {trial }} + \kappa \Delta \varepsilon^{[m+1]}_{\text{vol}} \right)
\end{equation}
\begin{equation}
	\boldsymbol{s}^{[m+1]} =
	\left(\sfrac{1}{J^{[m+1]}}\right)
	\left[
%	 	\left(
%			p_{\text {trial }} - \kappa \Delta \varepsilon^{[m+1]}_{\text{vol}}
%		\right)\bb{I}
%		+
		\sfrac{2}{3} \left(\sigma_v^{\text {trial }} - 3 \mu \Delta \varepsilon^{[m+1]}_\text{dev} \right) \bb{n}
	\right] \nonumber
\end{equation}
%\begin{equation}
%\boldsybol{\tau}^{[m+1]}=\left(q_{trial}-3\mu\Delta \boldsymbol{\varepsilon}^{[m+1]}^q\left(\frac{3\bb{s}_{trial}}{2q_{trial}}\right)\right)+\left(p_{trial}-K\Delta\varepsilon^{h}^{[m+1]}\right)\nonumber
%\end{equation}

%\begin{equation}
%\boldsymbol{\sigma}^{[m+1]}=\frac{1}{J}\boldsymbol{\tau}^{[m+1]}\nonumber
%\end{equation}

%(v) Implicitly solve the pressure Poisson's equation:
%\begin{equation}
%	p^{[m+1]} - \mathbb{D} \bb{\nabla}^2 p^{[m+1]} =
%%	-\frac{\kappa}{2} \left[\left(J^{[m+1]}\right)^{2} - 1\right]
%	\frac{1}{J}\left(p_{\text {trial }} - \kappa \Delta \varepsilon^{[m+1]}_{\text{vol}} \right)
%	- \bb{\nabla} \cdot \left( \mathbb{D} \bb{\nabla} p^{[m+1]}_{[i]} \right) \\
%\end{equation}
(v)
   \eIf{Solve pressure equation}{
   Implicitly solve the pressure Poisson's equation:
\begin{equation}
	p^{[m+1]} - \mathbb{D} \bb{\nabla}^2 p^{[m+1]} = \hat{p} - \bb{\nabla} \cdot \left( \mathbb{D} \bb{\nabla} p^{[m+1]}_{[i]} \right)
\end{equation}
   }{
\begin{equation}
	p^{[m+1]} = \hat{p}
\end{equation}
  }


(vi) Update the true (Cauchy) stress
\begin{equation}
	\boldsymbol{\sigma}^{[m+1]} = \boldsymbol{s}^{[m+1]} -  p^{[m+1]}\textbf{I} \nonumber
\end{equation}


(vii) Calculate the porosity $f_{[i+1]}^{[m+1]}$ and the effective porosity $f_{*[i+1]}^{[m+1]}$:
\begin{equation}
	f^{[m+1]} = f^{[m]} + \left(1 - f^{[m+1]}_{[i]}\right) \, \text{tr}\left(\dot{\boldsymbol{\varepsilon}}^{[m+1]}_p\right)
	+ A \dot{\bar{\varepsilon}}^{[m+1]}_p
%	+ k_w f\frac{1 - \xi^2 }{\sigma_v^{[m+1]}} \,\text{dev}(\bb{\sigma}^{[m+1]}):{\dot{\boldsymbol{\varepsilon}}}_p^{[m+1]}
\end{equation}
\begin{equation}
	f^{*[m+1]} =
	\left\{
	\begin{array}{ll}
		f^{[m+1]}  & \text { if } f^{[m+1]}  \leq f_c \\
		f_c + \left(f^{[m+1]} - f_c\right) \frac{f_u - f_c}{f_f - f_c} & \text { if } f^{[m+1]}  > f_c
	\end{array}\right.
\end{equation}


(viii) Implicitly solve non-local porosity equation:
\begin{equation}
	\bar{f}^{[m+1]} -  l_c^2 \bb{\nabla}^2 \bar{f}^{[m+1]} = f^{[m+1]}
\end{equation}

\caption{GTN damage model stress calculation algorithm}
\end{algorithm}




\subsection{Phase Field Model}



\begin{algorithm}[htbp] \label{alg:phaseField} \footnotesize
\SetAlgoLined
(i) Update deformation gradients for a given incremental displacement

\begin{equation}
  \bb{f}^{[m+1]} = \bb{I} + \left[ \bb{\nabla}(\Delta\textbf{u}) \right]^T \nonumber
\end{equation}
\begin{equation}
  \bb{F}^{[m+1]} = \bb{f}^{[m+1]} \bb{F}^{[m]}  \nonumber
\end{equation}
\begin{equation}
  J^{[m+1]} = \text{det} \left( \bb{F}^{[m+1]} \right) \nonumber
\end{equation}

(ii) Compute trial elastic state
\begin{equation}
	\bb{B}_{e}^{[m]} = \exp\left({2\boldsymbol{\varepsilon}_{e}^{[m]}}\right) \nonumber
\end{equation}
\begin{equation}
	\bb{B}^{\text{trial}}_e = \bb{f}^{[m+1]}\bb{B}^{[m]}_e \left(\bb{f}^{[m+1]}\right)^{T}\nonumber
\end{equation}
\begin{equation}
	\boldsymbol{\varepsilon}^{\text{trial}}_e = \frac{1}{2} \ln \left(\textbf{B}^{\text{trial}}_e \right) \nonumber
\end{equation}
%\begin{equation}
%\bar{\varepsilon}^{p}_{trial}=\bar{\varepsilon}_{p}^{[m]}\nonumber
%\end{equation}
\begin{equation}
	\sigma_v^{\text{trial}} =
	\left(1 - d_{[i]}^{[m+1]2} \right) \sqrt{\sfrac{3}{2}} \, || 2\mu \, \text{dev}(\bb{\varepsilon}_e)|| \nonumber
\end{equation}
\begin{equation}
	\Phi^{\text{trial}} =
	\sigma_v^{\text{trial}}
	- \left(1 - d_{[i]}^{[m+1]2} \right) \, \sigma_{y}\left(\bar{\varepsilon}_p^{[m]} \right) \nonumber 
\end{equation}
\eIf{$\Phi_{\text{trial}}>0$}{
   Go to step (iii) to solve for $\Delta \bar{\varepsilon}_p$
   }{
   $\Delta\bar{\varepsilon}_p = 0$ and go to step (iv)
  }

(iii) Use the Newton-Raphson to solve the yield equation for the equivalent plastic strain increment $\Delta\bar{\varepsilon}_p$:
\begin{equation}
	\sigma_v^{\text{trial}}
	- \left(1 - d_{[i]}^{[m+1]2} \right) 3 \mu\Delta\bar{\varepsilon}_p
	- \left(1 - d_{[i]}^{[m+1]2} \right) \sigma_{y}(\bar{\varepsilon}_{p}^{[m]} + \Delta\bar{\varepsilon}_p)
	= 0 \nonumber
\end{equation}


(iv) Update the constitutive variables
\begin{equation}
	\boldsymbol{\varepsilon}_{e}^{[m+1]} =
		\bb{\varepsilon}_{e}^{\text{trial}}
		- \sqrt{\sfrac{3}{2}} \, \Delta \bar{\varepsilon}_p 
		\frac{\text{dev}(\bb{\varepsilon}_{e}^{\text{trial}})}{\||\bb{\varepsilon}_{e}^{\text{trial}}||}
		\nonumber
\end{equation}
%\begin{equation}
%	\boldsymbol{\tau}^{[m+1]}=g_e(d)\bb{D}^e:\boldsymbol{\varepsilon}_{e}^{[m+1]}\ 
%	%Must incorporate section 4.5.4
%\nonumber
%\end{equation}
\begin{equation}
	\hat{p} = -\left(\sfrac{\kappa}{J^{[m+1]}} \right)\; \text{tr}\left(\boldsymbol{\varepsilon}_{e}^{[m+1]}\right) \nonumber
\end{equation}
\begin{equation}
%	\boldsymbol{\sigma}^{[m+1]} = \frac{1}{J} \bb{D}^e:\boldsymbol{\varepsilon}^{e} \nonumber
	\boldsymbol{s}^{[m+1]}
	=
	\left[1 - \left(d^{[m+1]}_{[i]}\right)^2 \right] (\sfrac{1}{J^{[m+1]}}) \, 2\mu \;\text{dev}\left(\boldsymbol{\varepsilon}_{e}^{[m+1]}\right) \nonumber
\end{equation}
\begin{equation}
	\bar{\varepsilon}_p^{[m+1]} = \bar{\varepsilon}_p^{[m]} + \Delta \bar{\varepsilon}_p \nonumber
\end{equation}
%\begin{equation}
%	\bb{\varepsilon}_p^{[m+1]} = \bb{\varepsilon}_p^{[m]} +\Delta \bb{\varepsilon}_p \nonumber
%\end{equation}



%(v) Implicitly solve the pressure Poisson's equation:
%\begin{equation}
%	p^{[m+1]} - \mathbb{D} \bb{\nabla}^2 p^{[m+1]} =
%	-\frac{\kappa}{2} \left[\left(J^{[m+1]}\right)^{2} - 1\right]
%	- \bb{\nabla} \cdot \left( \mathbb{D} \bb{\nabla} p^{[m+1]}_{[i]} \right) \\
%\end{equation}
(v)
   \eIf{Solve pressure equation}{
   Implicitly solve the pressure Poisson's equation:
\begin{equation}
	p^{[m+1]} - \mathbb{D} \bb{\nabla}^2 p^{[m+1]} = \hat{p} - \bb{\nabla} \cdot \left( \mathbb{D} \bb{\nabla} p^{[m+1]}_{[i]} \right) \nonumber
\end{equation}
   }{
\begin{equation}
	p^{[m+1]} = \hat{p} \nonumber
\end{equation}
  }

(vi) Update the true (Cauchy) stress
\begin{equation}
	\boldsymbol{\sigma}^{[m+1]} = \boldsymbol{s}^{[m+1]} -  p^{[m+1]}\textbf{I} \nonumber
\end{equation}


(vi) Solve the phase field equation for $d$:
\begin{equation}
	\frac{G_c}{2l}\left(d^{[m+1]} -4l^2 \bb{\nabla}^2 d^{[m+1]} \right) =
	\mathcal{H}^{[m+1]}_{[i]} %\left(\underline{\mathrm{x}},t\right)
	 \nonumber
\end{equation}

\caption{Phase field damage model stress calculation algorithm}
\end{algorithm}










%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Single Cell Verifications} \label{app:one_cell}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
This appendix presents single-cell uni-axial tension tests for the Lemaitre, GTN and phase field models implemented in the solids4foam toolbox for OpenFOAM.
These verifications provide confidence in the current implementations.
The geometry consists of a $1\times1\times1$ mm cube, where a displacement is applied to the positive y face in the positive y direction; shear tractions on the loading surface are set to zero.
Three symmetry planes are employed, and the remaining two surfaces are traction-free.
%The elements used in the solids4Foam toolbox have previously been validated through a patch test \cite{cardiff_patch_nodate}.
%In this test case, a displacement is applied in the $y$ direction to the top boundary of the element.

The results are compared with values from literature, analytical theory and finite element software Abaqus.
The Abaqus software has an inbuilt GTN model but does not have a non-local Lemaitre model.
Consequently, for this work, a non-local Lemaitre damage model was implemented in Abaqus through a user subroutine (UMAT).
The approach laid out in \citet{azinpour_simple_2018} is employed to implement the non-local Lemaitre damage model's diffusion equation.
This approach exploits Abaqus' ability to solve the steady-state heat conduction diffusion equation in coupled temperature-displacement problems:
\begin{equation}
    k\mathrm{\nabla}^2T + Q = 0
\end{equation}
where $k$ is the thermal conductivity, $T$ is the temperature, and $Q$ is a volumetric source term.
This heat equation is made compatible with the non-local gradient equation, as shown in Table \ref{tab:diffusion_equation_comparison}.
\begin{table}[htb]
	\centering
%	\resizebox{\textwidth}{!}{\begin{tabular}{lllll} \hline
		\begin{tabular}{lllll} \hline
			Field & Field variable & Diffusion coefficient & Flux term & Source term \\ \hline 
			Temperature & $T$ & $k$ & $\nabla^2T$ & Q \\
			Non-local damage & $\bar{D}$ & $l^{2}_c$ & $\nabla^2D$ &  $\bar{D}-D$\\
            \hline
%		\end{tabular}}
		\end{tabular}
	\caption{Analogous set-up of the heat equation and non-local gradient equation}
	\label{tab:diffusion_equation_comparison}
\end{table}



%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.4\textwidth]{./figures/finiteVolumeImplementation/cubeCase.png}
%\caption{one element case}
%\label{fig:deforming body}
%\end{center}
%\end{figure}


%%%%%%%%%%%%
\subsection{Lemaitre Model}
%%%%%%%%%%%%
A displacement of $0.2$ mm is applied with mechanical properties described in Table \ref{tab:material_properties_one_elem_lemaitre}.
These mechanical properties are taken from \citet{autay_numerical_2018}.
\begin{table}[htb]
	\centering
		\begin{tabular}{llll} \hline
			Property & Symbol & Value & Units  \\ \hline 
			Young's modulus & $E$ & $200$ & GPa \\
			Poisson's ratio & $v$ & $0.3$ & -  \\
			Lemaitre damage denominator & $S_0$ & $0.5$ &  MPa  \\
			Lemaitre damage exponent & $b$ & 1.0 & - \\
			Hardening law & $\sigma_y$ & $200+10^3{\bar{\varepsilon}}^p$ &  MPa  \\
			\hline
		\end{tabular}
	\caption{Material properties for Lemaitre one cell test}
	\label{tab:material_properties_one_elem_lemaitre}
\end{table}

The predicted damage and equivalent stress vs equivalent plastic strain from the OpenFOAM simulations are compared with values from Abaqus and analytical theory \citep{doghri_numerical_1995} in Figure \ref{fig:lemaitre_one_elem_force}.
It can be observed that the damage increases exponentially with respect to the equivalent plastic strain.
This is because, with the material constant $b=1$, the damage increases with the square of the effective von Mises equivalent stress.
 %(equation \ref{eqn:classicY}).
\begin{figure}[htbp]
	\centering
		\subfigure[Damage vs equivalent plastic strain]
		{
			\includegraphics[width=0.45\textwidth]{./figures/finiteVolumeImplementation/EpsPEQ_Damage.png}
		}
		\subfigure[Equivalent stress vs. equivalent plastic strain]
		{
			\includegraphics[width=0.45\textwidth]{./figures/finiteVolumeImplementation/EpsPEQ_EquivStress.png}
		}
	\caption{Comparison of the predicted forces for the Lemaitre model from OpenFOAM, Abaqus and analytical theory}
	\label{fig:lemaitre_one_elem_force}
\end{figure}

The analytically derived relationship for the damage $D$ as a function of the equivalent plastic strain ${\bar{\varepsilon}}^p$ is given by
\begin{equation}
	(1-D)^2=1-\frac{\sigma_{y0}^2}{3 E S_0} \frac{\sigma_{y0}}{h}\left[\left(1+\frac{h}{\sigma_{y0}} {\bar{\varepsilon}}_p\right)^3-1\right] \left[ \frac{2}{3}(1+v)+3(1-2v)\eta \right]
\end{equation}
where $\sigma_{y0}$ and $h$ are constants in the hardening law $\sigma_{y0}+h({\bar{\varepsilon}}^p)$, and the triaxiality $\eta=0.33$ for a uniaxial tensile test.
%$R_v$ is given by:
%\begin{equation}
%    R_v=\frac{2}{3}(1+v)+3(1-2v)\eta
%\end{equation}
%where the triaxiality $\eta=0.33$ for a uniaxial tensile test.
The analytical relationship for the equivalent stress $\sigma_{v}$ is also provided:
\begin{equation}
    \sigma_{v}=(1-D)\left[\sigma_{y0}+h({\bar{\varepsilon}}_p)\right]
\end{equation}


The component of plastic strain in the loading direction ($\varepsilon_p^{yy})$ can also be plotted as a function of the equivalent plastic strain ${\bar{\varepsilon}}_p$ and compared with the results obtained by \citet{doghri_numerical_1995} (Figure \ref{fig:lemaitre_one_element_ep}).
\begin{figure}[htbp]
\begin{center}
	\includegraphics[width=0.45\textwidth]{./figures/finiteVolumeImplementation/plasticStrainMult.png}
	\caption{Axial component of plastic strain (YY) vs. equivalent plastic strain}
	\label{fig:lemaitre_one_element_ep}
\end{center}
\end{figure}


%%%%%%%%%%%%
\subsection{GTN Model}
%%%%%%%%%%%%
This section compares the results for the GTN model implemented in OpenFOAM with those obtained from the inbuilt GTN model in Abaqus.
Table \ref{tab:material_properties_GTN_one_elem} displays the material properties used.
The GTN model in Abaqus does not allow for the inclusion of porous failure criteria (Equation \ref{eqn:GTNCoalescence}) in Abaqus/Standard, so this feature of the GTN model was neglected. 
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
			Property & Symbol & Value & Units  \\ \hline 
			Young's modulus & $E$ & $200$ & GPa \\
			Poisson's ratio & $v$ & $0.3$ &-   \\
			$q_1$ & $q_1$ & $1.5$  &- \\
		    $q_2$ & $q_2$ & $1$ &-  \\
		    $q_3$ & $q_3$ & $2.25$ &-  \\
		    Initial porosity & $f_0$ & $0.002$ &-  \\
		    Mean & $\varepsilon_n$ & $0.3$  &- \\
		    Standard deviation & $S_n$ & $0.1$ &-  \\
		    Volume fraction & $f_N$ & $0.2$  &- \\
			Hardening law & $\sigma_y$ & $400+300{\bar{\varepsilon}}_p$  & MPa  \\
			\hline
		\end{tabular}
	\caption{Material properties for GTN one cell test}
	\label{tab:material_properties_GTN_one_elem}
\end{table}

The results are shown in Figure \ref{fig:one_elem_GTN_results}. 
Notably, the rate of porosity growth declines towards the latter stages of the deformation.
This is because the porosity growth due to the nucleation of voids is assumed to follow a Gaussian distribution.
As discussed in the article's main body, this assumption is unlikely to accurately describe real material behaviour. 
\begin{figure}[htbp]
	\centering
		\subfigure[Porosity vs. displacement]
		{
		\includegraphics[width=0.45\textwidth]{./figures/GTNCompare/displacement_f.png}
		}
		\subfigure[Equivalent stress vs. displacement ]
		{
		\includegraphics[width=0.45\textwidth]{./figures/GTNCompare/displacement_sigmaEq.png}
		}
		\subfigure[Plastic strain in the Y direction vs. Equivalent plastic strain]
		{
		\includegraphics[width=0.45\textwidth]{./Figures/GTNCompare/EpsPEq_epsPY.png}
		}
		\caption{Comparison between the OpenFOAM and Abaqus predictions for the GTN model one cell test}
	\label{fig:one_elem_GTN_results}
\end{figure}


%%%%%%%%%%%%
\subsection{Phase Field Model}
%%%%%%%%%%%%
Table \ref{tab:material_properties_PF_one_elem} lists the material parameters for the phase field model one-cell test.
\begin{table}[htb]
	\centering
		\begin{tabular}{lllll} \hline
			Property & Symbol & Value & Units \\ \hline 
			Young's modulus & $E$ & $68.8$ & GPa \\
			Poisson's ratio & $v$ & $0.33$  & - \\
			Critical fracture energy & $G_c$ & $138\times10^6$ &  J/m$^2$ \\
   		Plastic work threshold & $w_0$ & $1$ &  MPa \\
			Characteristic length & $l$ & $2$ & m   \\
			Hardening law & $\sigma_y$ & $320+688{\bar{\varepsilon}}_p$ & MPa  \\
			\hline
		\end{tabular}
	\caption{Material properties for the phase field model one cell test}
	\label{tab:material_properties_PF_one_elem}
\end{table}

Figure \ref{fig:one_elem_PF_results} compares the phase field model one-cell test results with those obtained by \citet{borden_phase-field_2016}.
In this test case, the cell undergoes a rapid loss of load-carrying capacity.
This is because after the plastic work threshold is exceeded, there is a rapid increase in the plastic strain energy contribution to the crack-driving force $\mathcal{H}$ and, therefore, growth of the phase field variable $d$.
%The combination of this and the fact that the crack degradation function ($g_e(d)=(1-d)^2$) is proportional to the square of the phase field leads to the swift reduction in the equivalent stress.
\begin{figure}[htbp]
	\centering
		\subfigure[Equivalent plastic strain vs. the $YY$ component of the total strain]
		{
		\includegraphics[width=0.45\textwidth]{./Figures/finiteVolumeImplementation/phaseField/displacement_EpsPYY.png}
		}
		\subfigure[Equivalent stress vs. the $YY$ component of the total strain]
		{
		\includegraphics[width=0.45\textwidth]{./Figures/finiteVolumeImplementation/phaseField/displacement_sigmaEq.png}
		}
		\caption{Comparison between OpenFOAM and \citet{borden_phase-field_2016} predictions for the phase field model one cell test}
	\label{fig:one_elem_PF_results}
\end{figure}

%\begin{figure}[htbp]
%	\centering
%		\subfigure[Crack degradation function g(d) vs. total strain]
%		{
%		\includegraphics[width=0.45\textwidth]{./figures/finiteVolumeImplementation/phaseField/displacement_degredationFucntion.png}
%		}
%		\subfigure[Phase field (d) vs. total strain]
%		{
%		\includegraphics[width=0.45\textwidth]{./figures/finiteVolumeImplementation/phaseField/displacement_phaseField.png}
%		}
%		\caption{Evolution of the phase field damage variable $d$ and the crack degradation function for the one cell test}
%	\label{fig:one_elem_PF_results2}
%\end{figure}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Phase Field Model Updated-to-Total Lagrangian Transformation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Given that the mesh is moved to the updated configuration after each time step, the non-local equation is solved with respect to this updated mesh configuration. However, sometimes it may be preferred to solve the non-local equation with respect to the initial mesh configuration.
%
%It's worth noting however that the results from the non-local equation will differ if the non-local gradient equation is solved with respect to the initial configuration $\Omega_o$. If the non-local equation is solved with respect to the updated configuration, then in tension the non-local damage will tend towards the local damage as the distance between the cell centres will increase. Conversely, in compressive states, the distances between cell centres will decrease leading to greater diffusion in the region of a damaged cell. In order to illustrate this, simulations on a one-dimensional bar of length $10mm$ were performed. An imperfection is placed at the centre of the bar so that here the local damage $D=1.0$. In all other cells $D=0$. Both 20\% compressive and tensile strains were applied. It can be seen in Figure \ref{fig:compressiveTensileNonLocalDamage} how the distribution of the non-local damage is therefore altered as the bar undergoes tension and compression 
%
%\begin{figure}[htb]
%\begin{center}
%	\includegraphics[width=0.65\textwidth]{./Figures/damageModels/compressiveTensileDamage.png}
%\caption{Non-local damage along the original bar length}
%\label{fig:compressiveTensileNonLocalDamage}
%\end{center}
%\end{figure}
%
%It remains a matter of debate in the literature as to whether solving this equation with respect to the initial or updated configuration is preferable \cite{geers_strongly_2003}. \citet{steinmann_formulation_nodate} has argued that the fact that the non-local damage will tend towards the local damage (in an object undergoing tensile loading) is an argument for solving with respect to the initial configuration to ensure that the mesh independence of the solution remains strong. However, he also noted that this may not be physically realistic as it is not likely the case that a material's non-local properties are completely independent of its deformation path.
%
%In order to ensure that solving the non-local gradient equation with respect to the initial configuration is possible, within the context of an updated Lagrangian solid model, a mathematical and algorithmic approach was developed in this work. This approach allows for the solving of the non-local gradient equation with respect to the initial configuration within the context of an updated Lagrangian solid model framework.
%
%To begin, the strong integral form of the non-local equation with respect to the initial configuration is stated:
%
%\begin{equation}
%\label{eqn:stronFormNonLocal_URef}
%\int_{\mathrm{\Omega}_o}D\ d\mathrm{\Omega}_o-\int_{\mathrm{\Omega}_o}\bar{D}\ d\mathrm{\Omega}_o+\oint_{\mathrm{\Gamma}_o}{{l_c}^2\ \bb{n}_o\cdot\mathrm{\nabla}\mathrm{\bar{D}}}\ d\mathrm{\Gamma}_o=0
%\end{equation}
%
%Given the definition of the volume change $J$, the volume in the updated configuration can be related to the initial volume:
%\begin{equation}
%\label{eqn:refVolJac}
%    J^{-1}_nV_u=V_o
%\end{equation}
%where $J_n$ is the volume change from the previous time step.
%Nanson's formula is employed to describe the updated $\Gamma_u$ area vector in terms of the initial area vector $\Gamma_o$:
%\begin{equation}
%%\label{eqn:updatedInitialNanson}
%    \bb{\Gamma_u}=J_n\bb{F}_n^{-T}\cdot\bb{\Gamma}_0
%\end{equation}
%The initial area vector $\Gamma_o$ can then be rewritten in terms of the updated area vector $\Gamma_u$:
%\begin{equation}
%\label{eqn:updatedInitialNanson}
%    J^{-1}_n\bb{F}_n^{T}\cdot\bb{\Gamma_u}=\bb{\Gamma}_0
%\end{equation}
%
%Using equation \ref{eqn:refVolJac}, the first two volume integral terms in equation \ref{eqn:updatedInitialNanson} can be given in terms of the updated configuration as:
%\begin{equation}
%\int_{\mathrm{\Omega}_o}D\ d\mathrm{\Omega}_o=\int_{\mathrm{\Omega}_u}J^{-1}_nD\ d\mathrm{\Omega}_u
%\end{equation}
%\begin{equation}
%\int_{\mathrm{\Omega}_o}\bar{D}\ d\mathrm{\Omega}_o=\int_{\mathrm{\Omega}_u}J^{-1}_n\bar{D}\ d\mathrm{\Omega}_u
%\end{equation}
%
%Gauss' theorem can then be used to reformulate the gradient term within the third term of equation \ref{eqn:stronFormNonLocal_URef}:
%\begin{equation}
%\label{eqn:reformulatedGradientThirdTerm}
%\oint_{\mathrm{\Gamma}_o}{{l_c}^2\ \bb{n}_o\cdot\mathrm{\nabla}\mathrm{\bar{D}}}\ d\mathrm{\Gamma}_o=\oint_{\mathrm{\Gamma}_o}{{l_c}^2\ \bb{n}_o\cdot\left(\oint_{\mathrm{\Gamma}_o}\bb{n}_o\bar{D}\ d\mathrm{\Gamma}_o\right)}\ d\mathrm{\Gamma}_o
%\end{equation}
%The term on the right-hand side of equation \ref{eqn:reformulatedGradientThirdTerm} can then be reformulated in terms of the updated configuration by combining it with equation \ref{eqn:updatedInitialNanson} to give
%%\begin{equation}
%%	\oint_{\Gamma_o}{{l_c}^2\ \bb{n}_o\cdot\left(\oint_{\Gamma_o}\bb{n}_o\bar{D}\ d\Gamma_o\right)}\d\Gamma_o
%%	=
%%	\oint_{\Gamma_u}{{l_c}^2 J^{-1}_n\bb{F}_n^{T}\cdot \bb{n}_u\cdot\left(\oint_{\Gamma_u}J^{-1}_n\bb{F}_n^{T}\cdot\bb{n}_u\bar{D}\ d\Gamma_u\right)}\ d\Gamma_u
%%\end{equation}
%
%The full equation to be solved is therefore 
%%\begin{equation}
%%\label{eqn:fullUpdatedRefNonLocal}
%%\int_{\mathrm{\Omega}_u} J^{-1}_n\D\ d\mathrm{\Omega}_u
%%-
%%\int_{\mathrm{\Omega}_u} J^{-1}_n\bar{D}\ d\mathrm{\Omega}_u
%%+
%%\oint_{\Gamma_u}{{l_c}^2 \left(J^{-1}_n\bb{F}_n^{T}\cdot \bb{n}_u\right)\cdot\left(\oint_{\Gamma_u}\left(J^{-1}_n\bb{F}_n^{T}\cdot \bb{n}_u\right)\bar{D}\ d\Gamma_u\right)}\ d\Gamma_u=0
%%\end{equation}
%
%\textbf{Algorithmic approach}
%
%Equation \ref{eqn:fullUpdatedRefNonLocal} is solved as shown in equation \ref{eqn:fullUpdatedRefNonLocalToBESolved}, with the second and third terms added in to aid with convergence. The divergence, gradient and Laplacian terms are discretised using the Gauss linear scheme \cite{noauthor_openfoam_2015}. A user-defined number of outer iterations are performed around this equation. The code for its implementation is provided in Appendix C.
%
%\begin{eqnarray}
%\label{eqn:fullUpdatedRefNonLocalToBESolved}
%\underbrace{\int_{\mathrm{\Omega}_u} J^{-1}_n\bar{D}\ d\mathrm{\Omega}_u}_{\text {implicit}} &-& \underbrace{\oint_{\mathrm{\Gamma}_u}{\bb{n}_u\cdot\mathrm{\nabla}\left(\mathrm{\Delta \bar{D}}\right)}\ d\mathrm{\Gamma}_u}_{\text {implicit }} \notag \\
%    &+&\underbrace{\oint_{\mathrm{\Gamma}_u}{\bb{n}_u\cdot\mathrm{\nabla}\left(\mathrm{\Delta \bar{D}}\right)}\ d\mathrm{\Gamma}_u}_{\text {explicit }} \notag \\
%    &-&\underbrace{\oint_{\Gamma_u}{{l_c}^2 \left(J^{-1}_n\bb{F}_n^{T}\cdot \bb{n}_u\right)\cdot\left(\oint_{\Gamma_u}\left(J^{-1}_n\bb{F}_n^{T}\cdot \bb{n}_u\right)\bar{D}\ d\Gamma_u\right)}\ d\Gamma_u}_{\text {explicit }} \notag \\
%    &=& \underbrace{\int_{\mathrm{\Omega}_u} J^{-1}_n\bar{D}\ d\mathrm{\Omega}_u}_{\text {explicit}}
%\end{eqnarray}
%
%\subsection{Validation of updated-Lagrangian to reference approach}
%
%In this section, the implementation of the approach described in section \ref{Updated-Lagrangian to reference development} is verified. This is done by simulating each of case a and case b (from section \ref{rhieChowExplorationCases}) in the following three ways 
%\begin{itemize}
%    \item With an updated Lagrangian solid model
%    \item With a total Lagrangian solid model
%    \item with an updated Lagrangian solid model and the non-local damage gradient equation solved with respect to the initial configuration 
%\end{itemize}
%
%The force-displacement curves for these simulations are given in Figure \ref{UpdatedToReferenceComaprison}. The results of the UL to reference approach and the total Lagrangian approach line up well. However, in Figure 6.17 a, a slight discrepancy can be observed which given that very fine time-steps and meshes are used for these simulations is unrelated to discritisation error (Appendix A.1). Is unclear why this exists. It may be due to slight differences in the discretisation techniques - in the UL to reference approach the divergence of the gradient of the non-local damage variable $\bar{D}$ is solved for, whereas in the total Lagrangian approach the option in OpenFOAM to solve the Laplacian directly is used. Some differences in the Rhie-Chow effects between the total-Lagrangian and updated-Lagrangian approach may also contribute.
%
%\begin{figure}[htbp]
%	\centering
%		\subfigure[Flat notched bar - case a] {\label{airbus}\includegraphics[width=0.8\textwidth]{./Figures/finiteVolumeCharacteristics/bordenLagCompare_ForceDisp.png}}
%		
%		\subfigure[Notched round bar - case b] {\label{boeing} \includegraphics[width=0.8\textwidth]{./Figures/finiteVolumeCharacteristics/axiLagCompare_ForceDisp.png}}
%		
%		\caption{Comparison of approaches}
%	\label{UpdatedToReferenceComaprison}
%\end{figure}
%\FloatBarrier
%





\end{appendices}


\bibliography{sn-bibliography}% common bib file


\end{document}
